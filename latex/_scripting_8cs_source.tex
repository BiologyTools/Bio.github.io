\hypertarget{_scripting_8cs_source}{}\doxysection{Scripting.\+cs}
\label{_scripting_8cs_source}\index{BioGTK/Source/Scripting.cs@{BioGTK/Source/Scripting.cs}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00001}00001 \textcolor{keyword}{using }System;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00002}00002 \textcolor{keyword}{using }System.Collections;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00003}00003 \textcolor{keyword}{using }System.Collections.Generic;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00004}00004 \textcolor{keyword}{using }System.ComponentModel;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00005}00005 \textcolor{keyword}{using }System.Data;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00007}00007 \textcolor{keyword}{using }System.Linq;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00008}00008 \textcolor{keyword}{using }System.Text;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00009}00009 \textcolor{keyword}{using }System.Threading.Tasks;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00010}00010 \textcolor{keyword}{using }System.IO;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00011}00011 \textcolor{keyword}{using }System.Threading;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00012}00012 \textcolor{keyword}{using }CSScripting;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00013}00013 \textcolor{keyword}{using }csscript;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00014}00014 \textcolor{keyword}{using }CSScriptLib;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00015}00015 \textcolor{keyword}{using }Gtk;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00016}00016 \textcolor{keyword}{using }AForge;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00017}00017 \textcolor{keyword}{using }\mbox{\hyperlink{namespace_bio_g_t_k}{BioGTK}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00018}00018 \textcolor{keyword}{using }System.Reflection.Metadata;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00020}00020 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_bio_g_t_k}{BioGTK}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00021}00021 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00022}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting}{00022}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting}{Scripting}} : Window}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00023}00023     \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00024}00024 \textcolor{preprocessor}{        \#region Properties}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00025}00025         \textcolor{keyword}{private} Builder \_builder;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00027}00027 \textcolor{preprocessor}{\#pragma warning disable 649}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00028}00028         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00029}00029         \textcolor{keyword}{private} TreeView scriptView;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00030}00030         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00031}00031         \textcolor{keyword}{private} TextView view;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00032}00032         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00033}00033         \textcolor{keyword}{private} TextView outputBox;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00034}00034         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00035}00035         \textcolor{keyword}{private} TextView errorBox;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00036}00036         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00037}00037         \textcolor{keyword}{private} TextView logBox;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00038}00038         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00039}00039         \textcolor{keyword}{private} Button scriptLoadBut;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00040}00040         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00041}00041         \textcolor{keyword}{private} Button saveBut;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00042}00042         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00043}00043         \textcolor{keyword}{private} Button runBut;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00044}00044         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00045}00045         \textcolor{keyword}{private} Button stopBut;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00046}00046         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00047}00047         \textcolor{keyword}{private} Label scriptLabel;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00048}00048         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00049}00049         \textcolor{keyword}{private} CheckButton headlessBox;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00050}00050         [Builder.Object]}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00051}00051         \textcolor{keyword}{private} Notebook tabsView;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00052}00052 \textcolor{preprocessor}{\#pragma warning restore 649}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00054}00054 \textcolor{preprocessor}{        \#endregion}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00056}00056 \textcolor{preprocessor}{        \#region Constructors / Destructors}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00061}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6df0a162db9adb2f26906580f1a902ab}{00061}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting}{Scripting}} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6df0a162db9adb2f26906580f1a902ab}{Create}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00062}00062         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00063}00063             Builder builder = \textcolor{keyword}{new} Builder(\textcolor{keyword}{new} FileStream(System.IO.Path.GetDirectoryName(Environment.ProcessPath) + \textcolor{stringliteral}{"{}/"{}} + \textcolor{stringliteral}{"{}Glade/Scripting.glade"{}}, FileMode.Open));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00064}00064             \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting}{Scripting}}(builder, builder.GetObject(\textcolor{stringliteral}{"{}scripting"{}}).Handle);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00065}00065         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00066}00066        }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00067}00067         \textcolor{comment}{/* Creating a new instance of the Scripting class. */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00068}00068         \textcolor{keyword}{protected} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting}{Scripting}}(Builder builder, IntPtr handle) : base(handle)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00069}00069         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00070}00070             \_builder = builder;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00071}00071             builder.Autoconnect(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00072}00072             scriptView.RowActivated += ScriptView\_RowActivated;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00073}00073             scriptView.ButtonPressEvent += ScriptView\_ButtonPressEvent;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00074}00074             this.DeleteEvent += Scripting\_DeleteEvent;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00075}00075             this.KeyPressEvent += Scripting\_KeyPressEvent;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00076}00076             saveBut.ButtonPressEvent += SaveBut\_ButtonPressEvent;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00077}00077             runBut.ButtonPressEvent += runButton\_Click;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00078}00078             scriptLoadBut.ButtonPressEvent += scriptLoadBut\_Click;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00079}00079             outputBox.ButtonPressEvent += OutputBox\_ButtonPressEvent;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00080}00080             errorBox.ButtonPressEvent += OutputBox\_ButtonPressEvent;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00081}00081             logBox.ButtonPressEvent += OutputBox\_ButtonPressEvent;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00082}00082             stopBut.ButtonPressEvent += stopBut\_Click;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00083}00083             tabsView.SwitchPage += TabsView\_SwitchPage;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00084}00084             window = \textcolor{keyword}{this};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00085}00085             \textcolor{keywordflow}{if} (!Directory.Exists(System.IO.Path.GetDirectoryName(Environment.ProcessPath) + \textcolor{stringliteral}{"{}//"{}} + \textcolor{stringliteral}{"{}Scripts"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00086}00086                 Directory.CreateDirectory(System.IO.Path.GetDirectoryName(Environment.ProcessPath) + \textcolor{stringliteral}{"{}//"{}} + \textcolor{stringliteral}{"{}Scripts"{}});}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00087}00087             \textcolor{keywordflow}{if} (!Directory.Exists(System.IO.Path.GetDirectoryName(Environment.ProcessPath) + \textcolor{stringliteral}{"{}//"{}} + \textcolor{stringliteral}{"{}Tools"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00088}00088                 Directory.CreateDirectory(System.IO.Path.GetDirectoryName(Environment.ProcessPath) + \textcolor{stringliteral}{"{}//"{}} + \textcolor{stringliteral}{"{}Tools"{}});}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00089}00089             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a33d7aa1b51c9043f5206f820bcefcf4a}{InitItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00090}00090             scriptLabel.Text = \textcolor{stringliteral}{"{}NewScript.cs"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00091}00091         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00092}00092 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00099}00099         \textcolor{keyword}{private} \textcolor{keywordtype}{void} TabsView\_SwitchPage(\textcolor{keywordtype}{object} o, SwitchPageArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00100}00100         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00101}00101             logBox.Buffer.Text = log;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00102}00102             errorBox.Buffer.Text = error;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00103}00103             outputBox.Buffer.Text = output;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00104}00104         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00111}00111         \textcolor{keyword}{private} \textcolor{keywordtype}{void} OutputBox\_ButtonPressEvent(\textcolor{keywordtype}{object} o, ButtonPressEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00112}00112         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00113}00113             logBox.Buffer.Text = log;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00114}00114             errorBox.Buffer.Text = error;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00115}00115             outputBox.Buffer.Text = output;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00116}00116         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00123}00123         \textcolor{keyword}{private} \textcolor{keywordtype}{void} ScriptView\_ButtonPressEvent(\textcolor{keywordtype}{object} o, ButtonPressEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00124}00124         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00125}00125             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00126}00126         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00132}00132         \textcolor{keyword}{private} \textcolor{keywordtype}{void} SaveBut\_ButtonPressEvent(\textcolor{keywordtype}{object} o, ButtonPressEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00133}00133         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00134}00134             Save();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00135}00135         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00141}00141         \textcolor{keyword}{private} \textcolor{keywordtype}{void} Scripting\_DeleteEvent(\textcolor{keywordtype}{object} o, DeleteEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00142}00142         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00143}00143             args.RetVal = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00144}00144             Hide();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00145}00145         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00152}00152         \textcolor{keyword}{private} \textcolor{keywordtype}{void} Scripting\_KeyPressEvent(\textcolor{keywordtype}{object} o, KeyPressEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00153}00153         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00154}00154             \textcolor{keywordflow}{if} (args.Event.Key == Gdk.Key.s \&\& args.Event.State == Gdk.ModifierType.ControlMask)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00155}00155             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00156}00156                 Save();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00157}00157             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00158}00158         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00166}00166         \textcolor{keyword}{private} \textcolor{keywordtype}{void} ScriptView\_RowActivated(\textcolor{keywordtype}{object} o, RowActivatedArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00167}00167         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00168}00168             TreeView treeView = (TreeView)o;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00169}00169             TreePath path = args.Path;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00170}00170             TreeIter iter;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00172}00172             \textcolor{comment}{// Get the TreeIter for the selected row}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00173}00173             \textcolor{keywordflow}{if} (treeView.Model.GetIter(out iter, path))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00174}00174             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00175}00175                 \textcolor{comment}{// Get the value of the "{}Text"{} column for the selected row}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00176}00176                 \textcolor{keywordtype}{string} text = (string)treeView.Model.GetValue(iter, 0);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00177}00177                 \textcolor{keywordflow}{if} (scripts.ContainsKey(text))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00178}00178                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00179}00179                     selectedItem = scripts[text];}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00180}00180                     view.Buffer.Text = selectedItem.scriptString;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00181}00181                     scriptLabel.Text = selectedItem.name;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00182}00182                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00183}00183             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00184}00184         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00185}00185 \textcolor{preprocessor}{        \#endregion}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00187}00187         \textcolor{comment}{/* Creating a static class called Window, and a static string called log. */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00188}00188         \textcolor{keyword}{public} \textcolor{keyword}{static} Window window;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00189}00189         \textcolor{comment}{/* Declaring a static variable called log. */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00190}00190         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} log;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00191}00191         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} output;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00192}00192         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} error;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00193}00193         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} ImageJPath = ImageJ.ImageJPath;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00194}00194         \textcolor{keyword}{public} \textcolor{keyword}{static} Dictionary<string,Script> scripts = \textcolor{keyword}{new} Dictionary<string,Script>();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00195}00195         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} LogLine(\textcolor{keywordtype}{string} s)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00196}00196         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00197}00197             log += s + Environment.NewLine;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00198}00198         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00199}00199         \textcolor{comment}{/* It takes a string, adds using statements, wraps it in a class, and then runs it */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00200}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{00200}}         \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00201}00201         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00202}00202             \textcolor{keyword}{public} \textcolor{keywordtype}{string} name;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00203}00203             \textcolor{keyword}{public} \textcolor{keywordtype}{string} file;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00204}00204             \textcolor{keyword}{public} \textcolor{keywordtype}{string} scriptString;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00205}00205             \textcolor{keyword}{public} \textcolor{keywordtype}{bool} exit = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00206}00206             \textcolor{keyword}{public} dynamic script;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00207}00207             \textcolor{keyword}{public} \textcolor{keywordtype}{object} obj;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00208}00208             \textcolor{keyword}{public} \textcolor{keywordtype}{string} output = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00209}00209             \textcolor{keyword}{public} \textcolor{keywordtype}{bool} done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00210}00210             \textcolor{keyword}{public} \textcolor{keyword}{static} List<string> usings = \textcolor{keyword}{new} List<string>();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00211}00211             \textcolor{keyword}{public} Exception ex = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00212}00212             \textcolor{keyword}{public} Thread thread;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00213}00213             \textcolor{keyword}{public} ScriptType type = ScriptType.script;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00214}00214             \textcolor{comment}{/* Creating a new script object. */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00215}00215             \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}(\textcolor{keywordtype}{string} file, \textcolor{keywordtype}{string} scriptStr)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00216}00216             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00217}00217                 name = System.IO.Path.GetFileName(file);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00218}00218                 scriptString = scriptStr;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00219}00219                 \textcolor{keywordflow}{if} (file.EndsWith(\textcolor{stringliteral}{"{}.txt"{}}) || file.EndsWith(\textcolor{stringliteral}{"{}.ijm"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00220}00220                     type = ScriptType.imagej;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00221}00221             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00222}00222             \textcolor{comment}{/* Reading the file and storing the file name, file path, and file contents in the}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00223}00223 \textcolor{comment}{            variables name, file, and scriptString. */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00224}00224             \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}(\textcolor{keywordtype}{string} file)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00225}00225             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00226}00226                 name = System.IO.Path.GetFileName(file);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00227}00227                 scriptString = File.ReadAllText(file);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00228}00228                 this.file = file;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00229}00229                 \textcolor{keywordflow}{if} (file.EndsWith(\textcolor{stringliteral}{"{}.txt"{}}) || file.EndsWith(\textcolor{stringliteral}{"{}.ijm"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00230}00230                     type = ScriptType.imagej;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00231}00231             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00236}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_a4086217a8ba1f9f79f1b9c59b2c43490}{00236}}             \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_a4086217a8ba1f9f79f1b9c59b2c43490}{Run}}(\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} rn)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00237}00237             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00238}00238                 scriptName = rn.name;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00239}00239                 Thread t = \textcolor{keyword}{new} Thread(\textcolor{keyword}{new} ThreadStart(RunScript));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00240}00240                 t.Start();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00241}00241             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00242}00242             \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{string} scriptName = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00243}00243             \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{string} str = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00245}00245             \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{void} RunScript()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00246}00246             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00247}00247                 \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} rn = scripts[scriptName];}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00248}00248                 rn.ex = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00249}00249                 \textcolor{keywordflow}{if} (rn.type == ScriptType.imagej)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00250}00250                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00251}00251                     \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00252}00252                     \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00253}00253                         rn.done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00254}00254                         ImageJ.\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_adb36538f8ad614b6ff2c3620d3a6ccb7}{RunString}}(rn.scriptString,\textcolor{stringliteral}{"{}"{}}, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00255}00255                         rn.done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00256}00256                     \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00257}00257                     \textcolor{keywordflow}{catch} (Exception e)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00258}00258                     \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00259}00259                         rn.ex = e;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00260}00260                     \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00261}00261                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00262}00262                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00263}00263                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00264}00264                     \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00265}00265                     \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00266}00266                         rn.done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00267}00267                         rn.script = CSScript.Evaluator.LoadCode(rn.scriptString);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00268}00268                         rn.obj = rn.script.Load();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00269}00269                         rn.output = rn.obj.ToString();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00270}00270                         rn.done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00271}00271                         }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00272}00272                     \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00273}00273                     \textcolor{keywordflow}{catch} (Exception e)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00274}00274                     \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00275}00275                         rn.ex = e;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00276}00276                         error = e.Message + Environment.NewLine + e.StackTrace;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00277}00277                     \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00278}00278                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00279}00279             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00286}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_adb36538f8ad614b6ff2c3620d3a6ccb7}{00286}}             \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{object} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_adb36538f8ad614b6ff2c3620d3a6ccb7}{RunString}}(\textcolor{keywordtype}{string} st)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00287}00287             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00288}00288                 \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00289}00289                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00290}00290                     \textcolor{keywordtype}{string} loader =}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00291}00291                   \textcolor{stringliteral}{@"{}//css\_reference "{}} + System.Reflection.Assembly.GetExecutingAssembly().GetName().Name + \textcolor{stringliteral}{@"{}.dll}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00292}00292 \textcolor{stringliteral}{                    using System;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00293}00293 \textcolor{stringliteral}{                    using Gtk;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00294}00294 \textcolor{stringliteral}{                    using System.Threading;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00295}00295 \textcolor{stringliteral}{                    using BioGTK;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00296}00296 \textcolor{stringliteral}{                    using AForge;"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00297}00297                     \textcolor{keywordflow}{foreach} (\textcolor{keywordtype}{string} s \textcolor{keywordflow}{in} usings)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00298}00298                     \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00299}00299                         loader += usings + Environment.NewLine;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00300}00300                     \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00301}00301                     loader += \textcolor{stringliteral}{@"{}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00302}00302 \textcolor{stringliteral}{                    public class Loader}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00303}00303 \textcolor{stringliteral}{                    \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00304}00304 \textcolor{stringliteral}{                        public object Load()}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00305}00305 \textcolor{stringliteral}{                        \{"{}} +}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00306}00306                             st + \textcolor{stringliteral}{@"{};}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00307}00307 \textcolor{stringliteral}{                            return true;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00308}00308 \textcolor{stringliteral}{                        \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00309}00309 \textcolor{stringliteral}{                    \}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00310}00310                     dynamic script = CSScript.Evaluator.LoadCode(loader);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00311}00311                     \textcolor{keywordflow}{return} script.Load();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00312}00312                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00313}00313                 \textcolor{keywordflow}{catch} (Exception e)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00314}00314                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00315}00315                     MessageDialog md = \textcolor{keyword}{new} MessageDialog(window,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00316}00316                 DialogFlags.DestroyWithParent, MessageType.Info,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00317}00317                 ButtonsType.Close, e.Message + \textcolor{stringliteral}{"{}, "{}} + e.Source);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00318}00318                     \textcolor{keywordflow}{return} e;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00319}00319                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00320}00320             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00322}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_af3a08dc9714720117594b3abfbbb2019}{00322}}             \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_af3a08dc9714720117594b3abfbbb2019}{Run}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00323}00323             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00324}00324                 \textcolor{keywordflow}{if} (!scripts.ContainsKey(name))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00325}00325                     scripts.Add(name, \textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00326}00326                 scriptName = this.name;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00327}00327                 thread = \textcolor{keyword}{new} Thread(\textcolor{keyword}{new} ThreadStart(RunScript));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00328}00328                 thread.Start();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00329}00329             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00331}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_a0405e1ac4614fed1742c2bb56485d958}{00331}}             \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_a0405e1ac4614fed1742c2bb56485d958}{Stop}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00332}00332             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00333}00333                 exit = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00334}00334             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00339}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_ae6bc75426e91f5276bdc41060308bded}{00339}}             \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{string} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_ae6bc75426e91f5276bdc41060308bded}{ToString}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00340}00340             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00341}00341                 \textcolor{keywordflow}{if} (thread != \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00342}00342                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00343}00343                     \textcolor{keywordflow}{return} name.ToString() + \textcolor{stringliteral}{"{}, "{}} + thread.ThreadState.ToString();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00344}00344                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00345}00345                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00346}00346                     \textcolor{keywordflow}{return} name.ToString();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00347}00347             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00348}00348         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00349}00349         \textcolor{comment}{/* It's a class that represents a mouse event */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00350}00350         \textcolor{comment}{/* It's a class that holds the state of the mouse */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00351}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{00351}}         \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00352}00352         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00353}00353             \textcolor{keyword}{public} Event type;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00361}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_ab02c2a161a3ba01d3a43a70917ea18c2}{00361}}             \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_ab02c2a161a3ba01d3a43a70917ea18c2}{GetUp}}(PointD pf,uint mb)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00362}00362             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00363}00363                 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00364}00364                 \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} st = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00365}00365                 st.type = Event.Up;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00366}00366                 st.p = pf;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00367}00367                 st.buts = mb;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00368}00368                 \textcolor{keywordflow}{return} st;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00369}00369             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00377}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_ae29498cfd768862f2e2879c37094cd80}{00377}}             \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_ae29498cfd768862f2e2879c37094cd80}{GetMove}}(PointD pf, uint mb)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00378}00378             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00379}00379                 \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} st = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00380}00380                 st.type = Event.Move;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00381}00381                 st.p = pf;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00382}00382                 st.buts = mb;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00383}00383                 \textcolor{keywordflow}{return} st;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00384}00384             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00385}00385 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00390}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_aae2dd011f0b6f083079a0f60820a2523}{00390}}             \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_aae2dd011f0b6f083079a0f60820a2523}{GetDown}}(PointD pf, uint mb)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00391}00391             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00392}00392                 \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} st = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00393}00393                 st.type = Event.Down;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00394}00394                 st.p = pf;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00395}00395                 st.buts = mb;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00396}00396                 \textcolor{keywordflow}{return} st;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00397}00397             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00398}00398 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00403}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_ac1dee01a3b75eaae56a5e43412180682}{00403}}             \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state_ac1dee01a3b75eaae56a5e43412180682}{GetNone}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00404}00404             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00405}00405                 \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} st = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00406}00406                 st.type = Event.None;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00407}00407                 st.p = \textcolor{keyword}{new} PointD();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00408}00408                 st.buts = 0;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00409}00409                 \textcolor{keywordflow}{return} st;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00410}00410             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00412}00412             \textcolor{keyword}{public} PointD p;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00413}00413             \textcolor{keyword}{public} uint buts;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00414}00414             \textcolor{keyword}{public} \textcolor{keywordtype}{bool} processed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00415}00415             \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{string} ToString()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00416}00416             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00417}00417                 \textcolor{keywordflow}{return} type.ToString() + \textcolor{stringliteral}{"{} ,("{}} + p.X.ToString() + \textcolor{stringliteral}{"{}, "{}} + p.Y.ToString() + \textcolor{stringliteral}{"{}), "{}} + buts.ToString();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00418}00418             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00419}00419 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00420}00420         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00421}00421         \textcolor{comment}{/* Defining an enum. */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00422}00422         \textcolor{keyword}{public} \textcolor{keyword}{enum} Event}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00423}00423         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00424}00424             Down,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00425}00425             Up,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00426}00426             Move,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00427}00427             None}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00428}00428         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00429}00429         \textcolor{comment}{/* Defining an enum. */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00430}00430         \textcolor{keyword}{public} \textcolor{keyword}{enum} ScriptType}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00431}00431         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00432}00432             tool,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00433}00433             script,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00434}00434             imagej}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00435}00435         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00436}00436         Script selectedItem;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00437}00437         \textcolor{keyword}{private} Script SelectedItem}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00438}00438         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00439}00439             \textcolor{keyword}{get}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00440}00440             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00441}00441                 \textcolor{keywordflow}{return} selectedItem;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00442}00442             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00443}00443         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00444}00444         \textcolor{keyword}{private} \textcolor{keyword}{static} State state;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00448}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a9e93251402a3a8f8d7806bdea582a5b9}{00448}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a9e93251402a3a8f8d7806bdea582a5b9}{GetState}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00449}00449         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00450}00450             \textcolor{keywordflow}{return} state;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00451}00451         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00452}00452 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00453}00453         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} Exit(\textcolor{keywordtype}{string} name)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00454}00454         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00455}00455             \textcolor{keywordflow}{if}(scripts.ContainsKey(name))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00456}00456             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00457}00457                 \textcolor{keywordflow}{return} scripts[name].exit;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00458}00458             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00459}00459             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00460}00460         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00469}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_ab471bfd1464966012668fa992eb68bc8}{00469}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_ab471bfd1464966012668fa992eb68bc8}{UpdateState}}(\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_state}{State}} s)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00470}00470         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00471}00471             \textcolor{keywordflow}{if} (s == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00472}00472                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00473}00473             \textcolor{keywordflow}{if} (state == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00474}00474                 state = s;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00475}00475             \textcolor{keywordflow}{if} (s.p.X == state.p.X \&\& s.p.Y == state.p.Y \&\& s.type == state.type)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00476}00476             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00477}00477                 state.processed = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00478}00478             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00479}00479             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00480}00480             state = s;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00481}00481         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00483}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a33d7aa1b51c9043f5206f820bcefcf4a}{00483}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a33d7aa1b51c9043f5206f820bcefcf4a}{InitItems}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00484}00484         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00485}00485             Gtk.TreeViewColumn typeCol = \textcolor{keyword}{new} Gtk.TreeViewColumn();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00486}00486             typeCol.Title = \textcolor{stringliteral}{"{}Script"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00487}00487             Gtk.CellRendererText typeCell = \textcolor{keyword}{new} Gtk.CellRendererText();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00488}00488             typeCol.PackStart(typeCell, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00489}00489             scriptView.AppendColumn(typeCol);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00490}00490             typeCol.AddAttribute(typeCell, \textcolor{stringliteral}{"{}text"{}}, 0);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00491}00491 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00492}00492             Gtk.TreeViewColumn statCol = \textcolor{keyword}{new} Gtk.TreeViewColumn();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00493}00493             statCol.Title = \textcolor{stringliteral}{"{}Status"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00494}00494             Gtk.CellRendererText statCell = \textcolor{keyword}{new} Gtk.CellRendererText();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00495}00495             statCol.PackStart(statCell, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00496}00496             scriptView.AppendColumn(statCol);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00497}00497             statCol.AddAttribute(statCell, \textcolor{stringliteral}{"{}text"{}}, 1);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00499}00499             Gtk.TreeStore store = \textcolor{keyword}{new} Gtk.TreeStore(typeof(\textcolor{keywordtype}{string}), typeof(\textcolor{keywordtype}{string}));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00500}00500             scriptView.Model = store;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00501}00501             scripts.Clear();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00502}00502             \textcolor{keywordtype}{string} st = System.IO.Path.GetDirectoryName(Environment.ProcessPath);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00503}00503             \textcolor{keywordflow}{foreach} (\textcolor{keywordtype}{string} file \textcolor{keywordflow}{in} Directory.GetFiles(st + \textcolor{stringliteral}{"{}/Scripts"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00504}00504             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00505}00505                 \textcolor{keywordflow}{if} (!scripts.ContainsKey(System.IO.Path.GetFileName(file)))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00506}00506                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00507}00507                     \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} sc = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}(file, File.ReadAllText(file));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00508}00508                     \textcolor{keywordflow}{if}(sc.thread == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00509}00509                         store.AppendValues(sc.name, ThreadState.Unstarted.ToString());}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00510}00510                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00511}00511                         store.AppendValues(sc.name, sc.thread.ThreadState.ToString());}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00512}00512                     scripts.Add(sc.name, sc);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00513}00513                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00514}00514             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00515}00515             \textcolor{keywordflow}{foreach} (\textcolor{keywordtype}{string} file \textcolor{keywordflow}{in} Directory.GetFiles(st + \textcolor{stringliteral}{"{}/Tools"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00516}00516             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00517}00517                 \textcolor{keywordflow}{if} (file.EndsWith(\textcolor{stringliteral}{"{}.cs"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00518}00518                 \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00519}00519                     \textcolor{keywordflow}{if} (!scripts.ContainsKey(System.IO.Path.GetFileName(file)))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00520}00520                     \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00521}00521                         \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} sc = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}(file, File.ReadAllText(file));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00522}00522                         \textcolor{keywordflow}{if} (sc.thread == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00523}00523                             store.AppendValues(sc.name, ThreadState.Unstarted.ToString());}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00524}00524                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00525}00525                             store.AppendValues(sc.name, sc.thread.ThreadState.ToString());}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00526}00526                         scripts.Add(sc.name, sc);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00527}00527                     \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00528}00528                 \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00529}00529             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00530}00530         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00531}00531 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00533}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{00533}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00534}00534         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00535}00535             Gtk.TreeStore store = \textcolor{keyword}{new} Gtk.TreeStore(typeof(\textcolor{keywordtype}{string}), typeof(\textcolor{keywordtype}{string}));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00536}00536             \textcolor{keywordflow}{foreach} (\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} sc \textcolor{keywordflow}{in} scripts.Values)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00537}00537             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00538}00538                 \textcolor{keywordflow}{if} (sc.thread == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00539}00539                     store.AppendValues(sc.name, ThreadState.Unstarted.ToString());}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00540}00540                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00541}00541                     store.AppendValues(sc.name, sc.thread.ThreadState.ToString());}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00542}00542             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00543}00543             scriptView.Model = store;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00544}00544         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00545}00545         \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00546}00546 \textcolor{comment}{        public void RefreshStatus()}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00547}00547 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00548}00548 \textcolor{comment}{            errorBox.Buffer.Text = "{}"{};}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00549}00549 \textcolor{comment}{            RefreshItems();}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00550}00550 \textcolor{comment}{            foreach (ListViewItem item in scriptView.SelectedItems)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00551}00551 \textcolor{comment}{            \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00552}00552 \textcolor{comment}{                Script s = (Script)item.Tag;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00553}00553 \textcolor{comment}{                //We update item text to show Script status.}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00554}00554 \textcolor{comment}{                item.Text = s.ToString();}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00555}00555 \textcolor{comment}{                outputBox.Buffer.Text = s.output;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00556}00556 \textcolor{comment}{                if (s.ex != null)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00557}00557 \textcolor{comment}{                \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00558}00558 \textcolor{comment}{                    string[] sps = s.ex.Message.Split('>');}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00559}00559 \textcolor{comment}{                    //ListViewItem it = new ListViewItem(s.ex.ToString());}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00560}00560 \textcolor{comment}{                    for (int i = 1; i < sps.Length; i++)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00561}00561 \textcolor{comment}{                    \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00562}00562 \textcolor{comment}{                        ListViewItem er = new ListViewItem(sps[i]);}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00563}00563 \textcolor{comment}{                        er.Tag = s.ex;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00564}00564 \textcolor{comment}{                        errorView.Items.Add(er);}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00565}00565 \textcolor{comment}{                    \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00566}00566 \textcolor{comment}{                    }}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00567}00567 \textcolor{comment}{                \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00568}00568 \textcolor{comment}{            \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00569}00569 \textcolor{comment}{            foreach (ListViewItem item in scriptView.SelectedItems)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00570}00570 \textcolor{comment}{            \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00571}00571 \textcolor{comment}{                Script s = (Script)item.Tag;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00572}00572 \textcolor{comment}{                //We update item text to show Script status.}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00573}00573 \textcolor{comment}{                item.Text = s.ToString();}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00574}00574 \textcolor{comment}{            \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00575}00575 \textcolor{comment}{            logBox.Buffer.Text = log;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00576}00576 \textcolor{comment}{            //We scroll to end of text so we see latest log output.}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00577}00577 \textcolor{comment}{            if (logBox.SelectionStart != logBox.Buffer.Text.Length)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00578}00578 \textcolor{comment}{            \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00579}00579 \textcolor{comment}{                logBox.SelectionStart = logBox.Buffer.Text.Length;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00580}00580 \textcolor{comment}{                logBox.ScrollToCaret();}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00581}00581 \textcolor{comment}{            \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00582}00582 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00583}00583 \textcolor{comment}{        */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00587}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a29aa520e449ee7082841cfd4862bb63e}{00587}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a29aa520e449ee7082841cfd4862bb63e}{RunByName}}(\textcolor{keywordtype}{string} name)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00588}00588         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00589}00589             scripts[name].Run();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00590}00590         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00594}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a26613fcf836d75036252c1ec686a1702}{00594}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a26613fcf836d75036252c1ec686a1702}{RunScriptFile}}(\textcolor{keywordtype}{string} file)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00595}00595         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00596}00596             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} sc = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}(file);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00597}00597             scripts.Add(sc.name,sc);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00598}00598             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00599}00599             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a29aa520e449ee7082841cfd4862bb63e}{RunByName}}(sc.name);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00600}00600         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00604}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_ae7b5565ce4cb7603cdfef5dda2c67337}{00604}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_ae7b5565ce4cb7603cdfef5dda2c67337}{RunScript}}(\textcolor{keywordtype}{string} file)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00605}00605         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00606}00606             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} sc = \textcolor{keyword}{new} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}(file);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00607}00607             scripts.Add(sc.name, sc);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00608}00608             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a29aa520e449ee7082841cfd4862bb63e}{RunByName}}(sc.name);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00609}00609         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00613}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a70549e585998e0dc05ab8c4d4240df27}{00613}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{object} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a70549e585998e0dc05ab8c4d4240df27}{RunString}}(\textcolor{keywordtype}{string} st)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00614}00614         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00615}00615             \textcolor{keywordflow}{return} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}}.\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_adb36538f8ad614b6ff2c3620d3a6ccb7}{RunString}}(st);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00616}00616         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00620}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a78faf235831d5a1c25ef58d8e8803d5d}{00620}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a78faf235831d5a1c25ef58d8e8803d5d}{Run}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00621}00621         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00622}00622             log = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00623}00623             outputBox.Buffer.Text = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00624}00624             logBox.Buffer.Text = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00625}00625             \textcolor{keywordflow}{if} (SelectedItem == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00626}00626                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00627}00627             \textcolor{comment}{//We run this script}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00628}00628             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script}{Script}} sc = SelectedItem;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00629}00629             sc.scriptString = view.Buffer.Text;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00630}00630             sc.output = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00631}00631             sc.\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_a4086217a8ba1f9f79f1b9c59b2c43490}{Run}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00632}00632             outputBox.Buffer.Text = sc.output;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00633}00633             logBox.Buffer.Text = log;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00634}00634             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00635}00635         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00639}\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a7bc656a343de906a041e21625a5811bb}{00639}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a7bc656a343de906a041e21625a5811bb}{Stop}}()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00640}00640         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00641}00641             \textcolor{keywordflow}{if} (SelectedItem == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00642}00642                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00643}00643             \textcolor{comment}{//We stop this script}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00644}00644             SelectedItem.\mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_1_1_script_a0405e1ac4614fed1742c2bb56485d958}{Stop}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00645}00645             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00646}00646         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00651}00651         }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00652}00652         \textcolor{keyword}{private} \textcolor{keywordtype}{void} runToolStripMenuItem\_Click(\textcolor{keywordtype}{object} sender, EventArgs e)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00653}00653         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00654}00654             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a78faf235831d5a1c25ef58d8e8803d5d}{Run}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00655}00655         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00660}00660 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00661}00661         \textcolor{keyword}{private} \textcolor{keywordtype}{void} openScriptFolderToolStripMenuItem\_Click(\textcolor{keywordtype}{object} sender, EventArgs e)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00662}00662         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00663}00663             \textcolor{keywordtype}{string} path = System.IO.Path.GetDirectoryName(Environment.ProcessPath) + \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)Scripts"{}};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00664}00664             System.Diagnostics.Process.Start(\textcolor{stringliteral}{"{}explorer.exe"{}}, path);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00665}00665         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00670}00670 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00675}00675         \textcolor{keyword}{private} \textcolor{keywordtype}{void} refreshToolStripMenuItem\_Click(\textcolor{keywordtype}{object} sender, EventArgs e)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00676}00676         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00677}00677             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00678}00678         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00679}00679         \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00680}00680 \textcolor{comment}{        private void scriptView\_SelectedIndexChanged(object sender, EventArgs e)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00681}00681 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00682}00682 \textcolor{comment}{            if (scriptView.SelectedItems.Count == 0)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00683}00683 \textcolor{comment}{                return;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00684}00684 \textcolor{comment}{            ListViewItem item = scriptView.SelectedItems[0];}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00685}00685 \textcolor{comment}{            Script s = (Script)item.Tag;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00686}00686 \textcolor{comment}{            textBox.Buffer.Text = s.scriptString;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00687}00687 \textcolor{comment}{            scriptLabel.Text = s.name;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00688}00688 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00689}00689 \textcolor{comment}{        */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00694}00694         \textcolor{keyword}{private} \textcolor{keywordtype}{void} runButton\_Click(\textcolor{keywordtype}{object} sender, ButtonPressEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00695}00695         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00696}00696             \textcolor{keywordflow}{if} (scriptLabel.Text.EndsWith(\textcolor{stringliteral}{"{}.ijm"{}}))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00697}00697             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00698}00698                 ImageJ.RunString(view.Buffer.Text, \mbox{\hyperlink{class_bio_g_t_k_1_1_image_view}{ImageView}}.SelectedImage.ID, headlessBox.Active);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00699}00699             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00700}00700             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00701}00701                 \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a78faf235831d5a1c25ef58d8e8803d5d}{Run}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00702}00702         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00703}00703 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00710}00710         \textcolor{keyword}{private} \textcolor{keywordtype}{void} scriptLoadBut\_Click(\textcolor{keywordtype}{object} sender, ButtonPressEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00711}00711         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00712}00712             Gtk.FileChooserDialog filechooser =}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00713}00713     \textcolor{keyword}{new} Gtk.FileChooserDialog(\textcolor{stringliteral}{"{}Choose script file to open"{}},}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00714}00714         \textcolor{keyword}{this},}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00715}00715         FileChooserAction.Open,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00716}00716         \textcolor{stringliteral}{"{}Cancel"{}}, ResponseType.Cancel,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00717}00717         \textcolor{stringliteral}{"{}Save"{}}, ResponseType.Accept);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00718}00718             filechooser.SetCurrentFolder(System.IO.Path.GetDirectoryName(Environment.ProcessPath));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00719}00719             \textcolor{keywordflow}{if} (filechooser.Run() != (\textcolor{keywordtype}{int})ResponseType.Accept)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00720}00720                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00721}00721 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00722}00722             Script script = \textcolor{keyword}{new} Script(filechooser.Filename, File.ReadAllText(filechooser.Filename));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00723}00723             script.name = System.IO.Path.GetFileName(filechooser.Filename);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00724}00724             view.Buffer.Text = script.scriptString;}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00725}00725             scriptLabel.Text = System.IO.Path.GetFileName(filechooser.Filename);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00726}00726 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00727}00727             scripts.Add(script.name, script);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00728}00728             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00729}00729         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00730}00730 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00736}00736         \textcolor{keyword}{private} \textcolor{keywordtype}{void} Save()}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00737}00737         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00738}00738             Gtk.FileChooserDialog filechooser =}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00739}00739     \textcolor{keyword}{new} Gtk.FileChooserDialog(\textcolor{stringliteral}{"{}Choose script filename to save"{}},}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00740}00740         \textcolor{keyword}{this},}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00741}00741         FileChooserAction.Save,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00742}00742         \textcolor{stringliteral}{"{}Cancel"{}}, ResponseType.Cancel,}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00743}00743         \textcolor{stringliteral}{"{}Save"{}}, ResponseType.Accept);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00744}00744             filechooser.SetCurrentFolder(System.IO.Path.GetDirectoryName(Environment.ProcessPath));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00745}00745             \textcolor{keywordflow}{if} (filechooser.Run() != (\textcolor{keywordtype}{int})ResponseType.Accept)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00746}00746                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00747}00747             scriptLabel.Text = System.IO.Path.GetFileName(filechooser.Filename);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00748}00748             File.WriteAllText(filechooser.Filename, view.Buffer.Text);}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00749}00749             \textcolor{keywordflow}{if}(!scripts.ContainsKey(scriptLabel.Text))}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00750}00750             \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00751}00751                 scripts.Add(scriptLabel.Text,\textcolor{keyword}{new} Script(filechooser.Filename, view.Buffer.Text));}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00752}00752             \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00753}00753             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a6504102fb3d8881f19c665e8ae4a97d0}{RefreshItems}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00754}00754             filechooser.Destroy();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00755}00755         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00756}00756 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00761}00761         \textcolor{keyword}{private} \textcolor{keywordtype}{void} stopBut\_Click(\textcolor{keywordtype}{object} sender, ButtonPressEventArgs args)}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00762}00762         \{}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00763}00763             \mbox{\hyperlink{class_bio_g_t_k_1_1_scripting_a7bc656a343de906a041e21625a5811bb}{Stop}}();}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00764}00764         \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00765}00765 }
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00766}00766         \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00767}00767 \textcolor{comment}{        private void errorBox\_SelectionChanged(object sender, EventArgs e)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00768}00768 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00769}00769 \textcolor{comment}{            Script sc = (Script)scriptView.SelectedItems[0].Tag;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00770}00770 \textcolor{comment}{            Exception ex = sc.ex;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00771}00771 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00772}00772 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00773}00773 \textcolor{comment}{        private void errorView\_SelectedIndexChanged(object sender, EventArgs e)}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00774}00774 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00775}00775 \textcolor{comment}{            Exception ex = (Exception)errorView.SelectedItems[0].Tag;}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00776}00776 \textcolor{comment}{            string exs = ex.Message.Substring(ex.Message.IndexOf('('), ex.Message.IndexOf(')'));}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00777}00777 \textcolor{comment}{            string ls = exs.Substring(1, exs.IndexOf(',')-\/1);}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00778}00778 \textcolor{comment}{            int line = int.Parse(ls);}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00779}00779 \textcolor{comment}{            string c = exs.Substring(exs.IndexOf(',') + 1, exs.IndexOf("{})"{}) -\/ exs.IndexOf(',') -\/ 1);}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00780}00780 \textcolor{comment}{            int cr = int.Parse(c);}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00781}00781 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00782}00782 \textcolor{comment}{        */}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00783}00783     \}}
\DoxyCodeLine{\Hypertarget{_scripting_8cs_source_l00784}00784 \}}

\end{DoxyCode}

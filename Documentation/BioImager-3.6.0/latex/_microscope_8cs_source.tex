\hypertarget{_microscope_8cs_source}{}\doxysection{Microscope.\+cs}
\label{_microscope_8cs_source}\index{F:/repos/BioImager/BioImager/Source/Microscope.cs@{F:/repos/BioImager/BioImager/Source/Microscope.cs}}
\mbox{\hyperlink{_microscope_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00001}00001 \textcolor{keyword}{using }System;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00002}00002 \textcolor{keyword}{using }System.Collections.Generic;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00003}00003 \textcolor{keyword}{using }System.Linq;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00004}00004 \textcolor{keyword}{using }System.Text;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00005}00005 \textcolor{keyword}{using }System.Threading.Tasks;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00006}00006 \textcolor{keyword}{using }System.Windows.Forms;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00007}00007 \textcolor{keyword}{using }System.Globalization;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00008}00008 \textcolor{keyword}{using }System.Drawing;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00009}00009 \textcolor{keyword}{using }System.Diagnostics;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00010}00010 \textcolor{keyword}{using }System.Threading;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00011}00011 \textcolor{keyword}{using }System.Reflection;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00012}00012 \textcolor{keyword}{using }System.IO;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00013}00013 \textcolor{keyword}{using }AForge;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00014}\mbox{\hyperlink{_microscope_8cs_a5ed305bd2d2d30db525508b3fdbba701}{00014}} \textcolor{keyword}{using }\mbox{\hyperlink{_abstract_flood_filler_8cs_a5ed305bd2d2d30db525508b3fdbba701}{Bitmap}} = AForge.Bitmap;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00015}\mbox{\hyperlink{_microscope_8cs_a14ef49ad2974385cd1ed312a721eb693}{00015}} \textcolor{keyword}{using }\mbox{\hyperlink{_abstract_flood_filler_8cs_a14ef49ad2974385cd1ed312a721eb693}{Color}} = AForge.Color;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00016}\mbox{\hyperlink{_microscope_8cs_af2fbde180fecc2a85bdf36b45cf8038c}{00016}} \textcolor{keyword}{using }\mbox{\hyperlink{_abstract_flood_filler_8cs_af2fbde180fecc2a85bdf36b45cf8038c}{PointF}} = AForge.PointF;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00017}\mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{00017}} \textcolor{keyword}{using }\mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} = AForge.PointD;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00018}\mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{00018}} \textcolor{keyword}{using }\mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} = AForge.Point3D;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00019}\mbox{\hyperlink{_microscope_8cs_aeceada93ecdf0c3819a29680a3c83037}{00019}} \textcolor{keyword}{using }\mbox{\hyperlink{_abstract_flood_filler_8cs_aeceada93ecdf0c3819a29680a3c83037}{RectangleF}} = AForge.RectangleF;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00020}\mbox{\hyperlink{_microscope_8cs_ac5609d8431341169243f140d51551a9a}{00020}} \textcolor{keyword}{using }\mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}} = AForge.RectangleD;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00021}\mbox{\hyperlink{_microscope_8cs_a8bfa98cfc43204ff8dd7743a94a22ea7}{00021}} \textcolor{keyword}{using }\mbox{\hyperlink{_abstract_flood_filler_8cs_a8bfa98cfc43204ff8dd7743a94a22ea7}{Rectangle}} = AForge.Rectangle;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00022}\mbox{\hyperlink{_microscope_8cs_a56dbdc2d1967068a5ea5467fa821244c}{00022}} \textcolor{keyword}{using }\mbox{\hyperlink{_abstract_flood_filler_8cs_a56dbdc2d1967068a5ea5467fa821244c}{Point}} = AForge.Point;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00023}00023 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_bio_imager}{BioImager}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00024}00024 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00025}00025     \textcolor{comment}{/* It's a wrapper for the stage*/}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00026}\mbox{\hyperlink{class_bio_imager_1_1_stage}{00026}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_stage}{Stage}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00027}00027     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00028}\mbox{\hyperlink{class_bio_imager_1_1_stage_ad59733cc571dde4917e0185fe2e70ccc}{00028}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_ad59733cc571dde4917e0185fe2e70ccc}{minX}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00029}\mbox{\hyperlink{class_bio_imager_1_1_stage_a1b694e3b06dd5ed5968ca38f513cb8f1}{00029}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_a1b694e3b06dd5ed5968ca38f513cb8f1}{maxX}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00030}\mbox{\hyperlink{class_bio_imager_1_1_stage_af13f5e5aad1ad7cd207805694dc2161a}{00030}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_af13f5e5aad1ad7cd207805694dc2161a}{minY}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00031}\mbox{\hyperlink{class_bio_imager_1_1_stage_ae85c5bec42a23dde55060fc736d28826}{00031}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_ae85c5bec42a23dde55060fc736d28826}{maxY}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00032}00032         \textcolor{comment}{/* Creating a new instance of the Stage class. */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00033}\mbox{\hyperlink{class_bio_imager_1_1_stage_a06b6189ad126b0f56fd12594614665f5}{00033}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_stage_a06b6189ad126b0f56fd12594614665f5}{Stage}}(\textcolor{keywordtype}{object} st)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00034}00034         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00035}00035             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00036}00036             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00037}00037                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} d = \mbox{\hyperlink{class_bio_imager_1_1_stage_a20fce9f3b88830c36ce0cd47df783da8}{GetPosition}}(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00038}00038                 x = d.X;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00039}00039                 y = d.Y;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00040}00040                 \mbox{\hyperlink{class_bio_imager_1_1_stage_a5744af87c4ecf45b1ecfc3dc16397be2}{UpdateSWLimit}}();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00041}00041             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00042}00042         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00043}\mbox{\hyperlink{class_bio_imager_1_1_stage_ab13529b062fa5dbbc6836f7dfb25b078}{00043}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_stage_ab13529b062fa5dbbc6836f7dfb25b078}{Stage}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00044}00044         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00046}00046         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00048}00048         \textcolor{keyword}{private} \textcolor{keywordtype}{double} x;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00049}00049         \textcolor{keyword}{private} \textcolor{keywordtype}{double} y;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00050}\mbox{\hyperlink{class_bio_imager_1_1_stage_aee8543bfa0854831563097965797ca70}{00050}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_aee8543bfa0854831563097965797ca70}{X}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00051}00051         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00052}00052             \textcolor{keyword}{get}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00053}00053             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00054}00054                 \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00055}00055             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00056}00056         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00057}\mbox{\hyperlink{class_bio_imager_1_1_stage_ad5843d4e529e4d7e43e24904173d5f13}{00057}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_ad5843d4e529e4d7e43e24904173d5f13}{Y}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00058}00058         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00059}00059             \textcolor{keyword}{get}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00060}00060             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00061}00061                 \textcolor{keywordflow}{return} y;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00062}00062             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00063}00063         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00064}\mbox{\hyperlink{class_bio_imager_1_1_stage_a3542e9e8d88ff182e588c5a63a507607}{00064}}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_stage_a3542e9e8d88ff182e588c5a63a507607}{moveWait}} = 250;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00065}00065         \textcolor{keyword}{private} \textcolor{keywordtype}{void} MoveWait()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00066}00066         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00067}00067             Thread.Sleep(\mbox{\hyperlink{class_bio_imager_1_1_stage_a3542e9e8d88ff182e588c5a63a507607}{moveWait}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00068}00068         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00074}\mbox{\hyperlink{class_bio_imager_1_1_stage_a6be17e961ed1c407cbc79b1d79f3fbe3}{00074}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_a6be17e961ed1c407cbc79b1d79f3fbe3}{SetPosition}}(\textcolor{keywordtype}{double} px, \textcolor{keywordtype}{double} py)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00075}00075         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00076}00076             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00077}00077                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.Stage.SetPosition("{}} + px + \textcolor{stringliteral}{"{},"{}} + py + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00078}00078             x = px;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00079}00079             y = py;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00080}00080             \textcolor{keywordflow}{if}(Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00081}00081             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00082}00082                 Microscope.pMicroscope.SetPosition(\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(px, py));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00083}00083             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00084}00084             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00085}00085             \textcolor{keywordflow}{if} (Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00086}00086             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00087}00087                 PycroManager.SetPosition(\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(px, py));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00088}00088             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00089}00089             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00090}00090             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00091}00091             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00092}00092                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetStage, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[]\{px,py \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00093}00093             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00094}00094             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00095}00095             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00096}00096                 Microscope.sdk.SetPosition(\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(px, py));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00097}00097             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00098}00098             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_app}{App}}.\mbox{\hyperlink{class_bio_imager_1_1_app_ae9ab2de046e738999cfbbccb0d3c1c3e}{viewer}} != \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00099}00099                 \mbox{\hyperlink{class_bio_imager_1_1_app}{App}}.\mbox{\hyperlink{class_bio_imager_1_1_app_ae9ab2de046e738999cfbbccb0d3c1c3e}{viewer}}.\mbox{\hyperlink{class_bio_imager_1_1_image_view_adc65e6e60745ab28f68c3e63642f547e}{UpdateView}}(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00100}00100         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00101}00101        }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00105}\mbox{\hyperlink{class_bio_imager_1_1_stage_ae97677b0a7582eccfefad42d8ed42d68}{00105}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_ae97677b0a7582eccfefad42d8ed42d68}{SetPositionX}}(\textcolor{keywordtype}{double} px)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00106}00106         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00107}00107             x = px;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00108}00108             \mbox{\hyperlink{class_bio_imager_1_1_stage_a6be17e961ed1c407cbc79b1d79f3fbe3}{SetPosition}}(px, y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00109}00109         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00110}00110         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00114}\mbox{\hyperlink{class_bio_imager_1_1_stage_ab83a0de9ebef1a1b5cac36e6cb7d6093}{00114}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_ab83a0de9ebef1a1b5cac36e6cb7d6093}{SetPositionY}}(\textcolor{keywordtype}{double} py)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00115}00115         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00116}00116             y = py;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00117}00117             \mbox{\hyperlink{class_bio_imager_1_1_stage_a6be17e961ed1c407cbc79b1d79f3fbe3}{SetPosition}}(x, py);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00118}00118         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00119}00119         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00125}\mbox{\hyperlink{class_bio_imager_1_1_stage_a7c8c161744a78b30af76204464c487ad}{00125}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_a7c8c161744a78b30af76204464c487ad}{GetPositionX}}(\textcolor{keywordtype}{bool} update)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00126}00126         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00127}00127             x = \mbox{\hyperlink{class_bio_imager_1_1_stage_a20fce9f3b88830c36ce0cd47df783da8}{GetPosition}}(update).X;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00128}00128             \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00129}00129         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00130}00130         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00136}\mbox{\hyperlink{class_bio_imager_1_1_stage_a20587aade4ebdfc011cf1fa5443646ca}{00136}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_stage_a20587aade4ebdfc011cf1fa5443646ca}{GetPositionY}}(\textcolor{keywordtype}{bool} update)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00137}00137         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00138}00138             y = \mbox{\hyperlink{class_bio_imager_1_1_stage_a20fce9f3b88830c36ce0cd47df783da8}{GetPosition}}(update).Y;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00139}00139             \textcolor{keywordflow}{return} y;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00140}00140         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00141}00141         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00150}\mbox{\hyperlink{class_bio_imager_1_1_stage_a20fce9f3b88830c36ce0cd47df783da8}{00150}}         \textcolor{keyword}{public} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} \mbox{\hyperlink{class_bio_imager_1_1_stage_a20fce9f3b88830c36ce0cd47df783da8}{GetPosition}}(\textcolor{keywordtype}{bool} update)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00151}00151         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00152}00152             \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00153}00153             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00154}00154                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} pd;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00155}00155                 Microscope.pMicroscope.GetPosition(out pd,\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00156}00156                 \textcolor{keywordflow}{return} pd;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00157}00157             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00158}00158             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00159}00159             \textcolor{keywordflow}{if} (Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00160}00160             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00161}00161                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} pd;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00162}00162                 PycroManager.GetPosition(out pd, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00163}00163                 \textcolor{keywordflow}{return} pd;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00164}00164             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00165}00165             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00166}00166             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00167}00167             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00168}00168                 \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00169}00169                     (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetStage,\textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00170}00170                 \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0], com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[1]);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00171}00171             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00172}00172             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00173}00173             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00174}00174                 \textcolor{keywordflow}{return} Microscope.sdk.GetPosition();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00175}00175             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00176}00176             \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(x, y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00177}00177         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00178}00178         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00182}\mbox{\hyperlink{class_bio_imager_1_1_stage_a873ab0191d190c370c3cf81ed440ef15}{00182}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_a873ab0191d190c370c3cf81ed440ef15}{MoveUp}}(\textcolor{keywordtype}{double} m)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00183}00183         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00184}00184             \textcolor{keywordtype}{double} y = \mbox{\hyperlink{class_bio_imager_1_1_stage_a20587aade4ebdfc011cf1fa5443646ca}{GetPositionY}}(\textcolor{keyword}{true}) -\/ m;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00185}00185             \mbox{\hyperlink{class_bio_imager_1_1_stage_ab83a0de9ebef1a1b5cac36e6cb7d6093}{SetPositionY}}(y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00186}00186         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00187}00187        }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00191}\mbox{\hyperlink{class_bio_imager_1_1_stage_a8b84ed0aefe1d36e92f8d1b949599480}{00191}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_a8b84ed0aefe1d36e92f8d1b949599480}{MoveDown}}(\textcolor{keywordtype}{double} m)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00192}00192         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00193}00193             \textcolor{keywordtype}{double} y = \mbox{\hyperlink{class_bio_imager_1_1_stage_a20587aade4ebdfc011cf1fa5443646ca}{GetPositionY}}(\textcolor{keyword}{true}) + m;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00194}00194             \mbox{\hyperlink{class_bio_imager_1_1_stage_ab83a0de9ebef1a1b5cac36e6cb7d6093}{SetPositionY}}(y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00195}00195         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00196}00196         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00200}\mbox{\hyperlink{class_bio_imager_1_1_stage_a55d5b544e29bbb50b8b7e83675df1a9d}{00200}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_a55d5b544e29bbb50b8b7e83675df1a9d}{MoveRight}}(\textcolor{keywordtype}{double} m)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00201}00201         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00202}00202             \textcolor{keywordtype}{double} x = \mbox{\hyperlink{class_bio_imager_1_1_stage_a7c8c161744a78b30af76204464c487ad}{GetPositionX}}(\textcolor{keyword}{true}) + m;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00203}00203             \mbox{\hyperlink{class_bio_imager_1_1_stage_ae97677b0a7582eccfefad42d8ed42d68}{SetPositionX}}(x);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00204}00204         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00205}00205         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00209}\mbox{\hyperlink{class_bio_imager_1_1_stage_ac1936e79912e77b8dcd73689a20ed841}{00209}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_ac1936e79912e77b8dcd73689a20ed841}{MoveLeft}}(\textcolor{keywordtype}{double} m)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00210}00210         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00211}00211             \textcolor{keywordtype}{double} x = \mbox{\hyperlink{class_bio_imager_1_1_stage_a7c8c161744a78b30af76204464c487ad}{GetPositionX}}(\textcolor{keyword}{true}) -\/ m;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00212}00212             \mbox{\hyperlink{class_bio_imager_1_1_stage_ae97677b0a7582eccfefad42d8ed42d68}{SetPositionX}}(x);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00213}00213         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00214}00214         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00216}\mbox{\hyperlink{class_bio_imager_1_1_stage_a5744af87c4ecf45b1ecfc3dc16397be2}{00216}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_a5744af87c4ecf45b1ecfc3dc16397be2}{UpdateSWLimit}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00217}00217         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00218}00218             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00219}00219             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00220}00220                 \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00221}00221                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetStageSWLimit, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00222}00222                 \mbox{\hyperlink{class_bio_imager_1_1_stage_ad59733cc571dde4917e0185fe2e70ccc}{minX}} = com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00223}00223                 \mbox{\hyperlink{class_bio_imager_1_1_stage_af13f5e5aad1ad7cd207805694dc2161a}{minY}} = com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[1];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00224}00224                 \mbox{\hyperlink{class_bio_imager_1_1_stage_a1b694e3b06dd5ed5968ca38f513cb8f1}{maxX}} = com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[2];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00225}00225                 \mbox{\hyperlink{class_bio_imager_1_1_stage_ae85c5bec42a23dde55060fc736d28826}{maxY}} = com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[3];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00226}00226             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00227}00227         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00228}00228        }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00235}\mbox{\hyperlink{class_bio_imager_1_1_stage_a93eae2a85e5fb45ed4a3b6280134aa3e}{00235}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_stage_a93eae2a85e5fb45ed4a3b6280134aa3e}{SetSWLimit}}(\textcolor{keywordtype}{double} xmin, \textcolor{keywordtype}{double} xmax, \textcolor{keywordtype}{double} ymin, \textcolor{keywordtype}{double} ymax)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00236}00236         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00237}00237             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00238}00238             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00239}00239                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00240}00240                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetStageSWLimit, }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00241}00241                     \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{xmin,xmax,ymin,ymax\}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00242}00242             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00243}00243             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00244}00244                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.Focus.SetSWLimit("{}} + xmin + \textcolor{stringliteral}{"{},"{}} + xmax + \textcolor{stringliteral}{"{},"{}} + ymin + \textcolor{stringliteral}{"{},"{}} + ymax + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00245}00245         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00246}00246     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00248}00248     \textcolor{comment}{/* The Focus class is used to set and get the focus of the microscope */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00249}\mbox{\hyperlink{class_bio_imager_1_1_focus}{00249}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_focus}{Focus}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00250}00250     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00251}\mbox{\hyperlink{class_bio_imager_1_1_focus_a7da907f6afa75ed5defde9ef70b287b3}{00251}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_focus_a7da907f6afa75ed5defde9ef70b287b3}{upperLimit}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00252}\mbox{\hyperlink{class_bio_imager_1_1_focus_a70700576739deeaebdc36daf0ad72eac}{00252}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_focus_a70700576739deeaebdc36daf0ad72eac}{lowerLimit}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00253}00253         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{double} z;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00254}\mbox{\hyperlink{class_bio_imager_1_1_focus_a4c17fd00e2f019b04bce13a0aaf4c957}{00254}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_focus_a4c17fd00e2f019b04bce13a0aaf4c957}{Focus}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00255}00255         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00257}00257         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00262}\mbox{\hyperlink{class_bio_imager_1_1_focus_a987ece342f70bcd2ae93b36d0b727e68}{00262}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_focus_a987ece342f70bcd2ae93b36d0b727e68}{SetFocus}}(\textcolor{keywordtype}{double} f)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00263}00263         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00264}00264             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00265}00265                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.Focus.SetFocus("{}} + f + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00266}00266             \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00267}00267             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00268}00268                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} p = Microscope.Stage.GetPosition(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00269}00269                 Microscope.pMicroscope.SetPosition(\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}(p.X,p.Y,f));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00270}00270             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00271}00271             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00272}00272             \textcolor{keywordflow}{if} (Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00273}00273             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00274}00274                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} p = Microscope.Stage.GetPosition(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00275}00275                 PycroManager.SetPosition(\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}(p.X, p.Y, f));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00276}00276             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00277}00277             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00278}00278             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00279}00279             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00280}00280                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00281}00281                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetFocus,\textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ f\}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00282}00282                 z = f;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00283}00283             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00284}00284             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00285}00285             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00286}00286                 Microscope.sdk.SetZ(f);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00287}00287             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00288}00288             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_ad13d59c5cacf2f0b80e2524b2c31c8b2}{Properties}}.ContainsKey(\textcolor{stringliteral}{"{}SetFocus"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00289}00289             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00290}00290                 \mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_a4191d900725c4a9b9cd404592509ab99}{SetProperty}}(\textcolor{stringliteral}{"{}SetFocus"{}}, f.ToString());}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00291}00291             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00292}00292         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00293}00293 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00297}\mbox{\hyperlink{class_bio_imager_1_1_focus_a3cca66b920dadb0649c9bffeb87a0ac0}{00297}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_focus_a3cca66b920dadb0649c9bffeb87a0ac0}{GetFocus}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00298}00298         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00299}00299             \textcolor{keywordflow}{return} \mbox{\hyperlink{class_bio_imager_1_1_focus_a3cca66b920dadb0649c9bffeb87a0ac0}{GetFocus}}(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00300}00300         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00301}00301 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00309}\mbox{\hyperlink{class_bio_imager_1_1_focus_a490d467a04084f8ed73be0157f794156}{00309}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_focus_a490d467a04084f8ed73be0157f794156}{GetFocus}}(\textcolor{keywordtype}{bool} update)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00310}00310         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00311}00311             \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00312}00312             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00313}00313                 \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00314}00314                 Microscope.pMicroscope.GetPosition3D(out p, update);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00315}00315                 \textcolor{keywordflow}{return} p.Z;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00316}00316             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00317}00317             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00318}00318             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00319}00319                 \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00320}00320                 PycroManager.GetPosition3D(out p, update);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00321}00321                 \textcolor{keywordflow}{return} p.Z;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00322}00322             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00323}00323             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00324}00324             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00325}00325                 \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00326}00326                     (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetFocus, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00327}00327                 \textcolor{keywordflow}{return} com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00328}00328             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00329}00329             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00330}00330             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00331}00331                 \textcolor{keywordflow}{return} Microscope.sdk.GetZ();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00332}00332             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00333}00333             \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_ad13d59c5cacf2f0b80e2524b2c31c8b2}{Properties}}.ContainsKey(\textcolor{stringliteral}{"{}GetFocus"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00334}00334             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00335}00335                 \textcolor{keywordflow}{return} (\textcolor{keywordtype}{double})\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}GetFocus"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00336}00336             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00337}00337             \textcolor{keywordflow}{return} z;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00338}00338         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00339}00339 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00343}\mbox{\hyperlink{class_bio_imager_1_1_focus_a4066fa2ce5019736fac41f717966b9cc}{00343}}         \textcolor{keyword}{public} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} \mbox{\hyperlink{class_bio_imager_1_1_focus_a4066fa2ce5019736fac41f717966b9cc}{GetSWLimit}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00344}00344         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00345}00345             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00346}00346             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00347}00347                 \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00348}00348                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetStageSWLimit, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00349}00349                 \mbox{\hyperlink{class_bio_imager_1_1_focus_a7da907f6afa75ed5defde9ef70b287b3}{upperLimit}} = com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00350}00350                 \mbox{\hyperlink{class_bio_imager_1_1_focus_a70700576739deeaebdc36daf0ad72eac}{lowerLimit}} = com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[1];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00351}00351                 \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(\mbox{\hyperlink{class_bio_imager_1_1_focus_a7da907f6afa75ed5defde9ef70b287b3}{upperLimit}},\mbox{\hyperlink{class_bio_imager_1_1_focus_a70700576739deeaebdc36daf0ad72eac}{lowerLimit}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00352}00352             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00353}00353             \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(\mbox{\hyperlink{class_bio_imager_1_1_focus_a70700576739deeaebdc36daf0ad72eac}{lowerLimit}}, \mbox{\hyperlink{class_bio_imager_1_1_focus_a7da907f6afa75ed5defde9ef70b287b3}{upperLimit}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00354}00354         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00361}\mbox{\hyperlink{class_bio_imager_1_1_focus_a199cda7cb657515b7f88a9994efb0854}{00361}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_focus_a199cda7cb657515b7f88a9994efb0854}{SetSWLimit}}(\textcolor{keywordtype}{double} xd, \textcolor{keywordtype}{double} yd)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00362}00362         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00363}00363             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00364}00364             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00365}00365                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00366}00366                    \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetFocusSWLimit,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00367}00367                    \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ xd, yd \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00368}00368             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00369}00369             \mbox{\hyperlink{class_bio_imager_1_1_focus_a7da907f6afa75ed5defde9ef70b287b3}{upperLimit}} = xd;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00370}00370             \mbox{\hyperlink{class_bio_imager_1_1_focus_a70700576739deeaebdc36daf0ad72eac}{lowerLimit}} = yd;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00371}00371             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00372}00372                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.Focus.SetSWLimit("{}} + xd + \textcolor{stringliteral}{"{},"{}} + yd + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00373}00373         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00374}00374     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00375}00375 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00376}00376     \textcolor{comment}{/* The Objectives class is a class that contains a list of objectives */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00377}\mbox{\hyperlink{class_bio_imager_1_1_objectives}{00377}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_objectives}{Objectives}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00378}00378     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00379}\mbox{\hyperlink{class_bio_imager_1_1_objectives_a67454c66c18c35e6bd2113c6dd474803}{00379}}         \textcolor{keyword}{public} List<Objective> \mbox{\hyperlink{class_bio_imager_1_1_objectives_a67454c66c18c35e6bd2113c6dd474803}{List}} = \textcolor{keyword}{new} List<Objective>();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00380}00380        \textcolor{comment}{/* Creating a list of objectives. */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00381}\mbox{\hyperlink{class_bio_imager_1_1_objectives_adb1ca1832605990d9d73300f3b78d592}{00381}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_objectives_adb1ca1832605990d9d73300f3b78d592}{Objectives}}(\textcolor{keywordtype}{int} count)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00382}00382         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00383}00383             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < count; i++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00384}00384             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00385}00385                 \mbox{\hyperlink{class_bio_imager_1_1_objectives_a67454c66c18c35e6bd2113c6dd474803}{List}}.Add(\textcolor{keyword}{new} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective}{Objective}}(i));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00386}00386             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00387}00387         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00388}00388         \textcolor{comment}{/* The Objective class is a class that contains all the information about the objective */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00389}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective}{00389}}         \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective}{Objective}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00390}00390         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00391}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a3e9e6139e461b52e47b07945ba604d69}{00391}}             \textcolor{keyword}{public} Dictionary<string, object> \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a3e9e6139e461b52e47b07945ba604d69}{config}} = \textcolor{keyword}{new} Dictionary<string, object>();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00392}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a0d410199d041e13aa89fbc23657946a8}{00392}}             \textcolor{keyword}{public} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a0d410199d041e13aa89fbc23657946a8}{Index}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00393}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a43f0b1556318b20fd7acfcc45fbe6a8d}{00393}}             \textcolor{keyword}{public} \textcolor{keywordtype}{string} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a43f0b1556318b20fd7acfcc45fbe6a8d}{Name}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00394}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_ac4019e967e4ea33e35713f979b0c6712}{00394}}             \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_ac4019e967e4ea33e35713f979b0c6712}{LocateExposure}} = 50;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00395}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a3ca7af8507ac2a87af15693d72c54780}{00395}}             \textcolor{keyword}{public} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a3ca7af8507ac2a87af15693d72c54780}{WorkingDistance}} = 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00396}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a7eff8aaaa427e7d67c64554d94fb2f9b}{00396}}             \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a7eff8aaaa427e7d67c64554d94fb2f9b}{AcquisitionExposure}} = 50;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00397}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a02e2fb5e3c8251ffadf756803b842f9d}{00397}}             \textcolor{keyword}{public} \textcolor{keywordtype}{string} \mbox{\hyperlink{class_bio_imager_1_1_configuration}{Configuration}} = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00398}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a806e22de8c5c30a4d8a63cd6e1b003b7}{00398}}             \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a806e22de8c5c30a4d8a63cd6e1b003b7}{MoveAmountL}} = 40;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00399}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_ac560ebcd1c488bccbd94abe4531b7793}{00399}}             \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_ac560ebcd1c488bccbd94abe4531b7793}{MoveAmountR}} = 10;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00400}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_aa3991ec77c169ff043de2a3d39102b74}{00400}}             \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_aa3991ec77c169ff043de2a3d39102b74}{FocusMoveAmount}} = 0.02;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00401}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a4d7c1de8ff5b636744a3c93fd2d03c5b}{00401}}             \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a4d7c1de8ff5b636744a3c93fd2d03c5b}{ViewWidth}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00402}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_abed6eb154626fa72946781745a0d5296}{00402}}             \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_abed6eb154626fa72946781745a0d5296}{ViewHeight}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00403}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a50b527790c1a71b647274fa2a23078a9}{00403}}             \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a50b527790c1a71b647274fa2a23078a9}{Objective}}(\textcolor{keywordtype}{int} index)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00404}00404             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00405}00405                 \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a0d410199d041e13aa89fbc23657946a8}{Index}} = index;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00406}00406             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00407}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_aa72a306f3e4d43b895451120042cbbe1}{00407}}             \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_aa72a306f3e4d43b895451120042cbbe1}{Objective}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00408}00408             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00409}00409             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00410}\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a6ef337710e058c90ace8bbb585045abe}{00410}}             \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{string} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a6ef337710e058c90ace8bbb585045abe}{ToString}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00411}00411             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00412}00412                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a43f0b1556318b20fd7acfcc45fbe6a8d}{Name}} == \textcolor{stringliteral}{"{}"{}} || \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a43f0b1556318b20fd7acfcc45fbe6a8d}{Name}} == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00413}00413                     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}Objective "{}} + \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a0d410199d041e13aa89fbc23657946a8}{Index}}.ToString();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00414}00414                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective_a43f0b1556318b20fd7acfcc45fbe6a8d}{Name}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00415}00415             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00416}00416         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00417}00417         \textcolor{keyword}{private} \textcolor{keywordtype}{int} index;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00418}\mbox{\hyperlink{class_bio_imager_1_1_objectives_a3c92e57f092ca055d04b21e4ae49e323}{00418}}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_objectives_a3c92e57f092ca055d04b21e4ae49e323}{moveWait}} = 1000;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00419}00419         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00421}00421         \textcolor{keyword}{private} \textcolor{keywordtype}{void} MoveWait()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00422}00422         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00423}00423             Thread.Sleep(\mbox{\hyperlink{class_bio_imager_1_1_objectives_a3c92e57f092ca055d04b21e4ae49e323}{moveWait}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00424}00424         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00425}\mbox{\hyperlink{class_bio_imager_1_1_objectives_ad68236c570322079146cdd80f933a8d1}{00425}}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_objectives_ad68236c570322079146cdd80f933a8d1}{Index}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00426}00426         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00427}00427             \textcolor{keyword}{get}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00428}00428             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00429}00429                 \textcolor{keywordflow}{return} \mbox{\hyperlink{class_bio_imager_1_1_objectives_a3d39e318139518541e51d59c8e49d3a6}{GetPosition}}();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00430}00430             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00431}00431             \textcolor{keyword}{set}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00432}00432             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00433}00433                 \mbox{\hyperlink{class_bio_imager_1_1_objectives_a6f0bac237fb165223e6c33835992f5f3}{SetPosition}}(value);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00434}00434             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00435}00435         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00436}00436         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00443}\mbox{\hyperlink{class_bio_imager_1_1_objectives_a6f0bac237fb165223e6c33835992f5f3}{00443}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_objectives_a6f0bac237fb165223e6c33835992f5f3}{SetPosition}}(\textcolor{keywordtype}{int} index)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00444}00444         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00445}00445             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00446}00446                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.Objectives.SetObjective("{}} + index + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00447}00447             this.index = index;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00448}00448             \textcolor{keywordflow}{if} (!Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}) \&\& !Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}) \&\& \mbox{\hyperlink{class_bio_imager_1_1_function}{Function}}.\mbox{\hyperlink{class_bio_imager_1_1_function_a7bac28254f924ae8ddb8f1d1daa61546}{Functions}}.ContainsKey(\textcolor{stringliteral}{"{}SetO"{}} + index))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00449}00449             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00450}00450                 \mbox{\hyperlink{class_bio_imager_1_1_function}{Function}} f = \mbox{\hyperlink{class_bio_imager_1_1_function}{Function}}.\mbox{\hyperlink{class_bio_imager_1_1_function_a7bac28254f924ae8ddb8f1d1daa61546}{Functions}}[\textcolor{stringliteral}{"{}SetO"{}} + index];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00451}00451                 \mbox{\hyperlink{class_bio_imager_1_1_app}{App}}.\mbox{\hyperlink{class_bio_imager_1_1_app_af593135aa8a2985488e36b56b70cbe92}{imager}}.\mbox{\hyperlink{class_bio_imager_1_1_imager_acbaa41ce4ee9c71a18c94f55527618e0}{PerformFunction}}(f);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00452}00452                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00453}00453             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00454}00454             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00455}00455             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00456}00456                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00457}00457                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetObjective, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ index \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00458}00458                 this.index = index;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00459}00459             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00460}00460             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00461}00461             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00462}00462                 PycroManager.Objectives.SetPosition(index);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00463}00463             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00464}00464         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00465}00465         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00466}\mbox{\hyperlink{class_bio_imager_1_1_objectives_a3d39e318139518541e51d59c8e49d3a6}{00466}}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_objectives_a3d39e318139518541e51d59c8e49d3a6}{GetPosition}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00467}00467         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00468}00468             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00469}00469             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00470}00470                 \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00471}00471                     (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetObjective, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00472}00472                 \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00473}00473             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00474}00474             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00475}00475             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00476}00476                 \textcolor{keywordflow}{return} Microscope.sdk.GetNosePiece();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00477}00477             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00478}00478             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00479}00479             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00480}00480                 \textcolor{keywordflow}{return} PycroManager.Objectives.GetPosition();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00481}00481             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00482}00482             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!Properties.Settings.Default.PMicroscope \&\& \mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_ad13d59c5cacf2f0b80e2524b2c31c8b2}{Properties}}.ContainsKey(\textcolor{stringliteral}{"{}GetO1"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00483}00483             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00484}00484                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_function}{Function}}.\mbox{\hyperlink{class_bio_imager_1_1_function_a7bac28254f924ae8ddb8f1d1daa61546}{Functions}}.ContainsKey(\textcolor{stringliteral}{"{}GetO7"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00485}00485                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00486}00486                     \textcolor{keywordtype}{bool} b;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00487}00487                     \textcolor{comment}{//We check each objective button state to determine which objective we currently are in.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00488}00488                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get01"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00489}00489                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00490}00490                         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00491}00491                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get02"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00492}00492                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00493}00493                         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00494}00494                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get03"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00495}00495                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00496}00496                         \textcolor{keywordflow}{return} 2;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00497}00497                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get04"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00498}00498                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00499}00499                         \textcolor{keywordflow}{return} 3;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00500}00500                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get05"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00501}00501                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00502}00502                         \textcolor{keywordflow}{return} 4;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00503}00503                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get06"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00504}00504                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00505}00505                         \textcolor{keywordflow}{return} 5;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00506}00506                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get07"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00507}00507                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00508}00508                         \textcolor{keywordflow}{return} 6;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00509}00509                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00510}00510                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00511}00511                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00512}00512                     \textcolor{keywordtype}{bool} b;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00513}00513                     \textcolor{comment}{//We check each objective button state to determine which objective we currently are in.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00514}00514                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get01"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00515}00515                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00516}00516                         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00517}00517                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get02"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00518}00518                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00519}00519                         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00520}00520                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get03"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00521}00521                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00522}00522                         \textcolor{keywordflow}{return} 2;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00523}00523                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get04"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00524}00524                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00525}00525                         \textcolor{keywordflow}{return} 3;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00526}00526                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get05"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00527}00527                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00528}00528                         \textcolor{keywordflow}{return} 4;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00529}00529                     b = (bool)\mbox{\hyperlink{class_bio_imager_1_1_automation}{Automation}}.\mbox{\hyperlink{class_bio_imager_1_1_automation_abf0aacc1f9ca0ad260a6c2710f9813b1}{GetProperty}}(\textcolor{stringliteral}{"{}Get06"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00530}00530                     \textcolor{keywordflow}{if} (b)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00531}00531                         \textcolor{keywordflow}{return} 5;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00532}00532                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00533}00533             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00534}00534             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00535}00535         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00536}\mbox{\hyperlink{class_bio_imager_1_1_objectives_a8552670c460deb92284dc9ae268a4bd1}{00536}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_objectives_1_1_objective}{Objective}} \mbox{\hyperlink{class_bio_imager_1_1_objectives_a8552670c460deb92284dc9ae268a4bd1}{GetObjective}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00537}00537         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00538}00538             \textcolor{keywordflow}{return} \mbox{\hyperlink{class_bio_imager_1_1_objectives_a67454c66c18c35e6bd2113c6dd474803}{List}}[(short)\mbox{\hyperlink{class_bio_imager_1_1_objectives_a3d39e318139518541e51d59c8e49d3a6}{GetPosition}}()];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00539}00539         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00540}00540     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00541}00541 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00542}00542    \textcolor{comment}{/* The TLShutter class is a wrapper class for the shutter object */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00543}\mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter}{00543}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter}{TLShutter}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00544}00544     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00545}\mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_afb716cf26b79ce1c3f9caae0251a2a81}{00545}}         \textcolor{keyword}{public} \textcolor{keyword}{static} Type \mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_afb716cf26b79ce1c3f9caae0251a2a81}{tlType}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00546}\mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_ab86f7fbdac462b41183532bf8db886c0}{00546}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{object} \mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_ab86f7fbdac462b41183532bf8db886c0}{tlShutter}} = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00547}\mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_a3264be4f0778ece1f5a1b9810e34409a}{00547}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_a3264be4f0778ece1f5a1b9810e34409a}{position}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00552}\mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_af1c503bfce2c497e27815e87ccaeec35}{00552}}         \textcolor{keyword}{public} \textcolor{keywordtype}{short} \mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_af1c503bfce2c497e27815e87ccaeec35}{GetPosition}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00553}00553         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00554}00554             \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00555}00555                     (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetTLShutter, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00556}00556             \textcolor{keywordflow}{return} (\textcolor{keywordtype}{short})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00557}00557         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00558}00558         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00565}\mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_a61b55f08679c2826450c1f44505bc51f}{00565}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_a61b55f08679c2826450c1f44505bc51f}{SetPosition}}(\textcolor{keywordtype}{int} p)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00566}00566         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00567}00567             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00568}00568                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.TLShutter.SetPosition("{}} + p + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00569}00569             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00570}00570             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00571}00571                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00572}00572                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetTLShutter, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ p \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00573}00573                 \mbox{\hyperlink{class_bio_imager_1_1_t_l_shutter_a3264be4f0778ece1f5a1b9810e34409a}{position}} = p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00574}00574             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00575}00575             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00576}00576             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00577}00577                 \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00578}00578                     Microscope.sdk.shutterClose();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00579}00579                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00580}00580                     Microscope.sdk.shutterOpen();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00581}00581             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00582}00582         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00583}00583     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00584}00584    \textcolor{comment}{/* The HXPShutter class is a wrapper class for the TLShutter class */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00585}\mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter}{00585}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter}{HXPShutter}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00586}00586     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00587}\mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_aca38811d6ca66ed9fb9453ceb403f130}{00587}}         \textcolor{keyword}{public} \textcolor{keyword}{static} Type \mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_aca38811d6ca66ed9fb9453ceb403f130}{tlType}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00588}\mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a8c932d52d9e11ec7402204e4fa1b5a07}{00588}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{object} \mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a8c932d52d9e11ec7402204e4fa1b5a07}{tlShutter}} = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00589}\mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a073c380df892f6cee6e31b956b624929}{00589}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a073c380df892f6cee6e31b956b624929}{position}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00594}\mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a57a4e44a0d7c4373cbdffa295339c6c1}{00594}}         \textcolor{keyword}{public} \textcolor{keywordtype}{short} \mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a57a4e44a0d7c4373cbdffa295339c6c1}{GetPosition}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00595}00595         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00596}00596             \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00597}00597                     (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetHXPShutter, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00598}00598             \textcolor{keywordflow}{if} (com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}} == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00599}00599                 \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00600}00600             \textcolor{keywordflow}{return} (\textcolor{keywordtype}{short})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00601}00601         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00609}\mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a8af9f47a21552dd305846866e242d0d8}{00609}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a8af9f47a21552dd305846866e242d0d8}{SetPosition}}(\textcolor{keywordtype}{int} p)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00610}00610         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00611}00611             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00612}00612                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.TLShutter.SetPosition("{}} + p + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00613}00613             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00614}00614             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00615}00615                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00616}00616                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetHXPShutter, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ p \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00617}00617                 \mbox{\hyperlink{class_bio_imager_1_1_h_x_p_shutter_a073c380df892f6cee6e31b956b624929}{position}} = p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00618}00618             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00619}00619         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00620}00620     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00621}00621 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00622}00622     \textcolor{comment}{/* The RLShutter class is a wrapper class for the IMTBChanger interface */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00623}\mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter}{00623}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter}{RLShutter}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00624}00624     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00625}\mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_a484a51409a0e860dc15a04a34f70c3c1}{00625}}         \textcolor{keyword}{public} \textcolor{keyword}{static} Type \mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_a484a51409a0e860dc15a04a34f70c3c1}{rlType}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00626}\mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_a6238a595f7bb709592f113e2fb3e8910}{00626}}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{object} \mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_a6238a595f7bb709592f113e2fb3e8910}{rlShutter}} = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00627}00627         \textcolor{keyword}{internal} \textcolor{keyword}{static} \textcolor{keywordtype}{int} position;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00632}\mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_acf43f92509de19849a7131cb133a6609}{00632}}         \textcolor{keyword}{public} \textcolor{keywordtype}{short} \mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_acf43f92509de19849a7131cb133a6609}{GetPosition}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00633}00633         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00634}00634             \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00635}00635                     (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetRLShutter, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00636}00636             \textcolor{keywordflow}{return} (\textcolor{keywordtype}{short})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00637}00637         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00638}00638        }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00643}\mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_afb0b566f64410928656fa9eb555429a9}{00643}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_r_l_shutter_afb0b566f64410928656fa9eb555429a9}{SetPosition}}(\textcolor{keywordtype}{int} p)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00644}00644         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00645}00645             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00646}00646             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00647}00647                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00648}00648                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetRLShutter, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ p \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00649}00649             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00650}00650             position = p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00651}00651             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00652}00652                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.RLShutter.SetPosition("{}} + p + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00653}00653         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00654}00654     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00655}00655 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00656}00656     \textcolor{comment}{/* The LightSource class is a wrapper class for the IMTBContinual interface. */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00657}\mbox{\hyperlink{class_bio_imager_1_1_light_source}{00657}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_light_source}{LightSource}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00658}00658     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00659}\mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{00659}}         \textcolor{keyword}{public} \textcolor{keyword}{enum} \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00660}00660         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00661}00661             HXP,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00662}00662             RL,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00663}00663             TL}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00664}00664         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00665}\mbox{\hyperlink{class_bio_imager_1_1_light_source_a16e29b57c79fbfbd6a40b5466a1395b0}{00665}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_light_source_a16e29b57c79fbfbd6a40b5466a1395b0}{position}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00666}\mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{00666}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}} \mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{type}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00667}00667         \textcolor{keywordtype}{string} name;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00668}\mbox{\hyperlink{class_bio_imager_1_1_light_source_aad005f05f200a2a032c38bc58ffd27e2}{00668}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_light_source_aad005f05f200a2a032c38bc58ffd27e2}{LightSource}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00669}00669         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00670}00670         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00674}\mbox{\hyperlink{class_bio_imager_1_1_light_source_aff115fda488aa159505d867267b4bbe6}{00674}}         \textcolor{keyword}{public} \textcolor{keywordtype}{double} \mbox{\hyperlink{class_bio_imager_1_1_light_source_aff115fda488aa159505d867267b4bbe6}{GetPosition}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00675}00675         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00676}00676             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00677}00677             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00678}00678                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{type}} == \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}}.HXP)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00679}00679                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00680}00680                     \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00681}00681                         (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetHXP, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00682}00682                     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{short})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00683}00683                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00684}00684                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{type}} == \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}}.RL)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00685}00685                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00686}00686                     \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00687}00687                         (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetRLHalogen, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00688}00688                     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{short})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00689}00689                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00690}00690                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{type}} == \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}}.TL)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00691}00691                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00692}00692                     \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00693}00693                         (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetTLHalogen, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00694}00694                     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{short})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00695}00695                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00696}00696             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00697}00697             \textcolor{keywordflow}{return} \mbox{\hyperlink{class_bio_imager_1_1_light_source_a16e29b57c79fbfbd6a40b5466a1395b0}{position}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00698}00698         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00703}\mbox{\hyperlink{class_bio_imager_1_1_light_source_a8cb127e9b9cd47549cf0f7ab372be083}{00703}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_light_source_a8cb127e9b9cd47549cf0f7ab372be083}{SetPosition}}(\textcolor{keywordtype}{double} f)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00704}00704         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00705}00705             \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00706}00706                 \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.LightSource.SetPosition("{}} + f + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00707}00707             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00708}00708             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00709}00709                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{type}} == \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}}.HXP)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00710}00710                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00711}00711                     \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00712}00712                         \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetHXP, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ f \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00713}00713                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00714}00714                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{type}} == \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}}.RL)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00715}00715                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00716}00716                     \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00717}00717                         \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetRLHalogen, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ f \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00718}00718                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00719}00719                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_light_source_a1f4fd4c7f7aa8c8b53a57b76ee55b19c}{type}} == \mbox{\hyperlink{class_bio_imager_1_1_light_source_a2ac44012271af1ea9607a0328cb1cc5c}{Type}}.TL)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00720}00720                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00721}00721                     \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00722}00722                         \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetTLHalogen, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ f \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00723}00723                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00724}00724             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00725}00725         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00726}\mbox{\hyperlink{class_bio_imager_1_1_light_source_a46aa11a95c68ce8342d67cd18da512e6}{00726}}         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{string} \mbox{\hyperlink{class_bio_imager_1_1_light_source_a46aa11a95c68ce8342d67cd18da512e6}{ToString}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00727}00727         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00728}00728             \textcolor{keywordflow}{return} name;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00729}00729         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00730}00730     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00731}00731     \textcolor{comment}{/* The class is a wrapper for the filter wheel. It has two methods, one to get the current position}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00732}00732 \textcolor{comment}{    of the filter wheel and one to set the position of the filter wheel */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00733}\mbox{\hyperlink{class_bio_imager_1_1_filter_wheel}{00733}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_filter_wheel}{FilterWheel}}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00734}00734     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00735}00735         \textcolor{keyword}{static} \textcolor{keywordtype}{int} position;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00736}\mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_a68bcd60821010ce3c47c5d266ed53469}{00736}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_a68bcd60821010ce3c47c5d266ed53469}{FilterWheel}}() \{ \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00737}\mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_af8d7c217fad3fb717544a858ac804088}{00737}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_af8d7c217fad3fb717544a858ac804088}{FilterWheel}}(\textcolor{keywordtype}{object} o) }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00738}00738         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00739}00739         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00743}\mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_a75e225a262532116387d59ffbb34719a}{00743}}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_a75e225a262532116387d59ffbb34719a}{GetPosition}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00744}00744         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00745}00745             \textcolor{keywordflow}{if}(Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00746}00746             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00747}00747                 \mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{BioImager.MicroscopeConsole.Command}} com = BioImager.MicroscopeConsole.RunCommand}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00748}00748                     (\textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.GetRLShutter, \textcolor{keyword}{null}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00749}00749                 \textcolor{keywordflow}{return} (\textcolor{keywordtype}{int})com.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_a7690fbfe1846ecc82bd2a3e8f37a88f0}{doubles}}[0];}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00750}00750             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00751}00751             \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00752}00752             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00753}00753                 \textcolor{keywordtype}{int} pos;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00754}00754                 Microscope.pMicroscope.GetFilterWheelPosition(out pos);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00755}00755                 \textcolor{keywordflow}{return} pos;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00756}00756             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00757}00757             \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00758}00758         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00759}00759         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00764}\mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_a865d6f72bc2cb547d8899416c0c94f32}{00764}}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_filter_wheel_a865d6f72bc2cb547d8899416c0c94f32}{SetPosition}}(\textcolor{keywordtype}{int} i)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00765}00765         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00766}00766             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00767}00767             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00768}00768                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00769}00769                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetFilterWheel, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ i \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00770}00770             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00771}00771             \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00772}00772             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00773}00773                 \textcolor{keywordtype}{int} pos;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00774}00774                 Microscope.pMicroscope.SetFilterWheelPosition(i);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00775}00775                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ad4b4bf0d734efb1e7bef087c71ece77c}{recordMicroscope}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00776}00776                     \mbox{\hyperlink{class_bio_imager_1_1_recorder}{Recorder}}.\mbox{\hyperlink{class_bio_imager_1_1_recorder_ae5e3c30e43f2d85384339174b6c7c279}{AddLine}}(\textcolor{stringliteral}{"{}Microscope.FilterWheel.SetPosition("{}} + i + \textcolor{stringliteral}{"{});"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00777}00777             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00778}00778         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00779}00779     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00780}00780 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00781}00781     \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{class }Microscope}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00782}00782     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00783}00783         \textcolor{comment}{/* Defining an enum. */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00784}00784         \textcolor{keyword}{public} \textcolor{keyword}{enum} Actions}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00785}00785         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00786}00786             StageUp,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00787}00787             StageRight,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00788}00788             StageDown,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00789}00789             StageLeft,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00790}00790             StageFieldUp,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00791}00791             StageFieldRight,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00792}00792             StageFieldDown,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00793}00793             StageFieldLeft,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00794}00794             FocusUp,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00795}00795             FocusDown,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00796}00796             TL,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00797}00797             RL,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00798}00798             \mbox{\hyperlink{namespace_take_image}{TakeImage}},}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00799}00799             TakeImageStack,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00800}00800             Acquisition,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00801}00801             Locate,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00802}00802         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00803}00803         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} redraw = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00804}00804         \textcolor{keyword}{public} \textcolor{keyword}{static} Focus Focus = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00805}00805         \textcolor{keyword}{public} \textcolor{keyword}{static} Stage Stage = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00806}00806         \textcolor{keyword}{public} \textcolor{keyword}{static} Objectives Objectives = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00807}00807         \textcolor{keyword}{public} \textcolor{keyword}{static} TLShutter TLShutter = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00808}00808         \textcolor{keyword}{public} \textcolor{keyword}{static} RLShutter RLShutter = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00809}00809         \textcolor{keyword}{public} \textcolor{keyword}{static} HXPShutter HXPShutter = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00810}00810         \textcolor{keyword}{public} \textcolor{keyword}{static} LightSource TLHalogen = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00811}00811         \textcolor{keyword}{public} \textcolor{keyword}{static} LightSource RLHalogen = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00812}00812         \textcolor{keyword}{public} \textcolor{keyword}{static} LightSource HXP = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00813}00813         \textcolor{keyword}{public} \textcolor{keyword}{static} FilterWheel TLFilterWheel = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00814}00814         \textcolor{keyword}{public} \textcolor{keyword}{static} FilterWheel RLFilterWheel = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00815}00815         \textcolor{keyword}{public} \textcolor{keyword}{static} FilterWheel FilterWheel = \textcolor{keyword}{new} FilterWheel();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00816}00816         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} UpperLimit, LowerLimit, fInterVal;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00817}00817         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{object} CmdSetMode = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00818}00818         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} initialized = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00819}00819         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} ArrowKeysEnabled = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00820}00820         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} defaultPos = \textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}(30000, 30000, 23900);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00821}00821         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{object} root = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00822}00822         \textcolor{keyword}{public} \textcolor{keyword}{static} StringBuilder dllVersion = \textcolor{keyword}{new} StringBuilder();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00823}00823         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{namespacemicroscope_1_1__wrappers_1_1asdk_a71477311aecfd5270ec14dfcfa0f8b7b}{SDK}} sdk;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00824}00824         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} sessionID = -\/1;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00825}00825         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} userRx = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00826}00826         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} viewSize;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00827}00827         \textcolor{keyword}{public} \textcolor{keyword}{static} PMicroscope pMicroscope = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00828}00828         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00829}00829         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} ImageCount = 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00830}00830         \textcolor{comment}{/* A property that returns the value of the GetObjective method. */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00831}00831         \textcolor{keyword}{public} \textcolor{keyword}{static} Objectives.Objective Objective}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00832}00832         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00833}00833             \textcolor{keyword}{get}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00834}00834             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00835}00835                 \textcolor{keywordflow}{return} Objectives.GetObjective();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00836}00836             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00837}00837         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00838}00838         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00842}00842         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} Initialize()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00843}00843         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00844}00844             \textcolor{keywordflow}{if} (initialized)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00845}00845                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00846}00846             \textcolor{keywordtype}{int} err;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00847}00847             folder = Properties.Settings.Default.ImagingPath;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00848}00848             \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00849}00849             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00850}00850                 pMicroscope = \textcolor{keyword}{new} PMicroscope();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00851}00851                 pMicroscope.Initialize();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00852}00852                 \textcolor{keywordtype}{bool} b = pMicroscope.SetPosition(\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}(100, 100, 100));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00853}00853                 \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00854}00854                 \textcolor{keywordtype}{bool} res = pMicroscope.GetPosition3D(out p, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00855}00855                 \textcolor{keywordtype}{bool} bb = pMicroscope.TakeImage(Application.StartupPath + \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)Image"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00856}00856                 Objectives = \textcolor{keyword}{new} Objectives(6);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00857}00857                 Stage = \textcolor{keyword}{new} Stage();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00858}00858                 Focus = \textcolor{keyword}{new} Focus();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00859}00859             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00860}00860             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00861}00861             \textcolor{keywordflow}{if} (Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00862}00862             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00863}00863                 \textcolor{comment}{//First we determine which MMConfig file we are using. There is currently no way of doing this programmatically. So we will ask the user.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00864}00864                 \textcolor{keywordflow}{if} (Properties.Settings.Default.MMConfig == \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00865}00865                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00866}00866                     OpenFileDialog fl = \textcolor{keyword}{new} OpenFileDialog();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00867}00867                     fl.Filter = \textcolor{stringliteral}{"{}Config Files (*.cfg)|*.cfg"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00868}00868                     fl.InitialDirectory = Properties.Settings.Default.AppPath;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00869}00869                     MessageBox.Show(\textcolor{stringliteral}{"{}Micro-\/Manager current configuration file not set please select the current configuration."{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00870}00870                     fl.Title = \textcolor{stringliteral}{"{}Set Current Config File (Shown in MicroManager GUI))"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00871}00871                     \textcolor{keywordflow}{if} (fl.ShowDialog() != DialogResult.OK)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00872}00872                         Application.Exit();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00873}00873                     Properties.Settings.Default.MMConfig = fl.FileName;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00874}00874                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00875}00875                 PycroManager.Initialize(Properties.Settings.Default.MMConfig);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00876}00876                 Objectives = \textcolor{keyword}{new} Objectives(7);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00877}00877                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < PycroManager.Objectives.List.Count; i++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00878}00878                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00879}00879                     Objectives.List[PycroManager.Objectives.List[i].Index].Name = PycroManager.Objectives.List[i].Name;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00880}00880                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00881}00881                 Stage = \textcolor{keyword}{new} Stage();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00882}00882                 Focus = \textcolor{keyword}{new} Focus();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00883}00883             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00884}00884             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00885}00885             \textcolor{keywordflow}{if} (Properties.Settings.Default.AppPath == \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00886}00886             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00887}00887                 OpenFileDialog fl = \textcolor{keyword}{new} OpenFileDialog();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00888}00888                 MessageBox.Show(\textcolor{stringliteral}{"{}Imaging application path is not set. Please set executable location."{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00889}00889                 fl.Title = \textcolor{stringliteral}{"{}Set imaging application location."{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00890}00890                 \textcolor{keywordflow}{if} (fl.ShowDialog() != DialogResult.OK)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00891}00891                     Application.Exit();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00892}00892                 Properties.Settings.Default.AppPath = fl.FileName;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00893}00893                 fl.Dispose();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00894}00894             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00895}00895             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00896}00896             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath == \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00897}00897             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00898}00898                 OpenFileDialog fl = \textcolor{keyword}{new} OpenFileDialog();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00899}00899                 MessageBox.Show(\textcolor{stringliteral}{"{}Imaging library path is not set. Please set imaging library."{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00900}00900                 fl.Title = \textcolor{stringliteral}{"{}Set imaging library location."{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00901}00901                 \textcolor{keywordflow}{if} (fl.ShowDialog() != DialogResult.OK)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00902}00902                     Application.Exit();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00903}00903                 Properties.Settings.Default.LibPath = fl.FileName;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00904}00904                 fl.Dispose();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00905}00905             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00906}00906             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00907}00907             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00908}00908                 TLFilterWheel = \textcolor{keyword}{new} FilterWheel();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00909}00909                 RLFilterWheel = \textcolor{keyword}{new} FilterWheel();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00910}00910                 Stage = \textcolor{keyword}{new} Stage();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00911}00911                 Focus = \textcolor{keyword}{new} Focus();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00912}00912                 Objectives = \textcolor{keyword}{new} Objectives(7);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00913}00913                 TLShutter = \textcolor{keyword}{new} TLShutter();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00914}00914                 RLShutter = \textcolor{keyword}{new} RLShutter();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00915}00915                 HXPShutter = \textcolor{keyword}{new} HXPShutter();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00916}00916                 TLHalogen = \textcolor{keyword}{new} LightSource();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00917}00917                 RLHalogen = \textcolor{keyword}{new} LightSource();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00918}00918                 HXP = \textcolor{keyword}{new} LightSource();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00919}00919                 \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}.SetLimits(Stage.minX, Stage.maxX, Stage.minY, Stage.maxY, Focus.lowerLimit, Focus.upperLimit);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00920}00920                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}.SetLimits(Stage.minX, Stage.maxX, Stage.minY, Stage.maxY);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00921}00921                 \textcolor{comment}{//We calibrate the stage and focus, so that images are taken always with same calibration}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00922}00922                 CalibrateXYZ(0);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00923}00923             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00924}00924             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}Prio"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00925}00925             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00926}00926                 sdk = \textcolor{keyword}{new} \mbox{\hyperlink{namespacemicroscope_1_1__wrappers_1_1asdk_a71477311aecfd5270ec14dfcfa0f8b7b}{SDK}}();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00927}00927                 \textcolor{comment}{/* get the version number of the dll */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00928}00928                 \textcolor{keywordflow}{if} ((err = sdk.GetVersion(dllVersion)) != Prior.PRIOR\_OK)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00929}00929                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00930}00930                     MessageBox.Show(\textcolor{stringliteral}{"{}Error getting Prior SDK version ("{}} + err.ToString() + \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00931}00931                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00932}00932                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00933}00933 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00934}00934                 \textcolor{comment}{/* SDK must be initialised before any real use}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00935}00935 \textcolor{comment}{                 */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00936}00936                 \textcolor{keywordflow}{if} ((err = sdk.Initialise()) != Prior.PRIOR\_OK)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00937}00937                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00938}00938                     MessageBox.Show(\textcolor{stringliteral}{"{}Error initialising Prior SDK ("{}} + err.ToString() + \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00939}00939                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00940}00940                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00941}00941 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00942}00942                 \textcolor{comment}{/* create a session in the DLL, this gives us one controller and currently an ODS and SL160 robot loader. }}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00943}00943 \textcolor{comment}{                 * Multiple connections allow control of multiple stage/loaders but is outside the brief for this demo}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00944}00944 \textcolor{comment}{                 */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00945}00945                 \textcolor{keywordflow}{if} ((sessionID = sdk.OpenSession()) < 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00946}00946                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00947}00947                     MessageBox.Show(\textcolor{stringliteral}{"{}Error ("{}} + sessionID.ToString() + \textcolor{stringliteral}{"{}) Creating session in SDK "{}} + dllVersion);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00948}00948                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00949}00949                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00950}00950                 \textcolor{keywordtype}{int} \mbox{\hyperlink{namespacemicroscope_1_1__wrappers_1_1mirao52e_a5aef375780366e0637a02ee75c6ad8a2}{open}} = 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00951}00951                 \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00952}00952                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00953}00953                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} port = 0; port < 10; port++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00954}00954                     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00955}00955                         \textcolor{comment}{//specify path name or PriorSDK.log is written to working directory}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00956}00956                         \textcolor{comment}{//priorSDK.Cmd(sessionID, "{}dll.log.on"{},  ref userRx);}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00957}00957                         \textcolor{comment}{/* my controller identifies on COM1, yours will probably be different.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00958}00958 \textcolor{comment}{                         */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00959}00959                         \textcolor{comment}{/* try to connect to the ps3 */}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00960}00960                         \mbox{\hyperlink{namespacemicroscope_1_1__wrappers_1_1mirao52e_a5aef375780366e0637a02ee75c6ad8a2}{open}} = sdk.Cmd(sessionID, \textcolor{stringliteral}{"{}controller.connect "{}} + port.ToString(), ref userRx, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00961}00961                     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00962}00962                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00963}00963                 \textcolor{keywordflow}{catch} (Exception)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00964}00964                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00965}00965 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00966}00966                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00967}00967                 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00968}00968                 \textcolor{keywordflow}{if} (open != Prior.PRIOR\_OK)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00969}00969                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00970}00970                     MessageBox.Show(\textcolor{stringliteral}{"{}Error ("{}} + \mbox{\hyperlink{namespacemicroscope_1_1__wrappers_1_1mirao52e_a5aef375780366e0637a02ee75c6ad8a2}{open}}.ToString() + \textcolor{stringliteral}{"{})  connecting to stage controller "{}}, \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00971}00971                         MessageBoxButtons.OK, MessageBoxIcon.Error);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00972}00972                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00973}00973                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00974}00974                 err = sdk.Cmd(sessionID, \textcolor{stringliteral}{"{}controller.stage.hostdirection.set 1 1"{}}, ref userRx);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00975}00975                 Objectives = \textcolor{keyword}{new} Objectives(sdk.GetNosePiecePositions());}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00976}00976                 Stage = \textcolor{keyword}{new} Stage();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00977}00977                 Focus = \textcolor{keyword}{new} Focus();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00978}00978             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00979}00979 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00980}00980             \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}} rec = GetObjectiveViewRectangle();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00981}00981             viewSize = \textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}}(rec.W, rec.H);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00982}00982             Watcher();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00983}00983             initialized = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00984}00984         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00989}00989         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} CalibrateXYZ(\textcolor{keywordtype}{int} calibMode)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00990}00990         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00991}00991             \textcolor{keywordflow}{if} (Properties.Settings.Default.LibPath.Contains(\textcolor{stringliteral}{"{}MTB"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00992}00992             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00993}00993                 \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.RunCommand(}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00994}00994                     \textcolor{keyword}{new} \mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}(\mbox{\hyperlink{namespace_bio_imager}{BioImager}}.\mbox{\hyperlink{class_bio_imager_1_1_microscope_console}{MicroscopeConsole}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command}{Command}}.\mbox{\hyperlink{struct_bio_imager_1_1_microscope_console_1_1_command_ac502d15833f931c44904db92be35f03f}{Type}}.SetCalibration, \textcolor{keyword}{new} \textcolor{keywordtype}{double}[] \{ calibMode \}));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00995}00995                 \textcolor{comment}{//We check to see if focus \& stage are correctly calibrated on lower limit and perform calibration if necessary}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00996}00996                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} cur = Stage.GetPosition(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00997}00997                 \textcolor{keywordtype}{double} z = Focus.GetFocus();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00998}00998                 \textcolor{comment}{//After calibration we return to the position before calibration.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l00999}00999                 SetPosition(cur);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01000}01000                 Focus.SetFocus(z);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01001}01001             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01002}01002         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01003}01003 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01004}01004         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01009}01009         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} GetPosition()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01010}01010         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01011}01011             \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} p = Stage.GetPosition(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01012}01012             \textcolor{keywordtype}{double} f = Focus.GetFocus();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01013}01013             \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}(p.X, p.Y, f);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01014}01014         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01015}01015 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01016}01016        }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01020}01020         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetPosition(\mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} p)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01021}01021         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01022}01022             Stage.SetPosition(p.X,p.Y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01023}01023             Focus.SetFocus(p.Z);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01024}01024             Microscope.redraw = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01025}01025         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01026}01026 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01030}01030         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetPosition(\mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} p)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01031}01031         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01032}01032             Stage.SetPosition(p.X, p.Y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01033}01033             Microscope.redraw = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01034}01034         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01036}01036         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OpenRL()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01037}01037         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01038}01038             \textcolor{comment}{//If shutter is closed we open it.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01039}01039             \textcolor{keywordflow}{if} (RLShutter.GetPosition() == 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01040}01040                 RLShutter.SetPosition(1);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01041}01041         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01042}01042 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01043}01043         }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01045}01045         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} OpenTL()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01046}01046         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01047}01047             \textcolor{comment}{//If shutter is closed we open it.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01048}01048             \textcolor{keywordflow}{if} (TLShutter.GetPosition() == 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01049}01049                 TLShutter.SetPosition(1);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01050}01050         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01051}01051 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01053}01053         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} CloseRL()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01054}01054         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01055}01055             \textcolor{comment}{//If shutter is open then we close it.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01056}01056             \textcolor{keywordflow}{if} (RLShutter.GetPosition() == 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01057}01057                 RLShutter.SetPosition(1);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01058}01058         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01059}01059 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01061}01061         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} CloseTL()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01062}01062         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01063}01063             \textcolor{comment}{//If shutter is open then we close it.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01064}01064             \textcolor{keywordflow}{if} (TLShutter.GetPosition() == 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01065}01065                 TLShutter.SetPosition(1);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01066}01066         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01067}01067 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01071}01071         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetTL(uint tl)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01072}01072         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01073}01073             TLShutter.SetPosition((\textcolor{keywordtype}{short})tl);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01074}01074         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01075}01075 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01079}01079         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetRL(uint tr)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01080}01080         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01081}01081             RLShutter.SetPosition((\textcolor{keywordtype}{short})tr);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01082}01082         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01083}01083 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01087}01087         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} GetTL()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01088}01088         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01089}01089             \textcolor{keywordflow}{return} TLShutter.GetPosition();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01090}01090         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01091}01091 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01095}01095         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} GetRL()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01096}01096         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01097}01097             \textcolor{keywordflow}{return} RLShutter.GetPosition();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01098}01098         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01104}01104         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{int} GetShutterPosition(\textcolor{keywordtype}{string} shutter)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01105}01105         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01106}01106             \textcolor{keywordflow}{return} PycroManager.Shutters.GetPosition(shutter);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01107}01107         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01113}01113         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} SetShutterPosition(\textcolor{keywordtype}{string} shutter, \textcolor{keywordtype}{int} state)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01114}01114         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01115}01115             \textcolor{keywordflow}{return} PycroManager.Shutters.SetPosition(shutter, state);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01116}01116         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01120}01120         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveUp(\textcolor{keywordtype}{double} d)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01121}01121         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01122}01122             Stage.MoveUp(d);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01123}01123         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01124}01124 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01128}01128         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveRight(\textcolor{keywordtype}{double} d)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01129}01129         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01130}01130             Stage.MoveRight(d);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01131}01131         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01132}01132 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01136}01136         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveDown(\textcolor{keywordtype}{double} d)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01137}01137         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01138}01138             Stage.MoveDown(d);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01139}01139         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01140}01140 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01144}01144         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveLeft(\textcolor{keywordtype}{double} d)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01145}01145         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01146}01146             Stage.MoveLeft(d);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01147}01147         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01149}01149         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveFieldUp()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01150}01150         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01151}01151             Stage.MoveUp(viewSize.Y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01152}01152         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01154}01154         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveFieldRight()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01155}01155         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01156}01156             Stage.MoveRight(viewSize.X);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01157}01157         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01159}01159         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveFieldDown()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01160}01160         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01161}01161             Stage.MoveDown(viewSize.Y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01162}01162         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01164}01164         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} MoveFieldLeft()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01165}01165         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01166}01166             Stage.MoveLeft(viewSize.X);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01167}01167         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01172}01172         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetFocus(\textcolor{keywordtype}{double} d)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01173}01173         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01174}01174             Focus.SetFocus(d);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01175}01175         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01179}01179         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{double} GetFocus()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01180}01180         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01181}01181             \textcolor{keywordflow}{return} Focus.GetFocus();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01182}01182         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01183}01183         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{string} folder = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01190}01190         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} GetFolder()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01191}01191         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01192}01192             \textcolor{keywordtype}{object} o = Recordings.GetProperty(Automation.Action.ValueType.ValuePattern, \textcolor{stringliteral}{"{}GetFolder"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01193}01193             \textcolor{keywordtype}{string} s = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01194}01194             \textcolor{keywordflow}{if} (o != \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01195}01195                 s = o.ToString();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01196}01196             \textcolor{keywordflow}{if} (s == \textcolor{keyword}{null} \&\& folder == \textcolor{stringliteral}{"{}"{}} \&\& Properties.Settings.Default.ImagingPath == \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01197}01197             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01198}01198                 FolderBrowserDialog fs = \textcolor{keyword}{new} FolderBrowserDialog();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01199}01199                 fs.Description = \textcolor{stringliteral}{"{}Select Imaging Folder"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01200}01200                 \textcolor{keywordflow}{if} (fs.ShowDialog() != DialogResult.OK)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01201}01201                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01202}01202                     fs.Dispose();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01203}01203                     \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01204}01204                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01205}01205                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01206}01206                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01207}01207                     fs.Dispose();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01208}01208                     Properties.Settings.Default.ImagingPath = fs.SelectedPath;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01209}01209                     \textcolor{keywordflow}{return} fs.SelectedPath;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01210}01210                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01211}01211             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01212}01212             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01213}01213             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01214}01214                 folder = Properties.Settings.Default.ImagingPath;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01215}01215                 \textcolor{keywordflow}{return} folder;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01216}01216             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01217}01217         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01222}01222         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} SetFolder(\textcolor{keywordtype}{string} fol)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01223}01223         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01224}01224             \textcolor{keywordflow}{if} (!Directory.Exists(fol))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01225}01225                 Directory.CreateDirectory(fol);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01226}01226             \textcolor{keywordflow}{if}(Automation.Properties.ContainsKey(\textcolor{stringliteral}{"{}SetFolder"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01227}01227                 Automation.SetProperty(\textcolor{stringliteral}{"{}SetFolder"{}},fol);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01228}01228             folder = fol;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01229}01229             Properties.Settings.Default.ImagingPath = folder;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01230}01230             Properties.Settings.Default.Save();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01231}01231         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01232}01232 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01236}01236         \textcolor{keyword}{public} \textcolor{keyword}{static} BioImage \mbox{\hyperlink{namespace_take_image}{TakeImage}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01237}01237         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01238}01238             \textcolor{keywordflow}{return} \mbox{\hyperlink{namespace_take_image}{TakeImage}}(\textcolor{keyword}{true},\textcolor{keyword}{true},\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01239}01239         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01240}01240 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01241}01241         \textcolor{keyword}{public} \textcolor{keyword}{static} BioImage \mbox{\hyperlink{namespace_take_image}{TakeImage}}(\textcolor{keywordtype}{bool} save, \textcolor{keywordtype}{bool} addToImages, \textcolor{keywordtype}{bool} newTab)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01242}01242         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01243}01243             \textcolor{keywordflow}{if} (Properties.Settings.Default.SimulateCamera \&\& !Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01244}01244             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01245}01245                 folder = GetFolder();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01246}01246                 BioImage b = MicroscopeSetup.simImage.Copy();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01247}01247                 \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} p = GetPosition();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01248}01248                 b.StageSizeX = p.X;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01249}01249                 b.StageSizeY = p.Y;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01250}01250                 b.StageSizeZ = p.Z;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01251}01251                 \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}} view = Microscope.GetViewRectangle(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01252}01252                 b.Resolutions[0] = \textcolor{keyword}{new} Resolution(b.SizeX, b.SizeY, b.Buffers[0].PixelFormat,view.W / b.SizeX, view.H / b.SizeY, b.PhysicalSizeZ,p.X,p.Y,p.Z);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01253}01253                 b.Volume.Location = p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01254}01254                 b.Volume.Width = view.W;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01255}01255                 b.Volume.Height = view.H;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01256}01256                 \textcolor{keywordtype}{string} \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01257}01257                 \textcolor{keywordflow}{if} (folder == \textcolor{stringliteral}{"{}"{}} || folder == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01258}01258                     \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}} = Properties.Settings.Default.ImageName + (ImageCount++) + \textcolor{stringliteral}{"{}.ome.tif"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01259}01259                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01260}01260                     \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}} = folder + \textcolor{stringliteral}{"{}/"{}} + Properties.Settings.Default.ImageName + (ImageCount++) + \textcolor{stringliteral}{"{}.ome.tif"{}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01261}01261                 b.ID = \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01262}01262                 b.file = \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01263}01263                 \textcolor{keywordflow}{if}(addToImages)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01264}01264                 Images.AddImage(b,newTab);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01265}01265                 \textcolor{keywordflow}{if}(save)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01266}01266                 BioImage.SaveOME(file, b.ID);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01267}01267                 \textcolor{keywordflow}{return} b;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01268}01268             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01269}01269             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01270}01270             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01271}01271                 folder = GetFolder();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01272}01272                 \textcolor{keywordtype}{string} \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01273}01273                 \textcolor{keywordflow}{if} (folder == \textcolor{stringliteral}{"{}"{}} || folder == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01274}01274                     \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}} = Properties.Settings.Default.ImageName + (ImageCount++).ToString();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01275}01275                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01276}01276                     \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}} = folder + \textcolor{stringliteral}{"{}/"{}} + Properties.Settings.Default.ImageName + (ImageCount++);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01277}01277                 pMicroscope.TakeImage(file);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01278}01278                 \textcolor{keywordtype}{byte}[] bts = File.ReadAllBytes(file);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01279}01279                 \textcolor{keywordtype}{int} w, h;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01280}01280                 \mbox{\hyperlink{_d_bitmap_8cs_aed7d13385179f93a5d82df2220c78042}{PixelFormat}} px;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01281}01281                 Enum.TryParse<\mbox{\hyperlink{_d_bitmap_8cs_aed7d13385179f93a5d82df2220c78042}{PixelFormat}}>(Properties.Settings.Default.PCameraFormat, out px);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01282}01282                 pMicroscope.GetSize(out w, out h);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01283}01283                 \mbox{\hyperlink{_abstract_flood_filler_8cs_a5ed305bd2d2d30db525508b3fdbba701}{Bitmap}} bf = \textcolor{keyword}{new} \mbox{\hyperlink{_abstract_flood_filler_8cs_a5ed305bd2d2d30db525508b3fdbba701}{Bitmap}}(file, w, h, px, bts, \textcolor{keyword}{new} ZCT(0, 0, 0), 0);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01284}01284                 Statistics.CalcStatistics(bf);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01285}01285                 BioImage bm = \textcolor{keyword}{new} BioImage(file + \textcolor{stringliteral}{"{}.ome.tif"{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01286}01286                 bm.Buffers.Add(bf);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01287}01287                 \textcolor{comment}{//Set the physical size based on objective view}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01288}01288                 \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}} rec = GetViewRectangle(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01289}01289                 \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} p = Microscope.GetPosition();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01290}01290                 Resolution res = \textcolor{keyword}{new} Resolution(w,h,px,rec.W / bm.SizeX,rec.H / bm.SizeY,1, p.X,p.Y,p.Z);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01291}01291                 bm.Volume.Location = p;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01292}01292                 bm.Volume.Width = rec.W;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01293}01293                 bm.Volume.Height = rec.H;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01294}01294                 bm.bitsPerPixel = bf.BitsPerPixel;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01295}01295                 bm.UpdateCoords(1, 1, 1);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01296}01296                 bm.Resolutions.Add(res);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01297}01297                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} c = 0; c < bf.RGBChannelsCount; c++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01298}01298                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01299}01299                     bm.Channels.Add(\textcolor{keyword}{new} Channel(c, bf.BitsPerPixel, bf.RGBChannelsCount));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01300}01300                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01301}01301                 \textcolor{comment}{//We wait for threshold image statistics calculation}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01302}01302                 \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01303}01303                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01304}01304                     Thread.Sleep(50);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01305}01305                 \} \textcolor{keywordflow}{while} (bm.Buffers[bm.Buffers.Count -\/ 1].Stats == \textcolor{keyword}{null});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01306}01306                 Statistics.ClearCalcBuffer();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01307}01307                 BioImage.AutoThreshold(bm, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01308}01308                 \textcolor{keywordflow}{if} (!imagingStack)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01309}01309                 \{   }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01310}01310                     \textcolor{keywordflow}{if}(addToImages)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01311}01311                     Images.AddImage(bm,newTab);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01312}01312                     \textcolor{keywordflow}{if}(save)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01313}01313                     BioImage.SaveAsync(file + \textcolor{stringliteral}{"{}.ome.tif"{}}, bm.ID,0,\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01314}01314                     \textcolor{keywordflow}{if} (bm.bitsPerPixel > 8)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01315}01315                         bm.StackThreshold(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01316}01316                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01317}01317                         bm.StackThreshold(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01318}01318                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01319}01319                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01320}01320                     bi.Buffers.Add(bm.Buffers[0]);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01321}01321                 \textcolor{comment}{//We delete the temporary file created by camera.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01322}01322                 File.Delete(file);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01323}01323                 currentImage = bm;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01324}01324                 \textcolor{keywordflow}{return} bi;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01325}01325             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01326}01326             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Properties.Settings.Default.PycroManager)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01327}01327             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01328}01328                 folder = GetFolder();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01329}01329                 \textcolor{keywordtype}{string} \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01330}01330                 \textcolor{keywordflow}{if} (folder == \textcolor{stringliteral}{"{}"{}} || folder == \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01331}01331                     \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}} = Properties.Settings.Default.ImageName + (ImageCount++).ToString();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01332}01332                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01333}01333                     \mbox{\hyperlink{namespacemicroscope_1_1takeimage_aa8afcfcaed2ee35d231d2158dee51c38}{file}} = folder + \textcolor{stringliteral}{"{}/"{}} + Properties.Settings.Default.ImageName + (ImageCount++);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01334}01334                 BioImage bm = PycroManager.TakeImage(file);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01335}01335 }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01336}01336                 \textcolor{keywordflow}{if} (!imagingStack)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01337}01337                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01338}01338                     \textcolor{keywordflow}{if} (addToImages)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01339}01339                         Images.AddImage(bm, newTab);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01340}01340                     \textcolor{keywordflow}{if} (save)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01341}01341                         BioImage.SaveAsync(file + \textcolor{stringliteral}{"{}.ome.tif"{}}, bm.ID,0,\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01342}01342                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01343}01343                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01344}01344                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01345}01345                     bi.Buffers.AddRange(bm.Buffers);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01346}01346                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01347}01347                 currentImage = bm;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01348}01348                 \textcolor{keywordflow}{return} bi;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01349}01349             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01350}01350             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01351}01351             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01352}01352                 \textcolor{keywordflow}{if} (Function.Functions.ContainsKey(\textcolor{stringliteral}{"{}TakeImage"{}}))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01353}01353                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01354}01354                     App.imager.PerformFunction(Function.Functions[\textcolor{stringliteral}{"{}TakeImage"{}}]);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01355}01355                     \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01356}01356                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01357}01357                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01358}01358                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01359}01359                     MessageBox.Show(\textcolor{stringliteral}{"{}Go to Microscope Setup to set 'TakeImage' function eg. a Button shortcut or GUI recording. Or set camera simulation on \& set Camera image."{}}, \textcolor{stringliteral}{"{}Function 'TakeImage' not defined."{}});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01360}01360                     \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01361}01361                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01362}01362             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01363}01363         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01367}01367         \textcolor{keyword}{public} \textcolor{keyword}{static} BioImage TakeImageStack()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01368}01368         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01369}01369             \textcolor{keywordflow}{return} TakeImageStack(UpperLimit, LowerLimit, fInterVal);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01370}01370         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01371}01371         \textcolor{keyword}{static} FileSystemWatcher watcher = \textcolor{keyword}{new} FileSystemWatcher();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01374}01374         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} Watcher()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01375}01375         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01376}01376             \textcolor{keywordtype}{string} s = GetFolder();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01377}01377             watcher.Created += fileSystemWatcher1\_Created;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01378}01378             watcher.Path = s;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01379}01379             watcher.BeginInit();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01380}01380             watcher.EnableRaisingEvents = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01381}01381             watcher.EndInit();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01382}01382         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01383}01383         \textcolor{keyword}{static} BioImage bi;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01384}01384         \textcolor{keyword}{static} BioImage currentImage;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01385}01385         \textcolor{keyword}{static} \textcolor{keywordtype}{bool} imagingStack = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01386}01386         \textcolor{keyword}{static} List<BioImage> images = \textcolor{keyword}{new} List<BioImage>();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01387}01387         \textcolor{keyword}{static} Dictionary<int,string> locked = \textcolor{keyword}{new} Dictionary<int, string>();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01389}01389         \textcolor{keyword}{static} \textcolor{keywordtype}{void} LockWait()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01390}01390         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01391}01391             \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01392}01392             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01393}01393                 Thread.Sleep(50);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01394}01394                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < locked.Count; i++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01395}01395                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01396}01396                     \textcolor{comment}{//We wait till the new file is no longer written into.}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01397}01397                     \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01398}01398                     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01399}01399                         List<Process> pr = FileUtil.Locking(locked[i]);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01400}01400                         FileInfo fi = \textcolor{keyword}{new} FileInfo(locked[i]);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01401}01401                         \textcolor{keywordflow}{if} (pr.Count == 0 \&\& fi.Length > 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01402}01402                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01403}01403                         fi = \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01404}01404                     \} \textcolor{keywordflow}{while} (\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01405}01405                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01406}01406             \} \textcolor{keywordflow}{while} (imagingStack);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01407}01407         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01409}01409         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{void} WaitLocking()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01410}01410         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01411}01411             System.Threading.Thread t = \textcolor{keyword}{new} Thread(LockWait);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01412}01412             t.Start();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01413}01413         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01420}01420         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{void} fileSystemWatcher1\_Created(\textcolor{keywordtype}{object} sender, FileSystemEventArgs e)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01421}01421         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01422}01422             \textcolor{keywordflow}{if} (!Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01423}01423             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01424}01424                 \textcolor{comment}{//We will only open files with an extension}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01425}01425                 \textcolor{keywordflow}{if} (!Path.HasExtension(e.FullPath))}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01426}01426                     \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01427}01427                 locked.Add(ImageCount-\/1,e.FullPath);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01428}01428             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01429}01429         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01439}01439         \textcolor{keyword}{public} \textcolor{keyword}{static} BioImage TakeImageStack(\textcolor{keywordtype}{double} UpperLimit, \textcolor{keywordtype}{double} LowerLimit, \textcolor{keywordtype}{double} interval)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01440}01440         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01441}01441             imagingStack = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01442}01442             \textcolor{comment}{//We start the locking wait loop}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01443}01443             WaitLocking();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01444}01444             bi = \textcolor{keyword}{new} BioImage(Properties.Settings.Default.ImageName);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01445}01445             watcher.Path = GetFolder();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01446}01446             Focus.SetFocus(UpperLimit);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01447}01447             \textcolor{keywordtype}{double} d = UpperLimit -\/ LowerLimit;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01448}01448             \textcolor{keywordtype}{double} dd = d / interval;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01449}01449             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dd; i++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01450}01450             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01451}01451                 \mbox{\hyperlink{namespace_take_image}{TakeImage}}();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01452}01452                 \textcolor{comment}{//If this is the last image we don't need to move the focus. }}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01453}01453                 \textcolor{keywordflow}{if} (i < dd)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01454}01454                     Focus.SetFocus(Focus.GetFocus() -\/ fInterVal);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01455}01455                 Application.DoEvents();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01456}01456             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01457}01457             \textcolor{comment}{//If we are using the imaging application to take images we need to add them to the viewer as the filesystemwatcher}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01458}01458             \textcolor{comment}{//can't add them due to thread access violation}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01459}01459             \textcolor{keywordflow}{if} (!Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01460}01460             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01461}01461                 \textcolor{comment}{//First we wait till all the images are loaded}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01462}01462                 \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01463}01463                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01464}01464                     Thread.Sleep(100);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01465}01465                     Application.DoEvents();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01466}01466                 \} \textcolor{keywordflow}{while} (bi.Buffers.Count < (\textcolor{keywordtype}{int})dd);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01467}01467             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01468}01468             }
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01469}01469             bi.UpdateCoords(bi.Buffers.Count, 1, 1);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01470}01470             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} c = 0; c < bi.Buffers[0].RGBChannelsCount; c++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01471}01471             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01472}01472                 bi.Channels.Add(\textcolor{keyword}{new} Channel(c, bi.bitsPerPixel, bi.Buffers[c].RGBChannelsCount));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01473}01473             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01474}01474             \textcolor{comment}{//Set the physical size based on objective view}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01475}01475             \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}} rec = GetObjectiveViewRectangle();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01476}01476             bi.bitsPerPixel = bi.Buffers[0].BitsPerPixel;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01477}01477             bi.StageSizeX = rec.X;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01478}01478             bi.StageSizeY = rec.Y;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01479}01479             bi.StageSizeZ = UpperLimit;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01480}01480             bi.Resolutions.Add(\textcolor{keyword}{new} Resolution(bi.SizeX, bi.SizeY, bi.Buffers[0].PixelFormat,}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01481}01481                 rec.W / bi.SizeX, rec.H / bi.SizeY, (UpperLimit -\/ LowerLimit) / bi.SizeZ, rec.X,rec.Y,UpperLimit));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01482}01482             bi.Volume = \textcolor{keyword}{new} VolumeD(\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}(bi.StageSizeX, bi.StageSizeY, bi.StageSizeZ),\textcolor{keyword}{new} \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}}(bi.SizeX * bi.PhysicalSizeX, bi.SizeY * bi.PhysicalSizeY, bi.StageSizeZ * bi.PhysicalSizeZ));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01483}01483             BioImage.AutoThreshold(bi, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01484}01484             \textcolor{keywordflow}{if} (bi.bitsPerPixel > 8)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01485}01485                 bi.StackThreshold(\textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01486}01486             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01487}01487                 bi.StackThreshold(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01488}01488             Images.AddImage(bi,\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01489}01489             imagingStack = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01490}01490             currentImage = bi;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01491}01491             images.Clear();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01492}01492             App.viewer.AddImage(currentImage);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01493}01493             locked.Clear();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01494}01494             ImageCount = 0;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01495}01495             \textcolor{keywordflow}{return} bi;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01496}01496         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01501}01501         \textcolor{keyword}{public} \textcolor{keyword}{static} BioImage[] TakeTiles(\textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{bool} save = \textcolor{keyword}{true}, \textcolor{keywordtype}{bool} addToImages = \textcolor{keyword}{true}, \textcolor{keywordtype}{bool} newTab = \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01502}01502         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01503}01503             List<BioImage> ims = \textcolor{keyword}{new} List<BioImage>();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01504}01504             imagingStack = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01505}01505             \textcolor{keywordtype}{bool} leftright = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01506}01506             \textcolor{keywordflow}{if} (Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01507}01507             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01508}01508                 \mbox{\hyperlink{_microscope_8cs_aed0fa5b64e6b13858be8106e67c09bf0}{Point3D}} p = Microscope.GetPosition();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01509}01509                 \textcolor{comment}{//We ensure that the cached position is same as actual position}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01510}01510                 Microscope.SetPosition(p);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01511}01511             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01512}01512             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} y = 0; y < height; y++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01513}01513             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01514}01514                 \textcolor{keywordflow}{if} (y != 0)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01515}01515                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01516}01516                     Microscope.MoveFieldDown();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01517}01517                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01518}01518                 leftright = !leftright;}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01519}01519                 ims.Add(Microscope.TakeImage(save, addToImages, newTab));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01520}01520                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = 0; x < width -\/ 1; x++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01521}01521                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01522}01522                     \textcolor{keywordflow}{if} (leftright)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01523}01523                     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01524}01524                         Microscope.MoveFieldRight();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01525}01525                     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01526}01526                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01527}01527                     \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01528}01528                         Microscope.MoveFieldLeft();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01529}01529                     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01530}01530                     ims.Add(Microscope.TakeImage(save,addToImages,newTab));}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01531}01531                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01532}01532             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01533}01533             \textcolor{comment}{//If we are using the imaging application to take images we need to add them to the viewer as the filesystemwatcher}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01534}01534             \textcolor{comment}{//can't add them due to thread access violation}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01535}01535             \textcolor{keywordflow}{if}(!Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01536}01536             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01537}01537                 \textcolor{comment}{//First we wait till all the images are loaded}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01538}01538                 \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01539}01539                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01540}01540                     Application.DoEvents();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01541}01541                 \} \textcolor{keywordflow}{while} (images.Count < width * height);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01542}01542                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < images.Count; i++)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01543}01543                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01544}01544                     App.viewer.AddImage(images[i]);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01545}01545                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01546}01546                 images.Clear();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01547}01547             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01548}01548             imagingStack = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01549}01549             \textcolor{keywordflow}{return} ims.ToArray();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01550}01550         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01554}01554         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}} GetObjectiveViewRectangle()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01555}01555         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01556}01556             Objectives.Objective o = Objectives.GetObjective();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01557}01557             \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} d = Stage.GetPosition(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01558}01558             \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}}(d.X, d.Y, o.ViewWidth, o.ViewHeight);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01559}01559         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01567}01567         \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}} GetViewRectangle(\textcolor{keywordtype}{bool} update)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01568}01568         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01569}01569             \textcolor{keywordflow}{if} (update)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01570}01570             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01571}01571                 \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} d = Stage.GetPosition(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01572}01572                 \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}}(d.X, d.Y, viewSize.X, viewSize.Y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01573}01573             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01574}01574             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01575}01575             \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01576}01576                 \textcolor{keywordflow}{if}(Properties.Settings.Default.PMicroscope)}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01577}01577                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01578}01578                     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}}(PMicroscope.location.X, PMicroscope.location.Y, viewSize.X, viewSize.Y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01579}01579                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01580}01580                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01581}01581                 \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01582}01582                     \mbox{\hyperlink{_microscope_8cs_a40ad24a6b4c995cdf7ce359c4fab62d1}{PointD}} d = Stage.GetPosition(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01583}01583                     \textcolor{keywordflow}{return} \textcolor{keyword}{new} \mbox{\hyperlink{_abstract_flood_filler_8cs_ac5609d8431341169243f140d51551a9a}{RectangleD}}(d.X, d.Y, viewSize.X, viewSize.Y);}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01584}01584                 \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01585}01585             \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01586}01586         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01587}01587         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespacemicroscope_1_1__wrappers_1_1_b_m_c_a154f5a2c339dc54c3eef0d330de99e66}{Close}}()}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01588}01588         \{}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01589}01589             PMicroscope.Stop();}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01590}01590         \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01591}01591     \}}
\DoxyCodeLine{\Hypertarget{_microscope_8cs_source_l01592}01592 \}}

\end{DoxyCode}

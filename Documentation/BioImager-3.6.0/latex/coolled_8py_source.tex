\hypertarget{coolled_8py_source}{}\doxysection{coolled.\+py}
\label{coolled_8py_source}\index{F:/repos/BioImager/BioImager/PythonMicroscope/microscope/controllers/coolled.py@{F:/repos/BioImager/BioImager/PythonMicroscope/microscope/controllers/coolled.py}}
\mbox{\hyperlink{coolled_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00001}\mbox{\hyperlink{namespacemicroscope_1_1controllers}{00001}} \textcolor{comment}{\#!/usr/bin/env python3}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00020}00020 \textcolor{stringliteral}{"{}"{}"{}CoolLED illumination systems.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00021}00021 \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00023}00023 \textcolor{keyword}{import} logging}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00024}00024 \textcolor{keyword}{import} typing}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00025}00025 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00026}00026 \textcolor{keyword}{import} serial}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00028}00028 \textcolor{keyword}{import} microscope}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00029}00029 \textcolor{keyword}{import} \mbox{\hyperlink{namespacemicroscope_1_1__utils}{microscope.\_utils}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00030}00030 \textcolor{keyword}{import} \mbox{\hyperlink{namespacemicroscope_1_1abc}{microscope.abc}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00033}00033 \_logger = logging.getLogger(\_\_name\_\_)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00036}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection}{00036}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection}{\_CoolLEDConnection}}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00037}00037     \textcolor{stringliteral}{"{}"{}"{}Connection to the CoolLED controller, wraps base commands."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00039}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a963b01654f90ecf702d1d496dd06a811}{00039}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a963b01654f90ecf702d1d496dd06a811}{\_\_init\_\_}}(self, serial: microscope.\mbox{\hyperlink{classmicroscope_1_1__utils_1_1_shared_serial}{\_utils.SharedSerial}}) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00040}00040         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}} = serial}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00042}00042         \textcolor{comment}{\# When we connect for the first time, we will get back a}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00043}00043         \textcolor{comment}{\# greeting message like 'CoolLED precisExcite, Hello, pleased}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00044}00044         \textcolor{comment}{\# to meet you'.  Discard it by reading until timeout.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00045}00045         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}}.readlines()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00047}00047         \textcolor{comment}{\# Check that this behaves like a CoolLED device.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00048}00048         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00049}00049             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_affaf93559285e4049740f22e88852f97}{get\_css}}()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00050}00050         \textcolor{keywordflow}{except} Exception:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00051}00051             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_initialise_error}{microscope.InitialiseError}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00052}00052                 \textcolor{stringliteral}{"{}Not a CoolLED device, unable to get CSS"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00053}00053             )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00055}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_affaf93559285e4049740f22e88852f97}{00055}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_affaf93559285e4049740f22e88852f97}{get\_css}}(self) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00056}00056         \textcolor{stringliteral}{"{}"{}"{}Get the global channel status map."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00057}00057         \textcolor{keyword}{with} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}}.lock:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00058}00058             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}}.write(b\textcolor{stringliteral}{"{}CSS?\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00059}00059             answer = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}}.readline()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00060}00060         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} answer.startswith(b\textcolor{stringliteral}{"{}CSS"{}}):}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00061}00061             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_device_error}{microscope.DeviceError}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00062}00062                 \textcolor{stringliteral}{"{}answer to 'CSS?' should start with 'CSS'"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00063}00063                 \textcolor{stringliteral}{"{} but got '\%s' instead"{}} \% answer.decode}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00064}00064             )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00065}00065         \textcolor{keywordflow}{return} answer[3:-\/2]  \textcolor{comment}{\# remove initial b'CSS' and final b'\(\backslash\)r\(\backslash\)n'}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00067}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a51fd1d8ffd3c6efe136a2665966ec3b4}{00067}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a51fd1d8ffd3c6efe136a2665966ec3b4}{set\_css}}(self, css: bytes) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00068}00068         \textcolor{stringliteral}{"{}"{}"{}Set status for any number of channels."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00069}00069         \textcolor{keyword}{assert} len(css) \% 6 == 0, \textcolor{stringliteral}{"{}css must be multiple of 6 (6 per channel)"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00070}00070         \textcolor{keyword}{with} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}}.lock:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00071}00071             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}}.write(b\textcolor{stringliteral}{"{}CSS"{}} + css + b\textcolor{stringliteral}{"{}\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00072}00072             answer = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_a1a244d1b1976de64351a9cfe9e99e5f5}{\_serial}}.readline()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00073}00073         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} answer.startswith(b\textcolor{stringliteral}{"{}CSS"{}}):}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00074}00074             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_device_error}{microscope.DeviceError}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00075}00075                 \textcolor{stringliteral}{"{}answer to 'CSS?' should start with 'CSS'"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00076}00076                 \textcolor{stringliteral}{"{} but got '\%s' instead"{}} \% answer.decode}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00077}00077             )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00079}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_af275ed1e320e099da07b0904994f4459}{00079}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_af275ed1e320e099da07b0904994f4459}{get\_channels}}(self) -\/> typing.List[str]:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00080}00080         \textcolor{stringliteral}{"{}"{}"{}Return list of channel names (names are one character string)."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00081}00081         \textcolor{comment}{\# answer has the form: [xsnNNN] per channel.  The letter 'x'}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00082}00082         \textcolor{comment}{\# defines the channel (A to H), 's' refers to S (Selected) or}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00083}00083         \textcolor{comment}{\# X (Not selected), 'n' refers to N (On) or F (Off) and 'NNN'}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00084}00084         \textcolor{comment}{\# is the intensity in integer percent.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00085}00085         \textcolor{keywordflow}{return} list(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection_affaf93559285e4049740f22e88852f97}{get\_css}}()[::6].decode())}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00088}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection}{00088}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection}{\_CoolLEDChannelConnection}}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00089}00089     \textcolor{stringliteral}{"{}"{}"{}Wraps the CoolLED connection to control a single channel."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00091}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_abcb86d2b1e2b83d893fc1abd97cf038b}{00091}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_abcb86d2b1e2b83d893fc1abd97cf038b}{\_\_init\_\_}}(self, connection: \_CoolLEDConnection, name: str) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00092}00092         \textcolor{keywordflow}{if} len(name) != 1:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00093}00093             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}name should be a one character string"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00094}00094         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aabf75400debd1b6b9bdc4d39daa9525d}{\_conn}} = connection}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00095}00095         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a1b37fb036f1ed3a2fdec6f8e5e5a4779}{\_css\_offset}} = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aabf75400debd1b6b9bdc4d39daa9525d}{\_conn}}.get\_css()[::6].index(name.encode()) * 6}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00097}00097     \textcolor{keyword}{def }\_get\_css(self) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00098}00098         global\_css = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aabf75400debd1b6b9bdc4d39daa9525d}{\_conn}}.get\_css()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00099}00099         \textcolor{keywordflow}{return} global\_css[self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a1b37fb036f1ed3a2fdec6f8e5e5a4779}{\_css\_offset}} : self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a1b37fb036f1ed3a2fdec6f8e5e5a4779}{\_css\_offset}} + 6]}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00101}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_ae719be7de44e08ba84f2f04c6cb38835}{00101}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_ae719be7de44e08ba84f2f04c6cb38835}{get\_intensity}}(self) -\/> int:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00102}00102         \textcolor{stringliteral}{"{}"{}"{}Intensity in integer percent [0 100]"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00103}00103         \textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a5f3a75bc613e48408e3097849e71649c}{\_get\_css}}()[3:])}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00105}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aa1a4e3e364a9768a6bb3144a5256da9b}{00105}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aa1a4e3e364a9768a6bb3144a5256da9b}{set\_intensity}}(self, intensity: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00106}00106         \textcolor{stringliteral}{"{}"{}"{}Intensity in integer percent [0 100]"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00107}00107         percent = str(intensity).zfill(3)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00108}00108         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aabf75400debd1b6b9bdc4d39daa9525d}{\_conn}}.set\_css(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a5f3a75bc613e48408e3097849e71649c}{\_get\_css}}()[0:3] + percent.encode())}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00110}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_ab9633e41cfe62a0b7a66e54dd1d0071d}{00110}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_ab9633e41cfe62a0b7a66e54dd1d0071d}{get\_switch\_state}}(self) -\/> str:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00111}00111         \textcolor{stringliteral}{"{}"{}"{}N (On) or F (Off)"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00112}00112         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a5f3a75bc613e48408e3097849e71649c}{\_get\_css}}()[2:3].decode()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00114}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a2cb6a89dd84955cd68bfcfebefe96eff}{00114}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a2cb6a89dd84955cd68bfcfebefe96eff}{set\_switch\_state}}(self, state: str) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00115}00115         \textcolor{stringliteral}{"{}"{}"{}N (On) or F (Off)"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00116}00116         \textcolor{keywordflow}{if} state \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} [\textcolor{stringliteral}{"{}N"{}}, \textcolor{stringliteral}{"{}F"{}}]:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00117}00117             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}state needs to be N (on) or F (off)"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00118}00118         css = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a5f3a75bc613e48408e3097849e71649c}{\_get\_css}}()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00119}00119         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aabf75400debd1b6b9bdc4d39daa9525d}{\_conn}}.set\_css(css[0:2] + state.encode() + css[3:])}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00120}00120 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00121}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a827be2010f1d290699be3d036e0b8eae}{00121}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a827be2010f1d290699be3d036e0b8eae}{get\_selected\_state}}(self) -\/> str:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00122}00122         \textcolor{stringliteral}{"{}S (Selected) or X (Unselected)"{}} \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00123}00123         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a5f3a75bc613e48408e3097849e71649c}{\_get\_css}}()[1:2].decode()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00125}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_af9cc39d915954b0ceef7054cd6f69671}{00125}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_af9cc39d915954b0ceef7054cd6f69671}{set\_selected\_state}}(self, state: str) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00126}00126         \textcolor{stringliteral}{"{}"{}"{}X (Unselected) or S (Selected)"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00127}00127         \textcolor{keywordflow}{if} state \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} [\textcolor{stringliteral}{"{}X"{}}, \textcolor{stringliteral}{"{}S"{}}]:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00128}00128             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}state must be X (Unselected) or S (Selected)"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00129}00129         css = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_a5f3a75bc613e48408e3097849e71649c}{\_get\_css}}()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00130}00130         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection_aabf75400debd1b6b9bdc4d39daa9525d}{\_conn}}.set\_css(css[0:1] + state.encode() + css[2:])}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00132}00132 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00133}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel}{00133}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel}{\_CoolLEDChannel}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_light_source}{microscope.abc.LightSource}}):}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00134}00134     \textcolor{stringliteral}{"{}"{}"{}Individual light devices that compose a CoolLED controller."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00136}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a8bb2ee58f73aa6a5849cb8f13eb82c99}{00136}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a8bb2ee58f73aa6a5849cb8f13eb82c99}{\_\_init\_\_}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00137}00137         self, connection: \_CoolLEDConnection, name: str, **kwargs}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00138}00138     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00139}00139         super().\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a8bb2ee58f73aa6a5849cb8f13eb82c99}{\_\_init\_\_}}(**kwargs)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00140}00140         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}} = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_connection}{\_CoolLEDChannelConnection}}(connection, name)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00141}00141         \textcolor{comment}{\# If a channel is disabled ("{}unselected"{}), setting the trigger}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00142}00142         \textcolor{comment}{\# type to software ("{}on"{}) is not recorded and reverts back to}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00143}00143         \textcolor{comment}{\# high ("{}off"{}).  Because of this, we keep track of what}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00144}00144         \textcolor{comment}{\# trigger type we want, i.e., should be "{}on"{} or "{}off"{}, and}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00145}00145         \textcolor{comment}{\# apply it when the channel is enabled.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00146}00146         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a204c1449767d628369d78e0746d15686}{\_should\_be\_on}} = \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00148}00148         \textcolor{comment}{\# The channel may be "{}selected"{} (enabled) and "{}off"{} (trigger}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00149}00149         \textcolor{comment}{\# type HIGH).  When we set the trigger type to software,}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00150}00150         \textcolor{comment}{\# that's the same as setting it "{}on"{} which will make the}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00151}00151         \textcolor{comment}{\# channel emit light.  Constructing this channel should not}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00152}00152         \textcolor{comment}{\# accidentally mae it emit light so disable it firt.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00153}00153         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_device_add8e7f466e7a28137d6e0ceede74e15e}{disable}}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a202659d3448bb0cd46e0204a36810570}{disable}}()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00154}00154 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00155}00155         \textcolor{comment}{\# Default to software trigger type.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00156}00156         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_trigger_target_mixin_a3c74f4111c799b181a6168d35474def0}{set\_trigger}}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_aa41de8ed3444f5e5416bf0f80481b684}{set\_trigger}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00157}00157             microscope.TriggerType.SOFTWARE, microscope.TriggerMode.BULB}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00158}00158         )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00160}00160     \textcolor{keyword}{def }\_do\_shutdown(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00161}00161         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00163}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a84aa22f469dfd6db3ec0915b7561d620}{00163}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a84aa22f469dfd6db3ec0915b7561d620}{get\_status}}(self) -\/> typing.List[str]:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00164}00164         \textcolor{keywordflow}{return} []}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00166}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_ada812f986a1e28bab732bc76a4eff07f}{00166}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_ada812f986a1e28bab732bc76a4eff07f}{enable}}(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00167}00167         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.set\_selected\_state(\textcolor{stringliteral}{"{}S"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00168}00168         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a204c1449767d628369d78e0746d15686}{\_should\_be\_on}}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00169}00169             \textcolor{comment}{\# TriggerType.SOFTWARE}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00170}00170             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.set\_switch\_state(\textcolor{stringliteral}{"{}N"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00171}00171         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00172}00172             \textcolor{comment}{\# TriggerType.HIGH}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00173}00173             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.set\_switch\_state(\textcolor{stringliteral}{"{}F"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00175}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a202659d3448bb0cd46e0204a36810570}{00175}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a202659d3448bb0cd46e0204a36810570}{disable}}(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00176}00176         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.set\_selected\_state(\textcolor{stringliteral}{"{}X"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00178}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_ade1ceae3502ab6a29bac59fb75a96327}{00178}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_ade1ceae3502ab6a29bac59fb75a96327}{get\_is\_on}}(self) -\/> bool:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00179}00179         selected = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.get\_selected\_state()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00180}00180         \textcolor{keyword}{assert} selected \textcolor{keywordflow}{in} [\textcolor{stringliteral}{"{}S"{}}, \textcolor{stringliteral}{"{}X"{}}]}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00181}00181         \textcolor{keywordflow}{return} selected == \textcolor{stringliteral}{"{}S"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00182}00182 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00183}00183     \textcolor{keyword}{def }\_do\_get\_power(self) -\/> float:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00184}00184         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.get\_intensity() / 100.0}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00185}00185 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00186}00186     \textcolor{keyword}{def }\_do\_set\_power(self, power: float) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00187}00187         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.set\_intensity(int(power * 100.0))}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00188}00188 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00189}00189     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00190}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a1e465ac7f78a453a7e973a21e9255b41}{00190}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a1e465ac7f78a453a7e973a21e9255b41}{trigger\_type}}(self) -\/> microscope.TriggerType:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00191}00191         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.get\_selected\_state() == \textcolor{stringliteral}{"{}S"{}}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00192}00192             \textcolor{comment}{\# Channel is "{}selected"{} (enabled): get the answer from}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00193}00193             \textcolor{comment}{\# switch state ("{}on"{} or "{}off"{}).}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00194}00194             \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.get\_switch\_state() == \textcolor{stringliteral}{"{}N"{}}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00195}00195                 \textcolor{keywordflow}{return} microscope.TriggerType.SOFTWARE}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00196}00196             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00197}00197                 \textcolor{keywordflow}{return} microscope.TriggerType.HIGH}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00198}00198         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00199}00199             \textcolor{comment}{\# Channel is "{}unselected"{} (disabled): trigger type will be}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00200}00200             \textcolor{comment}{\# whatever we set it to when we enable it.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00201}00201             \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a204c1449767d628369d78e0746d15686}{\_should\_be\_on}}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00202}00202                 \textcolor{keywordflow}{return} microscope.TriggerType.SOFTWARE}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00203}00203             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00204}00204                 \textcolor{keywordflow}{return} microscope.TriggerType.HIGH}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00206}00206     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00207}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a573c70aacde5186b9fd05a433341f629}{00207}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a573c70aacde5186b9fd05a433341f629}{trigger\_mode}}(self) -\/> microscope.TriggerMode:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00208}00208         \textcolor{keywordflow}{return} microscope.TriggerMode.BULB}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00210}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_aa41de8ed3444f5e5416bf0f80481b684}{00210}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_aa41de8ed3444f5e5416bf0f80481b684}{set\_trigger}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00211}00211         self, ttype: microscope.TriggerType, tmode: \mbox{\hyperlink{classmicroscope_1_1_trigger_mode}{microscope.TriggerMode}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00212}00212     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00213}00213         \textcolor{keywordflow}{if} tmode \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} microscope.TriggerMode.BULB:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00214}00214             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_unsupported_feature_error}{microscope.UnsupportedFeatureError}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00215}00215                 \textcolor{stringliteral}{"{}the only trigger mode supported is 'bulb'"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00216}00216             )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00217}00217         \textcolor{keywordflow}{if} ttype \textcolor{keywordflow}{is} microscope.TriggerType.SOFTWARE:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00218}00218             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.set\_switch\_state(\textcolor{stringliteral}{"{}N"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00219}00219             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a204c1449767d628369d78e0746d15686}{\_should\_be\_on}} = \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00220}00220         \textcolor{keywordflow}{elif} ttype \textcolor{keywordflow}{is} microscope.TriggerType.HIGH:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00221}00221             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a17eff66b34eeac1acfec77c008aba9a1}{\_conn}}.set\_switch\_state(\textcolor{stringliteral}{"{}F"{}})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00222}00222             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel_a204c1449767d628369d78e0746d15686}{\_should\_be\_on}} = \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00223}00223         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00224}00224             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_unsupported_feature_error}{microscope.UnsupportedFeatureError}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00225}00225                 \textcolor{stringliteral}{"{}trigger type supported must be 'SOFTWARE' or 'HIGH'"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00226}00226             )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00227}00227 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00228}00228     \textcolor{keyword}{def }\_do\_trigger(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00229}00229         \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_incompatible_state_error}{microscope.IncompatibleStateError}}(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00230}00230             \textcolor{stringliteral}{"{}trigger does not make sense in trigger mode bulb, only enable"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00231}00231         )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00233}00233 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00234}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1_cool_l_e_d}{00234}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1_cool_l_e_d}{CoolLED}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_controller}{microscope.abc.Controller}}):}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00235}00235     \textcolor{stringliteral}{"{}"{}"{}CoolLED controller for the individual light devices.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00236}00236 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00237}00237 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00238}00238 \textcolor{stringliteral}{        port: port name (Windows) }\textcolor{keywordflow}{or} path to port (everything \textcolor{keywordflow}{else}) to}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00239}00239             connect to.  For example, `/dev/ttyACM0`, `COM1`, \textcolor{keywordflow}{or}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00240}00240             `/dev/cuad1`.}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00241}00241 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00242}00242     The individual channels are named A to H \textcolor{keywordflow}{and} depend on the actual}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00243}00243     device.  The pE-\/300 have three channels named A, B, \textcolor{keywordflow}{and} C by}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00244}00244     increasing order of wavelength of their spectral region.  The}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00245}00245     pE-\/4000 have four selectable channels named A, B, C, \textcolor{keywordflow}{and} D \textcolor{keyword}{with}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00246}00246     channels E-\/H \textcolor{keywordflow}{for} peripheral devices via a pE expansion box.}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00248}00248     .. code-\/block:: python}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00250}00250        \textcolor{comment}{\# Connect to a pE-\/300 ultra and get the individual lights.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00251}00251        controller = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1_cool_l_e_d}{CoolLED}}(\textcolor{stringliteral}{'/dev/ttyACM0'})}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00252}00252        violet = controller.devices[\textcolor{stringliteral}{'A'}]}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00253}00253        blue = controller.devices[\textcolor{stringliteral}{'B'}]}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00254}00254        red = controller.devices[\textcolor{stringliteral}{'C'}]}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00256}00256        \textcolor{comment}{\# Turn on the violet channel.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00257}00257        violet.enable()}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00259}00259     CoolLED controllers are often used \textcolor{keyword}{with} a control pod which can}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00260}00260     select/unselect \textcolor{keywordflow}{and} turn on/off individual channels.  The meaning}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00261}00261     of these two states are:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00262}00262 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00263}00263     * \textcolor{stringliteral}{"{}selected"{}} \textcolor{keywordflow}{and} \textcolor{stringliteral}{"{}on"{}}: channel \textcolor{keywordflow}{is} always emitting light.  This \textcolor{keywordflow}{is}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00264}00264       equivalent to being enabled \textcolor{keyword}{with} `SOFTWARE` trigger type.}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00265}00265 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00266}00266     * \textcolor{stringliteral}{"{}selected"{}} \textcolor{keywordflow}{and} \textcolor{stringliteral}{"{}off"{}}: channel will emit light \textcolor{keywordflow}{in} receipt of a}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00267}00267       TTL signal.  This \textcolor{keywordflow}{is} equivalent to being enabled \textcolor{keyword}{with} `HIGH`}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00268}00268       trigger type.}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00269}00269 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00270}00270     * \textcolor{stringliteral}{"{}unselected"{}} \textcolor{keywordflow}{and} \textcolor{stringliteral}{"{}off"{}}: channel nevers emit light.  This \textcolor{keywordflow}{is}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00271}00271       equivalent to being disabled.}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00272}00272 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00273}00273     * \textcolor{stringliteral}{"{}unselected"{}} \textcolor{keywordflow}{and} \textcolor{stringliteral}{"{}on"{}}: this \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} possible.  If an \textcolor{stringliteral}{"{}unselected"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00274}00274       channel \textcolor{keywordflow}{is} turned \textcolor{stringliteral}{"{}on"{}} it reverts back to \textcolor{stringliteral}{"{}off"{}}.}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00276}00276     .. note::}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00278}00278        If a channel \textcolor{keywordflow}{is} set \textcolor{keyword}{with} `TriggerType.SOFTWARE` (\textcolor{stringliteral}{"{}on"{}}) it will}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00279}00279        start emitting light once enabled (\textcolor{stringliteral}{"{}selected"{}}).  Once enabled,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00280}00280        even though trigger type \textcolor{keywordflow}{is} set to software \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} hardware,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00281}00281        \textcolor{keywordflow}{if} the channel receives a TTL signal it will switch to}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00282}00282        `TriggerType.HIGH` \textcolor{keywordflow}{and} \textcolor{keywordflow}{continue} to report being set to}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00283}00283        software.  This seems to be an issue \textcolor{keyword}{with} the CoolLED}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00284}00284        https://github.com/python-\/microscope/vendor-\/issues/issues/9}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00286}00286     This was developed \textcolor{keyword}{with} a CoolLED pE-\/300 ultra but should work}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00287}00287     \textcolor{keyword}{with} the whole pE-\/300 series.  It should also work \textcolor{keyword}{with} the}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00288}00288     pE-\/4000 \textcolor{keywordflow}{and} the pE expansion box \textcolor{keyword}{with} the exception of loading}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00289}00289     different sources.}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00291}00291     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00292}00292 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00293}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1_cool_l_e_d_ad5392bff6dba1cfc523500ab084409e3}{00293}} \textcolor{stringliteral}{    }\textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1_cool_l_e_d_ad5392bff6dba1cfc523500ab084409e3}{\_\_init\_\_}}(self, port: str, **kwargs) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00294}00294         super().\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1_cool_l_e_d_ad5392bff6dba1cfc523500ab084409e3}{\_\_init\_\_}}(**kwargs)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00295}00295         self.\_channels: typing.Dict[str, \mbox{\hyperlink{classmicroscope_1_1abc_1_1_light_source}{microscope.abc.LightSource}}] = \{\}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00296}00296 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00297}00297         \textcolor{comment}{\# CoolLED manual only has the baudrate, we guessed the rest.}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00298}00298         serial\_conn = serial.Serial(}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00299}00299             port=port,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00300}00300             baudrate=57600,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00301}00301             timeout=1,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00302}00302             bytesize=serial.EIGHTBITS,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00303}00303             stopbits=serial.STOPBITS\_ONE,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00304}00304             parity=serial.PARITY\_NONE,}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00305}00305             xonxoff=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00306}00306             rtscts=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00307}00307             dsrdtr=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00308}00308         )}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00309}00309         shared\_serial = \mbox{\hyperlink{classmicroscope_1_1__utils_1_1_shared_serial}{microscope.\_utils.SharedSerial}}(serial\_conn)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00310}00310         connection = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_connection}{\_CoolLEDConnection}}(shared\_serial)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00311}00311         \textcolor{keywordflow}{for} name \textcolor{keywordflow}{in} connection.get\_channels():}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00312}00312             self.\_channels[name] = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1___cool_l_e_d_channel}{\_CoolLEDChannel}}(connection, name)}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00313}00313 }
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00314}00314     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00315}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1coolled_1_1_cool_l_e_d_a20c7ccd078de92c680f08d6a28329b3d}{00315}}     \textcolor{keyword}{def }devices(self) -\/> typing.Dict[str, microscope.abc.Device]:}
\DoxyCodeLine{\Hypertarget{coolled_8py_source_l00316}00316         \textcolor{keywordflow}{return} self.\_channels}

\end{DoxyCode}

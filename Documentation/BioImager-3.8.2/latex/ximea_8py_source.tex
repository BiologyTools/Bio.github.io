\hypertarget{ximea_8py_source}{}\doxysection{ximea.\+py}
\label{ximea_8py_source}\index{F:/repos/BioImager/BioImager/PythonMicroscope/microscope/cameras/ximea.py@{F:/repos/BioImager/BioImager/PythonMicroscope/microscope/cameras/ximea.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00001}00001 \textcolor{comment}{\#!/usr/bin/env python3}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00022}00022 \textcolor{stringliteral}{"{}"{}"{}Ximea cameras.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00023}00023 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00024}00024 \textcolor{stringliteral}{Changing settings flushes the buffer}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00025}00025 \textcolor{stringliteral}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00026}00026 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00027}00027 \textcolor{stringliteral}{It is not possible to set some parameters during image acquisition.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00028}00028 \textcolor{stringliteral}{In such cases, acquisition is stopped (camera is disabled) and the}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00029}00029 \textcolor{stringliteral}{restarted (camera is enabled).  However, stopping acquisition discards}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00030}00030 \textcolor{stringliteral}{any image }\textcolor{keywordflow}{in} the camera memory that have \textcolor{keywordflow}{not} yet been read.}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00032}00032 Modifying the following settings require acquisition to be stopped:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00034}00034 -\/ ROIs}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00035}00035 -\/ binning}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00036}00036 -\/ trigger type (trigger source)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00038}00038 For more details, see the [XiAPI manual](https://www.ximea.com/support/wiki/apis/XiAPI\_Manual\textcolor{comment}{\#Flushing-\/the-\/queue).}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00040}00040 Hardware trigger}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00041}00041 -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00043}00043 Ximea cameras \textcolor{keywordflow}{in} the MQ family accept software triggers even \textcolor{keywordflow}{if} set}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00044}00044 \textcolor{keywordflow}{for} hardware triggers (see `vendor issues}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00045}00045 \textcolor{comment}{\#3`<https://github.com/python-\/microscope/vendor-\/issues/issues/3>).}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00046}00046 However, `XimeaCamera.trigger()` checks the trigger type \textcolor{keywordflow}{and} will}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00047}00047 \textcolor{keywordflow}{raise} an exception unless the camera \textcolor{keywordflow}{is} set \textcolor{keywordflow}{for} software triggers.}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00049}00049 Requirements}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00050}00050 -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00052}00052 Support \textcolor{keywordflow}{for} Ximea cameras requires Ximea\textcolor{stringliteral}{'s API Python (xiApiPython).This }\textcolor{keywordflow}{is} only available via Ximea\textcolor{stringliteral}{'s website and is not available on}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00053}00053 \textcolor{stringliteral}{PyPI.  See Ximea's website for `install instructions}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00054}00054 \textcolor{stringliteral}{<https://www.ximea.com/support/wiki/apis/Python>`\_\_.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00055}00055 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00056}00056 \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00057}00057 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00058}00058 \textcolor{stringliteral}{import contextlib}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00059}00059 \textcolor{stringliteral}{import enum}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00060}00060 \textcolor{stringliteral}{import logging}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00061}00061 \textcolor{stringliteral}{import typing}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00062}00062 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00063}00063 \textcolor{stringliteral}{import numpy as np}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00064}00064 \textcolor{stringliteral}{from ximea import xiapi}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00065}00065 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00066}00066 \textcolor{stringliteral}{import microscope}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00067}00067 \textcolor{stringliteral}{import microscope.abc}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00068}00068 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00069}00069 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00070}00070 \textcolor{stringliteral}{\_logger = logging.getLogger(\_\_name\_\_)}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00071}00071 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00072}00072 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00073}00073 \textcolor{stringliteral}{\# The ximea package does not provide an enum for the error codes.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00074}00074 \textcolor{stringliteral}{\# There is ximea.xidefs.ERROR\_CODES which maps the error code to an}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00075}00075 \textcolor{stringliteral}{\# error message but what we need is a symbol that maps to the error}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00076}00076 \textcolor{stringliteral}{\# code so we can use while handling exceptions.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00077}00077 \textcolor{stringliteral}{\_XI\_TIMEOUT = 10}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00078}00078 \textcolor{stringliteral}{\_XI\_NOT\_SUPPORTED = 12}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00079}00079 \textcolor{stringliteral}{\_XI\_NOT\_IMPLEMENTED = 26}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00080}00080 \textcolor{stringliteral}{\_XI\_ACQUISITION\_STOPED = 45}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00081}00081 \textcolor{stringliteral}{\_XI\_UNKNOWN\_PARAM = 100}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00082}00082 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00083}00083 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00084}00084 \textcolor{stringliteral}{\# During acquisition, we rely on catching timeout errors which then}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00085}00085 \textcolor{stringliteral}{\# get discarded.  However, }\textcolor{keyword}{with} debug level set to warning (XiApi}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00086}00086 \textcolor{comment}{\# default log level), we get XiApi messages on stderr for each timeout}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00087}00087 \textcolor{comment}{\# making logging impossible.  So change this to error.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00088}00088 \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00089}00089 \textcolor{comment}{\# Debug level is a xiapi global setting but we need a Camera instance.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00090}00090 xiapi.Camera().set\_debug\_level(\textcolor{stringliteral}{"{}XI\_DL\_ERROR"{}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00092}00092 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00093}00093 \textcolor{preprocessor}{@contextlib.contextmanager}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00094}00094 \textcolor{keyword}{def }\_disabled\_camera(camera):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00095}00095     \textcolor{stringliteral}{"{}"{}"{}Context manager to temporarily disable camera."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00096}00096     \textcolor{keywordflow}{if} camera.enabled:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00097}00097         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00098}00098             camera.disable()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00099}00099             \textcolor{keywordflow}{yield} camera}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00100}00100         \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00101}00101             camera.enable()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00102}00102     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00103}00103         \textcolor{keywordflow}{yield} camera}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00106}00106 \textcolor{preprocessor}{@contextlib.contextmanager}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00107}00107 \textcolor{keyword}{def }\_enabled\_camera(camera):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00108}00108     \textcolor{stringliteral}{"{}"{}"{}Context manager to temporarily enable camera."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00109}00109     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} camera.enabled:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00110}00110         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00111}00111             camera.enable()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00112}00112             \textcolor{keywordflow}{yield} camera}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00113}00113         \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00114}00114             camera.disable()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00115}00115     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00116}00116         \textcolor{keywordflow}{yield} camera}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00119}00119 \textcolor{preprocessor}{@enum.unique}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00120}00120 \textcolor{keyword}{class }TrgSourceMap(enum.Enum):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00121}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_trg_source_map}{00121}}     \textcolor{comment}{\# The complete list is the XI\_TRG\_SOURCE enum (C code) or in the}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00122}00122     \textcolor{comment}{\# xidefs module (Python code).}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00123}00123 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00124}00124     XI\_TRG\_SOFTWARE = microscope.TriggerType.SOFTWARE}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00125}00125     XI\_TRG\_EDGE\_RISING = microscope.TriggerType.RISING\_EDGE}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00126}00126     XI\_TRG\_EDGE\_FALLING = microscope.TriggerType.FALLING\_EDGE}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00128}00128     \textcolor{comment}{\# Not all XI\_TRG\_SOURCE values are defined:}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00129}00129     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00130}00130     \textcolor{comment}{\# XI\_TRG\_OFF: Capture of next image is automatically started after}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00131}00131     \textcolor{comment}{\#   previous.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00132}00132     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00133}00133     \textcolor{comment}{\# XI\_TRG\_LEVEL\_HIGH: Specifies that the trigger is considered}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00134}00134     \textcolor{comment}{\#   valid as long as the level of the source signal is high.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00135}00135     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00136}00136     \textcolor{comment}{\# XI\_TRG\_LEVEL\_LOW: Specifies that the trigger is considered valid}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00137}00137     \textcolor{comment}{\#   as long as the level of the source signal is low.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00140}00140 \textcolor{preprocessor}{@enum.unique}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00141}00141 \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_trg_selector_map}{TrgSelectorMap}}(enum.Enum):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00142}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_trg_selector_map}{00142}}     \textcolor{comment}{\# The complete list is the XI\_TRG\_SELECTOR enum (C code) or in the}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00143}00143     \textcolor{comment}{\# xidefs module (Python code).}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00145}00145     \textcolor{comment}{\# Trigger starts the capture of one frame.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00146}00146     XI\_TRG\_SEL\_FRAME\_START = microscope.TriggerMode.ONCE}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00148}00148     \textcolor{comment}{\# There are other modes/selector which look like they have matches}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00149}00149     \textcolor{comment}{\# on TriggerMode but we never got to test them:}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00150}00150     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00151}00151     \textcolor{comment}{\# XI\_TRG\_SEL\_EXPOSURE\_ACTIVE: Trigger controls the start and}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00152}00152     \textcolor{comment}{\#   length of the exposure.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00153}00153     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00154}00154     \textcolor{comment}{\# XI\_TRG\_SEL\_FRAME\_BURST\_START: Trigger starts the capture of the}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00155}00155     \textcolor{comment}{\#   bursts of frames in an acquisition.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00156}00156     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00157}00157     \textcolor{comment}{\# XI\_TRG\_SEL\_FRAME\_BURST\_ACTIVE: Trigger controls the duration of}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00158}00158     \textcolor{comment}{\#   the capture of the bursts of frames in an acquisition.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00159}00159     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00160}00160     \textcolor{comment}{\# XI\_TRG\_SEL\_MULTIPLE\_EXPOSURES: Trigger which when first trigger}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00161}00161     \textcolor{comment}{\#   starts exposure and consequent pulses are gating}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00162}00162     \textcolor{comment}{\#   exposure(active HI)}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00163}00163     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00164}00164     \textcolor{comment}{\# XI\_TRG\_SEL\_EXPOSURE\_START: Trigger controls the start of the}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00165}00165     \textcolor{comment}{\#   exposure of one Frame.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00166}00166     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00167}00167     \textcolor{comment}{\# XI\_TRG\_SEL\_MULTI\_SLOPE\_PHASE\_CHANGE: Trigger controls the multi}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00168}00168     \textcolor{comment}{\#   slope phase in one Frame (phase0 -\/> phase1) or (phase1 -\/>}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00169}00169     \textcolor{comment}{\#   phase2).}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00170}00170     \textcolor{comment}{\#}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00171}00171     \textcolor{comment}{\# XI\_TRG\_SEL\_ACQUISITION\_START: Trigger starts acquisition of}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00172}00172     \textcolor{comment}{\#   first frame.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00175}00175 \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera}{XimeaCamera}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_camera}{microscope.abc.Camera}}):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00176}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera}{00176}}     \textcolor{stringliteral}{"{}"{}"{}Ximea cameras}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00177}00177 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00178}00178 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00179}00179 \textcolor{stringliteral}{        serial\_number: the serial number of the camera to connect to.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00180}00180 \textcolor{stringliteral}{            It can be set to `}\textcolor{keywordtype}{None}` \textcolor{keywordflow}{if} there \textcolor{keywordflow}{is} only camera on the}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00181}00181             system.}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00182}00182 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00183}00183     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00184}00184 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00185}00185 \textcolor{stringliteral}{    }\textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a5187efcee41e91c498c4b07b9a30842c}{\_\_init\_\_}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00186}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a5187efcee41e91c498c4b07b9a30842c}{00186}}         self, serial\_number: typing.Optional[str] = \textcolor{keywordtype}{None}, **kwargs}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00187}00187     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00188}00188         super().\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a5187efcee41e91c498c4b07b9a30842c}{\_\_init\_\_}}(**kwargs)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00189}00189         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}} = \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00190}00190         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}} = xiapi.Camera()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00191}00191         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a1a2f2b459fe1917b995c90ce4ba9284a}{\_img}} = xiapi.Image()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00192}00192         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a3b7c2bca41c84193976327ea7fc83e50}{\_serial\_number}} = serial\_number}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00193}00193         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}} = (0, 0)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00194}00194         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6d9d2d071d3c88fc9797aa0bb59d5187}{\_roi}} = \mbox{\hyperlink{classmicroscope_1_1_r_o_i}{microscope.ROI}}(\textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00195}00195         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a34cd192b79f51f863e87798838327192}{\_binning}} = \mbox{\hyperlink{classmicroscope_1_1_binning}{microscope.Binning}}(1, 1)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00197}00197         \textcolor{comment}{\# When using the Settings system, enums are not really enums}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00198}00198         \textcolor{comment}{\# and even when using lists we get indices sent back and forth}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00199}00199         \textcolor{comment}{\# (works fine only when using EnumInt.  The gymnastic here}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00200}00200         \textcolor{comment}{\# makes it work with the rest of enums which are there to make}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00201}00201         \textcolor{comment}{\# it work with TriggerTargetMixin.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00202}00202         trg\_source\_names = [x.name \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} TrgSourceMap]}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00204}00204         \textcolor{keyword}{def }\_trigger\_source\_setter(index: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00205}00205             trigger\_mode = TrgSourceMap[trg\_source\_names[index]].value}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00206}00206             self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_trigger_target_mixin_a3c74f4111c799b181a6168d35474def0}{set\_trigger}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_ac25dadfc65a77eba66a5d7c042f2c4b8}{set\_trigger}}(trigger\_mode, self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_trigger_target_mixin_ae7007f4ba2c462e3214ea06abf7398f3}{trigger\_mode}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a9ed76ee82f3c014a97541ac92f6a3ee0}{trigger\_mode}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00208}00208         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_device_a0252c8e32f95c4f8c19bedc1d96c1669}{add\_setting}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00209}00209             \textcolor{stringliteral}{"{}trigger source"{}},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00210}00210             \textcolor{stringliteral}{"{}enum"{}},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00211}00211             \textcolor{keyword}{lambda}: \mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_trg_source_map}{TrgSourceMap}}(self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_trigger_target_mixin_a04e0920d33c9b5c7cedcaba7c41053e3}{trigger\_type}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a692b37ae4ead1cd6d8b6895308239b58}{trigger\_type}}).name,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00212}00212             \_trigger\_source\_setter,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00213}00213             trg\_source\_names,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00214}00214         )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00215}00215 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00216}00216         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_device_a84ae82a5c5a20f3906ccdd4229a39023}{initialize}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a808f82612986ac5d699f6f1cd69c2d8f}{initialize}}()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00217}00217 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00218}00218     \textcolor{keyword}{def }\_fetch\_data(self) -\/> typing.Optional[np.ndarray]:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00219}00219         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00220}00220             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00221}00221 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00222}00222         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00223}00223             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_image(self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a1a2f2b459fe1917b995c90ce4ba9284a}{\_img}}, timeout=1)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00224}00224         \textcolor{keywordflow}{except} xiapi.Xi\_error \textcolor{keyword}{as} err:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00225}00225             \textcolor{comment}{\# err.status may not exist so use getattr (see}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00226}00226             \textcolor{comment}{\# https://github.com/python-\/microscope/vendor-\/issues/issues/2)}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00227}00227             \textcolor{keywordflow}{if} getattr(err, \textcolor{stringliteral}{"{}status"{}}, \textcolor{keywordtype}{None}) == \_XI\_TIMEOUT:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00228}00228                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00229}00229             \textcolor{keywordflow}{elif} (}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00230}00230                 getattr(err, \textcolor{stringliteral}{"{}status"{}}, \textcolor{keywordtype}{None}) == \_XI\_ACQUISITION\_STOPED}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00231}00231                 \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00232}00232             ):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00233}00233                 \textcolor{comment}{\# We can end up here during disable if self.\_acquiring}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00234}00234                 \textcolor{comment}{\# was True but is now False.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00235}00235                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00236}00236             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00237}00237                 \textcolor{keywordflow}{raise}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00238}00238 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00239}00239         data: np.ndarray = self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a1a2f2b459fe1917b995c90ce4ba9284a}{\_img}}.get\_image\_data\_numpy()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00240}00240         \_logger.info(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00241}00241             \textcolor{stringliteral}{"{}Fetched imaged with dims \%s and size \%s."{}}, data.shape, data.size}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00242}00242         )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00243}00243         \textcolor{keywordflow}{return} data}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00244}00244 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00245}00245     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a43289094919fd33d2389c495f61fdaa6}{abort}}(self):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00246}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a43289094919fd33d2389c495f61fdaa6}{00246}}         \_logger.info(\textcolor{stringliteral}{"{}Disabling acquisition."{}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00247}00247         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00248}00248             \textcolor{comment}{\# We set acquiring before calling stop\_acquisition because}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00249}00249             \textcolor{comment}{\# the fetch loop is still running and will raise errors 45}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00250}00250             \textcolor{comment}{\# otherwise.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00251}00251             self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}} = \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00252}00252             \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00253}00253                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.stop\_acquisition()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00254}00254             \textcolor{keywordflow}{except} Exception:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00255}00255                 self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}} = \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00256}00256                 \textcolor{keywordflow}{raise}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00257}00257 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00258}00258     \textcolor{keyword}{def }initialize(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00259}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a808f82612986ac5d699f6f1cd69c2d8f}{00259}}         \textcolor{stringliteral}{"{}"{}"{}Initialise the camera.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00260}00260 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00261}00261 \textcolor{stringliteral}{        Open the connection, connect properties }\textcolor{keywordflow}{and} populate settings dict.}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00262}00262         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00263}00263 \textcolor{stringliteral}{        n\_cameras = self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_number\_devices()}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00264}00264 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00265}00265 \textcolor{stringliteral}{        }\textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a3b7c2bca41c84193976327ea7fc83e50}{\_serial\_number}} \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00266}00266             \textcolor{keywordflow}{if} n\_cameras > 1:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00267}00267                 \textcolor{keywordflow}{raise} TypeError(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00268}00268                     \textcolor{stringliteral}{"{}more than one Ximea camera found but the"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00269}00269                     \textcolor{stringliteral}{"{} serial\_number argument was not specified"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00270}00270                 )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00271}00271             \_logger.info(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00272}00272                 \textcolor{stringliteral}{"{}serial\_number is not specified but there is only one"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00273}00273                 \textcolor{stringliteral}{"{} camera on the system"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00274}00274             )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00275}00275             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.open\_device()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00276}00276         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00277}00277             \_logger.info(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00278}00278                 \textcolor{stringliteral}{"{}opening camera with serial number '\%s'"{}}, self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a3b7c2bca41c84193976327ea7fc83e50}{\_serial\_number}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00279}00279             )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00280}00280             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.open\_device\_by\_SN(self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a3b7c2bca41c84193976327ea7fc83e50}{\_serial\_number}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00282}00282         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}} = (}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00283}00283             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_width\_maximum()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00284}00284             + self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_offsetX\_maximum(),}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00285}00285             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_height\_maximum()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00286}00286             + self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_offsetY\_maximum(),}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00287}00287         )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00288}00288         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6d9d2d071d3c88fc9797aa0bb59d5187}{\_roi}} = \mbox{\hyperlink{classmicroscope_1_1_r_o_i}{microscope.ROI}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00289}00289             left=0,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00290}00290             top=0,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00291}00291             width=self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}}[0],}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00292}00292             height=self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}}[1],}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00293}00293         )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00294}00294         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_camera_a611b492b2e6de513b0f490ce8467d939}{set\_roi}}(self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6d9d2d071d3c88fc9797aa0bb59d5187}{\_roi}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00295}00295 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00296}00296         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_trigger_target_mixin_a3c74f4111c799b181a6168d35474def0}{set\_trigger}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_ac25dadfc65a77eba66a5d7c042f2c4b8}{set\_trigger}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00297}00297             microscope.TriggerType.SOFTWARE, microscope.TriggerMode.ONCE}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00298}00298         )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00300}00300         \textcolor{comment}{\# Add settings for the different temperature sensors.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00301}00301         \textcolor{keywordflow}{for} temp\_param\_name \textcolor{keywordflow}{in} [}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00302}00302             \textcolor{stringliteral}{"{}chip\_temp"{}},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00303}00303             \textcolor{stringliteral}{"{}hous\_temp"{}},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00304}00304             \textcolor{stringliteral}{"{}hous\_back\_side\_temp"{}},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00305}00305             \textcolor{stringliteral}{"{}sensor\_board\_temp"{}},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00306}00306         ]:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00307}00307             get\_temp\_method = getattr(self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}, \textcolor{stringliteral}{"{}get\_"{}} + temp\_param\_name)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00308}00308             \textcolor{comment}{\# Not all cameras have temperature sensors in all}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00309}00309             \textcolor{comment}{\# locations.  We can't query if the sensor is there, we}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00310}00310             \textcolor{comment}{\# can only try to read the temperature and skip that}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00311}00311             \textcolor{comment}{\# temperature sensor if we get an exception.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00312}00312             \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00313}00313                 get\_temp\_method()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00314}00314             \textcolor{keywordflow}{except} xiapi.Xi\_error \textcolor{keyword}{as} err:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00315}00315                 \textcolor{comment}{\# Depending on XiAPI version, camera model, and}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00316}00316                 \textcolor{comment}{\# selected sensor, we might get any of these errors as}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00317}00317                 \textcolor{comment}{\# meaning that it's not available.  See}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00318}00318                 \textcolor{comment}{\# https://github.com/python-\/microscope/vendor-\/issues/issues/6}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00319}00319                 \textcolor{keywordflow}{if} err.status \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} [}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00320}00320                     \_XI\_NOT\_SUPPORTED,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00321}00321                     \_XI\_NOT\_IMPLEMENTED,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00322}00322                     \_XI\_UNKNOWN\_PARAM,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00323}00323                 ]:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00324}00324                     \textcolor{keywordflow}{raise}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00325}00325             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00326}00326                 self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_device_a0252c8e32f95c4f8c19bedc1d96c1669}{add\_setting}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00327}00327                     temp\_param\_name,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00328}00328                     \textcolor{stringliteral}{"{}float"{}},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00329}00329                     get\_temp\_method,}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00330}00330                     \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00331}00331                     values=tuple(),}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00332}00332                 )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00334}00334     \textcolor{keyword}{def }\_do\_disable(self):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00335}00335         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a36952a38857bc6c8eb627b2d8b6b867b}{abort}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a43289094919fd33d2389c495f61fdaa6}{abort}}()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00336}00336 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00337}00337     \textcolor{keyword}{def }\_do\_enable(self):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00338}00338         \_logger.info(\textcolor{stringliteral}{"{}Preparing for acquisition."{}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00339}00339         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00340}00340             self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a36952a38857bc6c8eb627b2d8b6b867b}{abort}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a43289094919fd33d2389c495f61fdaa6}{abort}}()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00341}00341         \textcolor{comment}{\# actually start camera}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00342}00342         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.start\_acquisition()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00343}00343         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}} = \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00344}00344         \_logger.info(\textcolor{stringliteral}{"{}Acquisition enabled."{}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00345}00345         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00346}00346 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00347}00347     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a9a2ce2c562da7aed8eeecf398e3e9c4a}{set\_exposure\_time}}(self, value: float) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00348}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a9a2ce2c562da7aed8eeecf398e3e9c4a}{00348}}         \textcolor{comment}{\# exposure times are set in us.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00349}00349         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00350}00350             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_exposure\_direct(int(value * 1000000))}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00351}00351         \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} err:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00352}00352             \_logger.debug(\textcolor{stringliteral}{"{}set\_exposure\_time exception: \%s"{}}, err)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00353}00353 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00354}00354     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a0871c3a944a7176ad762ea615762fc99}{get\_exposure\_time}}(self) -\/> float:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00355}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a0871c3a944a7176ad762ea615762fc99}{00355}}         \textcolor{comment}{\# exposure times are in us, so multiple by 1E-\/6 to get seconds.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00356}00356         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_exposure() * 1.0e-\/6}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00357}00357 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00358}00358     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a434c32b877b16a368e89ef4f58c1de3a}{get\_cycle\_time}}(self):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00359}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a434c32b877b16a368e89ef4f58c1de3a}{00359}}         \textcolor{keywordflow}{return} 1.0 / self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_framerate()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00360}00360 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00361}00361     \textcolor{keyword}{def }\_get\_sensor\_shape(self) -\/> typing.Tuple[int, int]:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00362}00362         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00364}00364     \textcolor{keyword}{def }soft\_trigger(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00365}00365         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_trigger_target_mixin_a13348ed06ccceb5184881f9fc5330bbb}{trigger}}()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00366}00366 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00367}00367     \textcolor{keyword}{def }\_do\_trigger(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00368}00368         \textcolor{comment}{\# Value for set\_trigger\_software() has no meaning.  See}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00369}00369         \textcolor{comment}{\# https://github.com/python-\/microscope/vendor-\/issues/issues/3}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00370}00370         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_trigger\_software(1)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00371}00371 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00372}00372     \textcolor{keyword}{def }\_get\_binning(self) -\/> microscope.Binning:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00373}00373         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a34cd192b79f51f863e87798838327192}{\_binning}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00375}00375     \textcolor{keyword}{def }\_set\_binning(self, binning: microscope.Binning) -\/> bool:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00376}00376         \textcolor{keywordflow}{if} binning == self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a34cd192b79f51f863e87798838327192}{\_binning}}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00377}00377             \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00378}00378         \textcolor{comment}{\# We don't have a ximea camera that supports binning so we}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00379}00379         \textcolor{comment}{\# can't write support for this (a camera without this feature}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00380}00380         \textcolor{comment}{\# will raise error 100).  When writing this, careful and check}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00381}00381         \textcolor{comment}{\# what XiAPI does when mixing ROI and binning.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00382}00382         \textcolor{keywordflow}{raise} NotImplementedError()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00383}00383 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00384}00384     \textcolor{keyword}{def }\_get\_roi(self) -\/> microscope.ROI:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00385}00385         \textcolor{keyword}{assert} self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6d9d2d071d3c88fc9797aa0bb59d5187}{\_roi}} == \mbox{\hyperlink{classmicroscope_1_1_r_o_i}{microscope.ROI}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00386}00386             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_offsetX(),}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00387}00387             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_offsetY(),}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00388}00388             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_width(),}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00389}00389             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_height(),}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00390}00390         ), \textcolor{stringliteral}{"{}ROI attribute is out of sync with internal camera setting"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00391}00391         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6d9d2d071d3c88fc9797aa0bb59d5187}{\_roi}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00393}00393     \textcolor{keyword}{def }\_set\_roi(self, roi: microscope.ROI) -\/> bool:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00394}00394         \textcolor{keywordflow}{if} (}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00395}00395             roi.width + roi.left > self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}}[0]}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00396}00396             \textcolor{keywordflow}{or} roi.height + roi.top > self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}}[1]}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00397}00397         ):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00398}00398             \textcolor{keywordflow}{raise} ValueError(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00399}00399                 \textcolor{stringliteral}{"{}ROI \%s does not fit in sensor shape \%s"{}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00400}00400                 \% (roi, self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a19406d67f5eda963308d1730fac69843}{\_sensor\_shape}})}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00401}00401             )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00402}00402         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00403}00403             \textcolor{comment}{\# These methods will fail if the width/height plus their}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00404}00404             \textcolor{comment}{\# corresponding offsets are higher than the sensor size.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00405}00405             \textcolor{comment}{\# So we start by setting the offset to zero.  Cases to}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00406}00406             \textcolor{comment}{\# think off: 1) shrinking ROI size, 2) increasing ROI}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00407}00407             \textcolor{comment}{\# size, 3) resetting ROI and so can't trust self.\_roi as}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00408}00408             \textcolor{comment}{\# the current state (see this exception handling).}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00409}00409             \textcolor{keyword}{with} \_disabled\_camera(self):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00410}00410                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_offsetX(0)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00411}00411                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_offsetY(0)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00412}00412                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_width(roi.width)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00413}00413                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_height(roi.height)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00414}00414                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_offsetX(roi.left)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00415}00415                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_offsetY(roi.top)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00416}00416         \textcolor{keywordflow}{except} Exception:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00417}00417             self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_camera_a248e7c40b0047921f3ad00f845500a56}{\_set\_roi}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_add9ae4d3155c2c5f7d92237f94627448}{\_set\_roi}}(self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6d9d2d071d3c88fc9797aa0bb59d5187}{\_roi}})  \textcolor{comment}{\# set it back to whatever was before}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00418}00418             \textcolor{keywordflow}{raise}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00419}00419         self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6d9d2d071d3c88fc9797aa0bb59d5187}{\_roi}} = roi}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00420}00420         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00421}00421 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00422}00422     \textcolor{keyword}{def }\_do\_shutdown(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00423}00423         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_data_device_a6118863efe8fbacccca3ca374c554426}{\_acquiring}}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a6a8416a7b1d9f0129be94f769b4d9c77}{\_acquiring}}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00424}00424             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.stop\_acquisition()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00425}00425         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.CAM\_OPEN:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00426}00426             \textcolor{comment}{\# We check CAM\_OPEN instead of try/catch an exception}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00427}00427             \textcolor{comment}{\# because if the camera failed initialisation, XiApi fails}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00428}00428             \textcolor{comment}{\# hard with error code -\/1009 (unknown) since the internal}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00429}00429             \textcolor{comment}{\# device handler is NULL.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00430}00430             self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.close\_device()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00431}00431 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00432}00432     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00433}00433     \textcolor{keyword}{def }trigger\_mode(self) -\/> microscope.TriggerMode:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00434}00434         trg\_selector = self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_trigger\_selector()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00435}00435         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00436}00436             tmode = TrgSelectorMap[trg\_selector]}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00437}00437         \textcolor{keywordflow}{except} KeyError:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00438}00438             \textcolor{keywordflow}{raise} Exception(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00439}00439                 \textcolor{stringliteral}{"{}somehow set to unsupported trigger mode \%s"{}} \% trg\_selector}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00440}00440             )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00441}00441         \textcolor{keywordflow}{return} tmode.value}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00442}00442 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00443}00443     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00444}00444     \textcolor{keyword}{def }trigger\_type(self) -\/> microscope.TriggerType:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00445}00445         trg\_source = self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_trigger\_source()}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00446}00446         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00447}00447             ttype = TrgSourceMap[trg\_source]}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00448}00448         \textcolor{keywordflow}{except} KeyError:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00449}00449             \textcolor{keywordflow}{raise} Exception(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00450}00450                 \textcolor{stringliteral}{"{}somehow set to unsupported trigger type \%s"{}} \% trg\_source}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00451}00451             )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00452}00452         \textcolor{keywordflow}{return} ttype.value}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00453}00453 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00454}00454     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_ac25dadfc65a77eba66a5d7c042f2c4b8}{set\_trigger}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00455}\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_ac25dadfc65a77eba66a5d7c042f2c4b8}{00455}}         self, ttype: microscope.TriggerType, tmode: \mbox{\hyperlink{classmicroscope_1_1_trigger_mode}{microscope.TriggerMode}}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00456}00456     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00457}00457         \textcolor{keywordflow}{if} tmode \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} microscope.TriggerMode.ONCE:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00458}00458             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_unsupported_feature_error}{microscope.UnsupportedFeatureError}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00459}00459                 \textcolor{stringliteral}{"{}\%s not supported (only TriggerMode.ONCE)"{}} \% tmode}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00460}00460             )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00462}00462         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00463}00463             trg\_source = \mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_trg_source_map}{TrgSourceMap}}(ttype)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00464}00464         \textcolor{keywordflow}{except} ValueError:}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00465}00465             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_unsupported_feature_error}{microscope.UnsupportedFeatureError}}(}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00466}00466                 \textcolor{stringliteral}{"{}no support for trigger type \%s"{}} \% ttype}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00467}00467             )}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00468}00468 }
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00469}00469         \textcolor{keywordflow}{if} trg\_source.name != self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.get\_trigger\_source():}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00470}00470             \textcolor{comment}{\# Changing trigger source requires stopping acquisition.}}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00471}00471             \textcolor{keyword}{with} \_disabled\_camera(self):}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00472}00472                 self.\mbox{\hyperlink{classmicroscope_1_1cameras_1_1ximea_1_1_ximea_camera_a435b8d1ff38ea3c8b5dfc76497fc5045}{\_handle}}.set\_trigger\_source(trg\_source.name)}
\DoxyCodeLine{\Hypertarget{ximea_8py_source_l00473}00473 }

\end{DoxyCode}

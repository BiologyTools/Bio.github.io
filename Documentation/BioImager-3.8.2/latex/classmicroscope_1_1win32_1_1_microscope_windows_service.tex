\hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service}{}\doxysection{microscope.\+win32.\+Microscope\+Windows\+Service Class Reference}
\label{classmicroscope_1_1win32_1_1_microscope_windows_service}\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
Inheritance diagram for microscope.\+win32.\+Microscope\+Windows\+Service\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classmicroscope_1_1win32_1_1_microscope_windows_service}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classmicroscope_1_1win32_1_1_microscope_windows_service_a34873268d03f92c9c91d9c68c0c68ff1}{set\+\_\+config\+\_\+file}} (cls, path)
\item 
def \mbox{\hyperlink{classmicroscope_1_1win32_1_1_microscope_windows_service_a3f2bfae99de1e423edbde523c4ad2cec}{get\+\_\+config\+\_\+file}} (cls)
\item 
def \mbox{\hyperlink{classmicroscope_1_1win32_1_1_microscope_windows_service_afaa4fc8726bfafb4f68a2cdec354e6df}{log}} (self, message, error=False)
\item 
def \mbox{\hyperlink{classmicroscope_1_1win32_1_1_microscope_windows_service_a0022e3ce6636ca56b8894fdad263ddba}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, args)
\item 
def \mbox{\hyperlink{classmicroscope_1_1win32_1_1_microscope_windows_service_a523c6c0db766fdc2af6703466913d3ec}{Svc\+Do\+Run}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1win32_1_1_microscope_windows_service_ada1162726d6159d4bc14d76b72f2cda8}{Svc\+Stop}} (self)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classmicroscope_1_1win32_1_1_microscope_windows_service_a5a32338122e782a0660c7b7082372d13}{stop\+\_\+event}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Serves microscope devices via a Windows service.

Win32 service manipulation relies on fetching _svc_name_ without
instantiating any object, so _svc_name_ must be a class
attribute. This means that only one MicroscopeService may be
installed on any one system, and will be responsible for serving
all microscope devices on that system.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{win32_8py_source_l00055}{55}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service_a0022e3ce6636ca56b8894fdad263ddba}\label{classmicroscope_1_1win32_1_1_microscope_windows_service_a0022e3ce6636ca56b8894fdad263ddba}} 
\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def microscope.\+win32.\+Microscope\+Windows\+Service.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{args }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{win32_8py_source_l00088}{88}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00088     \textcolor{keyword}{def }\_\_init\_\_(self, args):}
\DoxyCodeLine{00089         \textcolor{comment}{\# Initialise service framework.}}
\DoxyCodeLine{00090         win32serviceutil.ServiceFramework.\_\_init\_\_(self, args)}
\DoxyCodeLine{00091         self.stop\_event = multiprocessing.Event()}
\DoxyCodeLine{00092 }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service_a3f2bfae99de1e423edbde523c4ad2cec}\label{classmicroscope_1_1win32_1_1_microscope_windows_service_a3f2bfae99de1e423edbde523c4ad2cec}} 
\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}!get\_config\_file@{get\_config\_file}}
\index{get\_config\_file@{get\_config\_file}!microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
\doxysubsubsection{\texorpdfstring{get\_config\_file()}{get\_config\_file()}}
{\footnotesize\ttfamily def microscope.\+win32.\+Microscope\+Windows\+Service.\+get\+\_\+config\+\_\+file (\begin{DoxyParamCaption}\item[{}]{cls }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{win32_8py_source_l00076}{76}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00076     \textcolor{keyword}{def }get\_config\_file(cls):}
\DoxyCodeLine{00077         \textcolor{keywordflow}{return} win32serviceutil.GetServiceCustomOption(}
\DoxyCodeLine{00078             cls.\_svc\_name\_, \textcolor{stringliteral}{"{}config"{}}}
\DoxyCodeLine{00079         )}
\DoxyCodeLine{00080 }

\end{DoxyCode}
\mbox{\Hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service_afaa4fc8726bfafb4f68a2cdec354e6df}\label{classmicroscope_1_1win32_1_1_microscope_windows_service_afaa4fc8726bfafb4f68a2cdec354e6df}} 
\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}!log@{log}}
\index{log@{log}!microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
\doxysubsubsection{\texorpdfstring{log()}{log()}}
{\footnotesize\ttfamily def microscope.\+win32.\+Microscope\+Windows\+Service.\+log (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{message,  }\item[{}]{error = {\ttfamily False} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{win32_8py_source_l00081}{81}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00081     \textcolor{keyword}{def }log(self, message, error=False):}
\DoxyCodeLine{00082         \textcolor{keywordflow}{if} error:}
\DoxyCodeLine{00083             logFunc = servicemanager.LogErrorMsg}
\DoxyCodeLine{00084         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00085             logFunc = servicemanager.LogInfoMsg}
\DoxyCodeLine{00086         logFunc(\textcolor{stringliteral}{"{}\%s: \%s"{}} \% (self.\_svc\_name\_, message))}
\DoxyCodeLine{00087 }

\end{DoxyCode}
\mbox{\Hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service_a34873268d03f92c9c91d9c68c0c68ff1}\label{classmicroscope_1_1win32_1_1_microscope_windows_service_a34873268d03f92c9c91d9c68c0c68ff1}} 
\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}!set\_config\_file@{set\_config\_file}}
\index{set\_config\_file@{set\_config\_file}!microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
\doxysubsubsection{\texorpdfstring{set\_config\_file()}{set\_config\_file()}}
{\footnotesize\ttfamily def microscope.\+win32.\+Microscope\+Windows\+Service.\+set\+\_\+config\+\_\+file (\begin{DoxyParamCaption}\item[{}]{cls,  }\item[{}]{path }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{win32_8py_source_l00070}{70}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00070     \textcolor{keyword}{def }set\_config\_file(cls, path):}
\DoxyCodeLine{00071         win32serviceutil.SetServiceCustomOption(}
\DoxyCodeLine{00072             cls.\_svc\_name\_, \textcolor{stringliteral}{"{}config"{}}, os.path.abspath(path)}
\DoxyCodeLine{00073         )}
\DoxyCodeLine{00074 }

\end{DoxyCode}
\mbox{\Hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service_a523c6c0db766fdc2af6703466913d3ec}\label{classmicroscope_1_1win32_1_1_microscope_windows_service_a523c6c0db766fdc2af6703466913d3ec}} 
\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}!SvcDoRun@{SvcDoRun}}
\index{SvcDoRun@{SvcDoRun}!microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
\doxysubsubsection{\texorpdfstring{SvcDoRun()}{SvcDoRun()}}
{\footnotesize\ttfamily def microscope.\+win32.\+Microscope\+Windows\+Service.\+Svc\+Do\+Run (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{win32_8py_source_l00093}{93}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00093     \textcolor{keyword}{def }SvcDoRun(self):}
\DoxyCodeLine{00094         configfile = win32serviceutil.GetServiceCustomOption(}
\DoxyCodeLine{00095             self.\_svc\_name\_, \textcolor{stringliteral}{"{}config"{}}}
\DoxyCodeLine{00096         )}
\DoxyCodeLine{00097         os.chdir(os.path.dirname(configfile))}
\DoxyCodeLine{00098         self.log(\textcolor{stringliteral}{"{}Using config file \%s."{}} \% configfile)}
\DoxyCodeLine{00099         self.log(\textcolor{stringliteral}{"{}Logging at \%s."{}} \% os.getcwd())}
\DoxyCodeLine{00100         self.ReportServiceStatus(win32service.SERVICE\_RUNNING)}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102         \textcolor{keyword}{from} \mbox{\hyperlink{namespacemicroscope_1_1device__server}{microscope.device\_server}} \textcolor{keyword}{import} (}
\DoxyCodeLine{00103             serve\_devices,}
\DoxyCodeLine{00104             validate\_devices,}
\DoxyCodeLine{00105             DeviceServerOptions,}
\DoxyCodeLine{00106         )}
\DoxyCodeLine{00107 }
\DoxyCodeLine{00108         options = DeviceServerOptions(}
\DoxyCodeLine{00109             config\_fpath=configfile,}
\DoxyCodeLine{00110             logging\_level=logging.INFO,}
\DoxyCodeLine{00111         )}
\DoxyCodeLine{00112 }
\DoxyCodeLine{00113         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00114             devices = validate\_devices(configfile)}
\DoxyCodeLine{00115             serve\_devices(devices, options, self.stop\_event)}
\DoxyCodeLine{00116         \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} e:}
\DoxyCodeLine{00117             servicemanager.LogErrorMsg(str(e))}
\DoxyCodeLine{00118             \textcolor{comment}{\# Exit with non-\/zero error code so Windows will attempt to restart.}}
\DoxyCodeLine{00119             sys.exit(-\/1)}
\DoxyCodeLine{00120         self.log(\textcolor{stringliteral}{"{}Service shutdown complete."{}})}
\DoxyCodeLine{00121         self.ReportServiceStatus(win32service.SERVICE\_STOPPED)}
\DoxyCodeLine{00122 }

\end{DoxyCode}
\mbox{\Hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service_ada1162726d6159d4bc14d76b72f2cda8}\label{classmicroscope_1_1win32_1_1_microscope_windows_service_ada1162726d6159d4bc14d76b72f2cda8}} 
\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}!SvcStop@{SvcStop}}
\index{SvcStop@{SvcStop}!microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
\doxysubsubsection{\texorpdfstring{SvcStop()}{SvcStop()}}
{\footnotesize\ttfamily def microscope.\+win32.\+Microscope\+Windows\+Service.\+Svc\+Stop (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{win32_8py_source_l00123}{123}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00123     \textcolor{keyword}{def }SvcStop(self):}
\DoxyCodeLine{00124         self.ReportServiceStatus(win32service.SERVICE\_STOP\_PENDING)}
\DoxyCodeLine{00125         self.stop\_event.set()}
\DoxyCodeLine{00126 }
\DoxyCodeLine{00127 }

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classmicroscope_1_1win32_1_1_microscope_windows_service_a5a32338122e782a0660c7b7082372d13}\label{classmicroscope_1_1win32_1_1_microscope_windows_service_a5a32338122e782a0660c7b7082372d13}} 
\index{microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}!stop\_event@{stop\_event}}
\index{stop\_event@{stop\_event}!microscope.win32.MicroscopeWindowsService@{microscope.win32.MicroscopeWindowsService}}
\doxysubsubsection{\texorpdfstring{stop\_event}{stop\_event}}
{\footnotesize\ttfamily microscope.\+win32.\+Microscope\+Windows\+Service.\+stop\+\_\+event}



Definition at line \mbox{\hyperlink{win32_8py_source_l00091}{91}} of file \mbox{\hyperlink{win32_8py_source}{win32.\+py}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
F\+:/repos/\+Bio\+Imager/\+Bio\+Imager/\+Python\+Microscope/microscope/win32.\+py\end{DoxyCompactItemize}

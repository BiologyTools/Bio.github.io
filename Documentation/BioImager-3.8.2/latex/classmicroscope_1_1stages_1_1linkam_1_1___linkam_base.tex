\hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base}{}\doxysection{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base Class Reference}
\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base}\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
Inheritance diagram for microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.314049cm]{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a5f1b35587bf81d7f0e8959297fdc2c12}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, $\ast$$\ast$kwargs)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a55a843127d81f73f7ec7cf20289d24e2}{\+\_\+\+\_\+del\+\_\+\+\_\+}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab66d6b40e303c1d524897ed266c73e6d}{check\+\_\+connection}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ad5f9c147e34f953334b1e576411d9dc2}{get\+\_\+data\+\_\+rate}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a5548b315826a6c2c3351fbd4d9f1c801}{get\+\_\+error}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_aa62aaa0a68a354f6b5dc24e553137cf6}{get\+\_\+id}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a4acd3c4eeea757fd435604d1e3f37d66}{get\+\_\+value}} (self, svt, result=None)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a13e2c6d3bfaa5ab34bf2fde9dbea074f}{get\+\_\+value\+\_\+limits}} (self, svt)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_accd551aed5c73fe3db6f5ee654a8ff80}{set\+\_\+value}} (self, svt, val)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ac5ee274d9d0e9f64d56dc38018e7f905}{is\+\_\+moving}} (self, axis=None)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a660678300157aa0a4963d0d05fcce5a5}{close\+\_\+comms}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab6f0e3b91ae845cd63ad4fe0c7bea70c}{open\+\_\+comms}} (self)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a2f9d9e0d26d9c8c52ae82eb3ca7dfd52}{init\+\_\+usb}} (self, uid)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a831f858fcc5ef671a84814bd152d1c69}{init\+\_\+serial}} (self, port)
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab56f7db058911151081d5255d602724d}{get\+\_\+status}} (self, $\ast$args)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_af2aac9350afe833a46ed11721493cd98}{get\+\_\+sdk\+\_\+version}} ()
\item 
def \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_aa82c0ed4bb1ad7093652d8f0194fc8cc}{init\+\_\+sdk}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Base class for connecting to Linkam SDK devices.

This class deals with SDK initialisation and setting callbacks to
handle SDK events. It maintains a map of SDK handle to device instance
so that SDK events result in updates to the correct instance.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l00946}{946}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a5f1b35587bf81d7f0e8959297fdc2c12}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a5f1b35587bf81d7f0e8959297fdc2c12}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{$\ast$$\ast$}]{kwargs }\end{DoxyParamCaption})}

\begin{DoxyVerb}Initalise the device and, if necessary, the SDK.\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classmicroscope_1_1abc_1_1_floating_device_mixin}{microscope.\+abc.\+Floating\+Device\+Mixin}}.



Reimplemented in \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1_linkam_c_m_s_af7575373fa50d5ba2d93821b09605d92}{microscope.\+stages.\+linkam.\+Linkam\+CMS}}.



Definition at line \mbox{\hyperlink{linkam_8py_source_l01072}{1072}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01072     \textcolor{keyword}{def }\_\_init\_\_(self, **kwargs):}
\DoxyCodeLine{01073         \textcolor{stringliteral}{"{}"{}"{}Initalise the device and, if necessary, the SDK."{}"{}"{}}}
\DoxyCodeLine{01074         \textcolor{comment}{\# Connection handle, info struct and status struct.}}
\DoxyCodeLine{01075         super().\_\_init\_\_(**kwargs)}
\DoxyCodeLine{01076         self.\_commsinfo = \_CommsInfo()}
\DoxyCodeLine{01077         self.\_h = \_CommsHandle()}
\DoxyCodeLine{01078         self.\_connectionstatus = \_ConnectionStatus()}
\DoxyCodeLine{01079         self.\_stageconfig = \_StageConfig()}
\DoxyCodeLine{01080         \textcolor{comment}{\# Stage status struct, updated by the NewValue callback.}}
\DoxyCodeLine{01081         self.\_status = \_ControllerStatus()}
\DoxyCodeLine{01082         \textcolor{keywordflow}{if} \_\_class\_\_.\_lib \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{01083             \textcolor{keywordflow}{try}:}
\DoxyCodeLine{01084                 self.init\_sdk()}
\DoxyCodeLine{01085             \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} e:}
\DoxyCodeLine{01086                 \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_library_load_error}{microscope.LibraryLoadError}}(e) \textcolor{keyword}{from} e}
\DoxyCodeLine{01087         self.\_reconnect\_thread = \textcolor{keywordtype}{None}}
\DoxyCodeLine{01088 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01072}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+\+\_\+init\+\_\+\+\_\+()}}, \mbox{\hyperlink{linkam_8py_source_l01076}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+commsinfo}}, \mbox{\hyperlink{linkam_8py_source_l01078}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+connectionstatus}}, \mbox{\hyperlink{linkam_8py_source_l01077}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+h}}, \mbox{\hyperlink{linkam_8py_source_l01087}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+reconnect\+\_\+thread}}, \mbox{\hyperlink{linkam_8py_source_l01079}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+stageconfig}}, \mbox{\hyperlink{mirror_2mirao52e_8py_source_l00074}{microscope.\+mirror.\+mirao52e.\+Mirao52e.\+\_\+status}}, \mbox{\hyperlink{linkam_8py_source_l01081}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+status}}, and \mbox{\hyperlink{linkam_8py_source_l00972}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+init\+\_\+sdk()}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01072}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+\+\_\+init\+\_\+\+\_\+()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a55a843127d81f73f7ec7cf20289d24e2}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a55a843127d81f73f7ec7cf20289d24e2}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!\_\_del\_\_@{\_\_del\_\_}}
\index{\_\_del\_\_@{\_\_del\_\_}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{\_\_del\_\_()}{\_\_del\_\_()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+\+\_\+del\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Close comms on object deletion\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classmicroscope_1_1abc_1_1_device}{microscope.\+abc.\+Device}}.



Definition at line \mbox{\hyperlink{linkam_8py_source_l01092}{1092}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01092     \textcolor{keyword}{def }\_\_del\_\_(self):}
\DoxyCodeLine{01093         \textcolor{stringliteral}{"{}"{}"{}Close comms on object deletion"{}"{}"{}}}
\DoxyCodeLine{01094         self.\_process\_msg(Msg.CloseComms)}
\DoxyCodeLine{01095 }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab66d6b40e303c1d524897ed266c73e6d}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab66d6b40e303c1d524897ed266c73e6d}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!check\_connection@{check\_connection}}
\index{check\_connection@{check\_connection}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{check\_connection()}{check\_connection()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+check\+\_\+connection (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Raise an exception if the connection is down.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01112}{1112}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01112     \textcolor{keyword}{def }check\_connection(self):}
\DoxyCodeLine{01113         \textcolor{stringliteral}{"{}"{}"{}Raise an exception if the connection is down."{}"{}"{}}}
\DoxyCodeLine{01114         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.\_connectionstatus.flags.connected:}
\DoxyCodeLine{01115             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_device_error}{microscope.DeviceError}}(\textcolor{stringliteral}{"{}Stage not connected."{}})}
\DoxyCodeLine{01116 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01078}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+connectionstatus}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01166}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+set\+\_\+value()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a660678300157aa0a4963d0d05fcce5a5}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a660678300157aa0a4963d0d05fcce5a5}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!close\_comms@{close\_comms}}
\index{close\_comms@{close\_comms}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{close\_comms()}{close\_comms()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+close\+\_\+comms (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Close the comms link\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01196}{1196}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01196     \textcolor{keyword}{def }close\_comms(self):}
\DoxyCodeLine{01197         \textcolor{stringliteral}{"{}"{}"{}Close the comms link"{}"{}"{}}}
\DoxyCodeLine{01198         self.\_process\_msg(Msg.CloseComms, result=self.\_connectionstatus)}
\DoxyCodeLine{01199 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01078}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+connectionstatus}}, and \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01200}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+open\+\_\+comms()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ad5f9c147e34f953334b1e576411d9dc2}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ad5f9c147e34f953334b1e576411d9dc2}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!get\_data\_rate@{get\_data\_rate}}
\index{get\_data\_rate@{get\_data\_rate}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{get\_data\_rate()}{get\_data\_rate()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+data\+\_\+rate (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the status update period in seconds.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01117}{1117}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01117     \textcolor{keyword}{def }get\_data\_rate(self):}
\DoxyCodeLine{01118         \textcolor{stringliteral}{"{}"{}"{}Return the status update period in seconds."{}"{}"{}}}
\DoxyCodeLine{01119         \textcolor{keywordflow}{return} self.\_process\_msg(Msg.GetDataRate).vUint32 / 1000}
\DoxyCodeLine{01120 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01338}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+MDSMixin.\+move\+\_\+to()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a5548b315826a6c2c3351fbd4d9f1c801}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a5548b315826a6c2c3351fbd4d9f1c801}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!get\_error@{get\_error}}
\index{get\_error@{get\_error}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{get\_error()}{get\_error()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+error (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Fetch the controller error.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01121}{1121}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01121     \textcolor{keyword}{def }get\_error(self):}
\DoxyCodeLine{01122         \textcolor{stringliteral}{"{}"{}"{}Fetch the controller error."{}"{}"{}}}
\DoxyCodeLine{01123         \textcolor{keywordflow}{return} self.\_process\_msg(Msg.GetControllerError).vControllerError}
\DoxyCodeLine{01124 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_aa62aaa0a68a354f6b5dc24e553137cf6}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_aa62aaa0a68a354f6b5dc24e553137cf6}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!get\_id@{get\_id}}
\index{get\_id@{get\_id}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{get\_id()}{get\_id()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+id (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Fetch the device's serial number\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classmicroscope_1_1abc_1_1_floating_device_mixin_a03520e043c352c83536d735f641d285e}{microscope.\+abc.\+Floating\+Device\+Mixin}}.



Definition at line \mbox{\hyperlink{linkam_8py_source_l01125}{1125}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01125     \textcolor{keyword}{def }get\_id(self):}
\DoxyCodeLine{01126         \textcolor{stringliteral}{"{}"{}"{}Fetch the device's serial number"{}"{}"{}}}
\DoxyCodeLine{01127 \textcolor{stringliteral}{        buf = ctypes.create\_string\_buffer(18)}}
\DoxyCodeLine{01128 \textcolor{stringliteral}{        self.\_process\_msg(Msg.GetControllerSerial, byref(buf), 18)}}
\DoxyCodeLine{01129 \textcolor{stringliteral}{        }\textcolor{comment}{\# Decode from bytes to string and strip trailing spaces.}}
\DoxyCodeLine{01130         \textcolor{keywordflow}{return} buf.value.decode().rstrip()}
\DoxyCodeLine{01131 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}.



Referenced by \mbox{\hyperlink{atmcd_8py_source_l01442}{microscope.\+cameras.\+atmcd.\+Andor\+Atmcd.\+initialize()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_af2aac9350afe833a46ed11721493cd98}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_af2aac9350afe833a46ed11721493cd98}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!get\_sdk\_version@{get\_sdk\_version}}
\index{get\_sdk\_version@{get\_sdk\_version}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{get\_sdk\_version()}{get\_sdk\_version()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+sdk\+\_\+version (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Fetch the SDK version.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l00965}{965}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00965     \textcolor{keyword}{def }get\_sdk\_version():}
\DoxyCodeLine{00966         \textcolor{stringliteral}{"{}"{}"{}Fetch the SDK version."{}"{}"{}}}
\DoxyCodeLine{00967         b = ctypes.create\_string\_buffer(\_max\_version\_length)}
\DoxyCodeLine{00968         \_\_class\_\_.\_lib.linkamGetVersion(b, \_max\_version\_length)}
\DoxyCodeLine{00969         \textcolor{keywordflow}{return} b.value}
\DoxyCodeLine{00970 }

\end{DoxyCode}
\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab56f7db058911151081d5255d602724d}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab56f7db058911151081d5255d602724d}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!get\_status@{get\_status}}
\index{get\_status@{get\_status}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{get\_status()}{get\_status()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+status (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{$\ast$}]{args }\end{DoxyParamCaption})}

\begin{DoxyVerb}Called by a client to fetch status in a dict.

Derived classes and mixins should implement this to add their own status.

status = super().get_status(*args, status_structure, ...) in derived classes.
# then add any other values with
status[key] = ...
\end{DoxyVerb}
 

Reimplemented in \mbox{\hyperlink{classmicroscope_1_1stages_1_1linkam_1_1_linkam_c_m_s_ad5aa9a0f8fc607890ba67b51dcaea2d1}{microscope.\+stages.\+linkam.\+Linkam\+CMS}}.



Definition at line \mbox{\hyperlink{linkam_8py_source_l01267}{1267}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01267     \textcolor{keyword}{def }get\_status(self, *args):}
\DoxyCodeLine{01268         \textcolor{stringliteral}{"{}"{}"{}Called by a client to fetch status in a dict.}}
\DoxyCodeLine{01269 \textcolor{stringliteral}{}}
\DoxyCodeLine{01270 \textcolor{stringliteral}{        Derived classes }\textcolor{keywordflow}{and} mixins should implement this to add their own status.}
\DoxyCodeLine{01271 }
\DoxyCodeLine{01272         status = super().get\_status(*args, status\_structure, ...) \textcolor{keywordflow}{in} derived classes.}
\DoxyCodeLine{01273         \textcolor{comment}{\# then add any other values with}}
\DoxyCodeLine{01274         status[key] = ...}
\DoxyCodeLine{01275         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{01276 \textcolor{stringliteral}{        structs = args + (self.\_status, self.\_connectionstatus)}}
\DoxyCodeLine{01277 \textcolor{stringliteral}{        status = \{\}}}
\DoxyCodeLine{01278 \textcolor{stringliteral}{        }\textcolor{keywordflow}{for} s \textcolor{keywordflow}{in} structs:}
\DoxyCodeLine{01279             names = filter(}
\DoxyCodeLine{01280                 \textcolor{keyword}{lambda} n: \textcolor{keywordflow}{not} n.startswith(\textcolor{stringliteral}{"{}unused"{}}),}
\DoxyCodeLine{01281                 (f[0] \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} s.flags.\_fields\_),}
\DoxyCodeLine{01282             )}
\DoxyCodeLine{01283             status.update(}
\DoxyCodeLine{01284                 dict(map(\textcolor{keyword}{lambda} n: (n, bool(getattr(s.flags, n))), names))}
\DoxyCodeLine{01285             )}
\DoxyCodeLine{01286         \textcolor{keywordflow}{return} status}
\DoxyCodeLine{01287 }
\DoxyCodeLine{01288 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01078}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+connectionstatus}}, \mbox{\hyperlink{mirror_2mirao52e_8py_source_l00074}{microscope.\+mirror.\+mirao52e.\+Mirao52e.\+\_\+status}}, \mbox{\hyperlink{linkam_8py_source_l01081}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+status}}, and \mbox{\hyperlink{linkam_8py_source_l01267}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+status()}}.



Referenced by \mbox{\hyperlink{lights_2obis_8py_source_l00094}{microscope.\+lights.\+obis.\+Obis\+Laser.\+get\+\_\+status()}}, \mbox{\hyperlink{linkam_8py_source_l01267}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+status()}}, \mbox{\hyperlink{lights_2cobolt_8py_source_l00110}{microscope.\+lights.\+cobolt.\+Cobolt\+Laser.\+initialize()}}, \mbox{\hyperlink{lights_2obis_8py_source_l00141}{microscope.\+lights.\+obis.\+Obis\+Laser.\+initialize()}}, \mbox{\hyperlink{lights_2sapphire_8py_source_l00148}{microscope.\+lights.\+sapphire.\+Sapphire\+Laser.\+initialize()}}, \mbox{\hyperlink{lights_2cobolt_8py_source_l00069}{microscope.\+lights.\+cobolt.\+Cobolt\+Laser.\+send()}}, and \mbox{\hyperlink{lights_2sapphire_8py_source_l00093}{microscope.\+lights.\+sapphire.\+Sapphire\+Laser.\+send()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a4acd3c4eeea757fd435604d1e3f37d66}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a4acd3c4eeea757fd435604d1e3f37d66}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!get\_value@{get\_value}}
\index{get\_value@{get\_value}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{get\_value()}{get\_value()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+value (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{svt,  }\item[{}]{result = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Fetch a value from the device.

Args:
    svt: a StageValueType
    result: an existing Variant to use to return a result, or None.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01132}{1132}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01132     \textcolor{keyword}{def }get\_value(self, svt, result=None):}
\DoxyCodeLine{01133         \textcolor{stringliteral}{"{}"{}"{}Fetch a value from the device.}}
\DoxyCodeLine{01134 \textcolor{stringliteral}{}}
\DoxyCodeLine{01135 \textcolor{stringliteral}{        Args:}}
\DoxyCodeLine{01136 \textcolor{stringliteral}{            svt: a StageValueType}}
\DoxyCodeLine{01137 \textcolor{stringliteral}{            result: an existing Variant to use to }\textcolor{keywordflow}{return} a result, \textcolor{keywordflow}{or} \textcolor{keywordtype}{None}.}
\DoxyCodeLine{01138         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{01139 \textcolor{stringliteral}{        }\textcolor{comment}{\# Don't self.check\_connection on read as it can cause get\_status to throw exception.}}
\DoxyCodeLine{01140         \textcolor{comment}{\# Ensure svt is an Enum member (not a raw value), as it is used as a key.}}
\DoxyCodeLine{01141         \textcolor{keywordflow}{if} isinstance(svt, str):}
\DoxyCodeLine{01142             \textcolor{comment}{\# Allow access using parameter names -\/ useful for Pyro.}}
\DoxyCodeLine{01143             svt = getattr(\_StageValueType, svt)}
\DoxyCodeLine{01144         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01145             svt = \_StageValueType(svt)}
\DoxyCodeLine{01146         \textcolor{comment}{\# Determine the appropriate Variant member for the value type.}}
\DoxyCodeLine{01147         vtype = \_StageValueTypeToVariant.get(svt, \textcolor{stringliteral}{"{}vFloat32"{}})}
\DoxyCodeLine{01148         variant = self.\_process\_msg(Msg.GetValue, svt.value, result=result)}
\DoxyCodeLine{01149         \textcolor{keywordflow}{if} result \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{01150             \textcolor{keywordflow}{return} result}
\DoxyCodeLine{01151         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01152             \textcolor{keywordflow}{return} getattr(variant, vtype)}
\DoxyCodeLine{01153 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01419}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+\_\+\+\_\+init\+\_\+\+\_\+()}}, \mbox{\hyperlink{linkam_8py_source_l01471}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+get\+\_\+light()}}, \mbox{\hyperlink{linkam_8py_source_l01494}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+get\+\_\+motors()}}, \mbox{\hyperlink{linkam_8py_source_l01359}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+MDSMixin.\+get\+\_\+position()}}, \mbox{\hyperlink{linkam_8py_source_l01483}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+set\+\_\+condensor\+\_\+level()}}, and \mbox{\hyperlink{linkam_8py_source_l01461}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+temperatures()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a13e2c6d3bfaa5ab34bf2fde9dbea074f}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a13e2c6d3bfaa5ab34bf2fde9dbea074f}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!get\_value\_limits@{get\_value\_limits}}
\index{get\_value\_limits@{get\_value\_limits}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{get\_value\_limits()}{get\_value\_limits()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+get\+\_\+value\+\_\+limits (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{svt }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns the bounds for a StageValueType\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01154}{1154}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01154     \textcolor{keyword}{def }get\_value\_limits(self, svt):}
\DoxyCodeLine{01155         \textcolor{stringliteral}{"{}"{}"{}Returns the bounds for a StageValueType"{}"{}"{}}}
\DoxyCodeLine{01156         \textcolor{keywordflow}{if} isinstance(svt, str):}
\DoxyCodeLine{01157             \textcolor{comment}{\# Allow access using parameter names -\/ useful for Pyro.}}
\DoxyCodeLine{01158             svt = getattr(\_StageValueType, svt)}
\DoxyCodeLine{01159         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01160             svt = \_StageValueType(svt)}
\DoxyCodeLine{01161         vtype = \_StageValueTypeToVariant.get(svt, \textcolor{stringliteral}{"{}vFloat32"{}})}
\DoxyCodeLine{01162         vmin = self.\_process\_msg(Msg.GetMinValue, svt.value)}
\DoxyCodeLine{01163         vmax = self.\_process\_msg(Msg.GetMaxValue, svt.value)}
\DoxyCodeLine{01164         \textcolor{keywordflow}{return} tuple(getattr(v, vtype) \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} (vmin, vmax))}
\DoxyCodeLine{01165 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_aa82c0ed4bb1ad7093652d8f0194fc8cc}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_aa82c0ed4bb1ad7093652d8f0194fc8cc}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!init\_sdk@{init\_sdk}}
\index{init\_sdk@{init\_sdk}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{init\_sdk()}{init\_sdk()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+init\+\_\+sdk (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Initialise the SDK and set up event callbacks\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l00972}{972}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00972     \textcolor{keyword}{def }init\_sdk():}
\DoxyCodeLine{00973         \textcolor{stringliteral}{"{}"{}"{}Initialise the SDK and set up event callbacks"{}"{}"{}}}
\DoxyCodeLine{00974         \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00975             \_\_class\_\_.\_lib = ctypes.WinDLL(\textcolor{stringliteral}{"{}LinkamSDK.dll"{}})}
\DoxyCodeLine{00976         \textcolor{keywordflow}{except}:}
\DoxyCodeLine{00977             \textcolor{comment}{\# Not tested}}
\DoxyCodeLine{00978             \_\_class\_\_.\_lib = ctypes.CDLL(\textcolor{stringliteral}{"{}libLinkamSDK.so"{}})}
\DoxyCodeLine{00979         \_lib = \_\_class\_\_.\_lib}
\DoxyCodeLine{00980         \textcolor{stringliteral}{"{}"{}"{}Initialise the SDK, and create and set the callbacks."{}"{}"{}}}
\DoxyCodeLine{00981         \textcolor{comment}{\# Omit conditional pending a fix for ctypes issues when optimisations in use.}}
\DoxyCodeLine{00982         \textcolor{comment}{\# if \_\_debug\_\_:}}
\DoxyCodeLine{00983         \textcolor{comment}{\#    sdk\_log = b''}}
\DoxyCodeLine{00984         \textcolor{comment}{\# else:}}
\DoxyCodeLine{00985 }
\DoxyCodeLine{00986         sdk\_log = os.devnull}
\DoxyCodeLine{00987         lpaths = [}
\DoxyCodeLine{00988             os.path.dirname(microscope.abc.\_\_file\_\_),}
\DoxyCodeLine{00989             os.path.dirname(\_\_file\_\_),}
\DoxyCodeLine{00990             \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00991         ]}
\DoxyCodeLine{00992         \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} lpaths:}
\DoxyCodeLine{00993             lskpath = os.path.join(p, \textcolor{stringliteral}{"{}Linkam.lsk"{}})}
\DoxyCodeLine{00994             \textcolor{keywordflow}{if} \_lib.linkamInitialiseSDK(sdk\_log, lskpath.encode(), \textcolor{keyword}{True}) == 1:}
\DoxyCodeLine{00995                 \textcolor{keywordflow}{break}}
\DoxyCodeLine{00996         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00997             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_library_load_error}{microscope.LibraryLoadError}}(}
\DoxyCodeLine{00998                 \textcolor{stringliteral}{"{}No linkam license file (Linkam.lsk) found in \%s."{}} \% lpaths}
\DoxyCodeLine{00999             )}
\DoxyCodeLine{01000 }
\DoxyCodeLine{01001         \textcolor{comment}{\# NewValue event callback}}
\DoxyCodeLine{01002         cfunc = ctypes.CFUNCTYPE(\_uint32\_t, \_CommsHandle, \_ControllerStatus)(}
\DoxyCodeLine{01003             \_\_class\_\_.\_on\_new\_value}
\DoxyCodeLine{01004         )}
\DoxyCodeLine{01005         \_lib.linkamSetCallbackNewValue(cfunc)}
\DoxyCodeLine{01006         \_\_class\_\_.\_callbacks[\_\_class\_\_.\_on\_new\_value] = cfunc}
\DoxyCodeLine{01007         \textcolor{comment}{\# Connection event callback}}
\DoxyCodeLine{01008         cfunc = ctypes.CFUNCTYPE(\textcolor{keywordtype}{None}, \_CommsHandle)(\_\_class\_\_.\_on\_connect)}
\DoxyCodeLine{01009         \_lib.linkamSetCallbackControllerConnected(cfunc)}
\DoxyCodeLine{01010         \_\_class\_\_.\_callbacks[\_\_class\_\_.\_on\_connect] = cfunc}
\DoxyCodeLine{01011         \textcolor{comment}{\# Disconnection event callback}}
\DoxyCodeLine{01012         cfunc = ctypes.CFUNCTYPE(\textcolor{keywordtype}{None}, \_CommsHandle)(\_\_class\_\_.\_on\_disconnect)}
\DoxyCodeLine{01013         \_lib.linkamSetCallbackControllerDisconnected(cfunc)}
\DoxyCodeLine{01014         \_\_class\_\_.\_callbacks[\_\_class\_\_.\_on\_disconnect] = cfunc}
\DoxyCodeLine{01015         \textcolor{comment}{\# Error event callback}}
\DoxyCodeLine{01016         cfunc = ctypes.CFUNCTYPE(\textcolor{keywordtype}{None}, \_CommsHandle, \_uint32\_t)(}
\DoxyCodeLine{01017             \_\_class\_\_.\_on\_error}
\DoxyCodeLine{01018         )}
\DoxyCodeLine{01019         \_lib.linkamSetCallbackError(cfunc)}
\DoxyCodeLine{01020         \_\_class\_\_.\_callbacks[\_\_class\_\_.\_on\_error] = cfunc}
\DoxyCodeLine{01021 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l00960}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+connection\+Map}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01072}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+\+\_\+init\+\_\+\+\_\+()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a831f858fcc5ef671a84814bd152d1c69}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a831f858fcc5ef671a84814bd152d1c69}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!init\_serial@{init\_serial}}
\index{init\_serial@{init\_serial}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{init\_serial()}{init\_serial()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+init\+\_\+serial (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{port }\end{DoxyParamCaption})}

\begin{DoxyVerb}Populate commsinfo struct with default SerialCommsInfo for given port\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01263}{1263}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01263     \textcolor{keyword}{def }init\_serial(self, port):}
\DoxyCodeLine{01264         \textcolor{stringliteral}{"{}"{}"{}Populate commsinfo struct with default SerialCommsInfo for given port"{}"{}"{}}}
\DoxyCodeLine{01265         self.\_lib.linkamInitialiseSerialCommsInfo(byref(self.\_commsinfo), port)}
\DoxyCodeLine{01266 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01076}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+commsinfo}}, and \mbox{\hyperlink{linkam_8py_source_l00957}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+lib}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a2f9d9e0d26d9c8c52ae82eb3ca7dfd52}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_a2f9d9e0d26d9c8c52ae82eb3ca7dfd52}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!init\_usb@{init\_usb}}
\index{init\_usb@{init\_usb}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{init\_usb()}{init\_usb()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+init\+\_\+usb (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{uid }\end{DoxyParamCaption})}

\begin{DoxyVerb}Populate commsinfo struct with default USBCommsInfo\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01249}{1249}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01249     \textcolor{keyword}{def }init\_usb(self, uid):}
\DoxyCodeLine{01250         \textcolor{stringliteral}{"{}"{}"{}Populate commsinfo struct with default USBCommsInfo"{}"{}"{}}}
\DoxyCodeLine{01251         \textcolor{comment}{\# The uid is used to set serialNumber on the info object. The docs}}
\DoxyCodeLine{01252         \textcolor{comment}{\# suggest that an OpenComms message should open a connection to the}}
\DoxyCodeLine{01253         \textcolor{comment}{\# device with that serial number; with only one stage attached, it}}
\DoxyCodeLine{01254         \textcolor{comment}{\# appears that OpenComms ignores the value of serialNumber.}}
\DoxyCodeLine{01255         \textcolor{keywordflow}{if} uid \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{01256             uid = b\textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{01257         \textcolor{keywordflow}{elif} \textcolor{keywordflow}{not} isinstance(uid, bytes):}
\DoxyCodeLine{01258             uid = uid.encode()}
\DoxyCodeLine{01259         self.\_lib.linkamInitialiseUSBCommsInfo(}
\DoxyCodeLine{01260             byref(self.\_commsinfo), ctypes.c\_char\_p(uid)}
\DoxyCodeLine{01261         )}
\DoxyCodeLine{01262 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01076}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+commsinfo}}, and \mbox{\hyperlink{linkam_8py_source_l00957}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+lib}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01419}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+\_\+\+\_\+init\+\_\+\+\_\+()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ac5ee274d9d0e9f64d56dc38018e7f905}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ac5ee274d9d0e9f64d56dc38018e7f905}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!is\_moving@{is\_moving}}
\index{is\_moving@{is\_moving}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{is\_moving()}{is\_moving()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+is\+\_\+moving (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{axis = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns True if the stage is moving, False if stopped

This method isn't on the LinkamMDSMixin because the StageStatus motor
stopped flags appear to be more reliable than the MDSStatus MoveDone
flags.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01179}{1179}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01179     \textcolor{keyword}{def }is\_moving(self, axis=None):}
\DoxyCodeLine{01180         \textcolor{stringliteral}{"{}"{}"{}Returns True if the stage is moving, False if stopped}}
\DoxyCodeLine{01181 \textcolor{stringliteral}{}}
\DoxyCodeLine{01182 \textcolor{stringliteral}{        This method isn't on the LinkamMDSMixin because the StageStatus motor}}
\DoxyCodeLine{01183 \textcolor{stringliteral}{        stopped flags appear to be more reliable than the MDSStatus MoveDone}}
\DoxyCodeLine{01184 \textcolor{stringliteral}{        flags."{}"{}"{}}}
\DoxyCodeLine{01185 \textcolor{stringliteral}{        }\textcolor{keywordflow}{if} axis \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} axis.upper() \textcolor{keywordflow}{in} \textcolor{stringliteral}{"{}XYZ"{}}:}
\DoxyCodeLine{01186             has\_motor = getattr(}
\DoxyCodeLine{01187                 self.\_stageconfig.flags, \textcolor{stringliteral}{"{}motor"{}} + axis.upper()}
\DoxyCodeLine{01188             )}
\DoxyCodeLine{01189             stopped = getattr(}
\DoxyCodeLine{01190                 self.\_status.flags, \textcolor{stringliteral}{"{}motorStopped"{}} + axis.upper()}
\DoxyCodeLine{01191             )}
\DoxyCodeLine{01192             \textcolor{keywordflow}{return} has\_motor \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} stopped}
\DoxyCodeLine{01193         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01194             \textcolor{keywordflow}{return} any(self.is\_moving(ax) \textcolor{keywordflow}{for} ax \textcolor{keywordflow}{in} \textcolor{stringliteral}{"{}XYZ"{}})}
\DoxyCodeLine{01195 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01079}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+stageconfig}}, \mbox{\hyperlink{mirror_2mirao52e_8py_source_l00074}{microscope.\+mirror.\+mirao52e.\+Mirao52e.\+\_\+status}}, \mbox{\hyperlink{linkam_8py_source_l01081}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+status}}, and \mbox{\hyperlink{linkam_8py_source_l01179}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+is\+\_\+moving()}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01179}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+is\+\_\+moving()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab6f0e3b91ae845cd63ad4fe0c7bea70c}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_ab6f0e3b91ae845cd63ad4fe0c7bea70c}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!open\_comms@{open\_comms}}
\index{open\_comms@{open\_comms}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{open\_comms()}{open\_comms()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+open\+\_\+comms (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Open the comms link and store the comms handle.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01200}{1200}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01200     \textcolor{keyword}{def }open\_comms(self):}
\DoxyCodeLine{01201         \textcolor{stringliteral}{"{}"{}"{}Open the comms link and store the comms handle."{}"{}"{}}}
\DoxyCodeLine{01202         self.\_process\_msg(}
\DoxyCodeLine{01203             Msg.OpenComms,}
\DoxyCodeLine{01204             byref(self.\_commsinfo),}
\DoxyCodeLine{01205             byref(self.\_h),}
\DoxyCodeLine{01206             result=self.\_connectionstatus,}
\DoxyCodeLine{01207         )}
\DoxyCodeLine{01208         \textcolor{keywordflow}{if} self.\_h.value != 0:}
\DoxyCodeLine{01209             \_\_class\_\_.\_connectionMap[self.\_h.value] = self}
\DoxyCodeLine{01210             self.\_process\_msg(Msg.GetStageConfig, result=self.\_stageconfig)}
\DoxyCodeLine{01211         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01212             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_initialise_error}{microscope.InitialiseError}}(\textcolor{stringliteral}{"{}Could not connect to stage."{}})}
\DoxyCodeLine{01213 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01076}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+commsinfo}}, \mbox{\hyperlink{linkam_8py_source_l01078}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+connectionstatus}}, \mbox{\hyperlink{linkam_8py_source_l01077}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+h}}, \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}, \mbox{\hyperlink{linkam_8py_source_l01087}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+reconnect\+\_\+thread}}, \mbox{\hyperlink{linkam_8py_source_l01233}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+reopen\+\_\+loop()}}, \mbox{\hyperlink{linkam_8py_source_l01079}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+stageconfig}}, \mbox{\hyperlink{mirror_2mirao52e_8py_source_l00074}{microscope.\+mirror.\+mirao52e.\+Mirao52e.\+\_\+status}}, \mbox{\hyperlink{linkam_8py_source_l01081}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+status}}, \mbox{\hyperlink{linkam_8py_source_l01196}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+close\+\_\+comms()}}, and \mbox{\hyperlink{linkam_8py_source_l01200}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+open\+\_\+comms()}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01419}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+\_\+\+\_\+init\+\_\+\+\_\+()}}, and \mbox{\hyperlink{linkam_8py_source_l01200}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+open\+\_\+comms()}}.

\mbox{\Hypertarget{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_accd551aed5c73fe3db6f5ee654a8ff80}\label{classmicroscope_1_1stages_1_1linkam_1_1___linkam_base_accd551aed5c73fe3db6f5ee654a8ff80}} 
\index{microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}!set\_value@{set\_value}}
\index{set\_value@{set\_value}!microscope.stages.linkam.\_LinkamBase@{microscope.stages.linkam.\_LinkamBase}}
\doxysubsubsection{\texorpdfstring{set\_value()}{set\_value()}}
{\footnotesize\ttfamily def microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+set\+\_\+value (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{svt,  }\item[{}]{val }\end{DoxyParamCaption})}

\begin{DoxyVerb}Set value identified by svt to val\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{linkam_8py_source_l01166}{1166}} of file \mbox{\hyperlink{linkam_8py_source}{linkam.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{01166     \textcolor{keyword}{def }set\_value(self, svt, val):}
\DoxyCodeLine{01167         \textcolor{stringliteral}{"{}"{}"{}Set value identified by svt to val"{}"{}"{}}}
\DoxyCodeLine{01168         self.check\_connection()}
\DoxyCodeLine{01169         \textcolor{keywordflow}{if} isinstance(svt, str):}
\DoxyCodeLine{01170             \textcolor{comment}{\# Allow access using parameter names -\/ useful for Pyro.}}
\DoxyCodeLine{01171             svt = getattr(\_StageValueType, svt)}
\DoxyCodeLine{01172         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{01173             svt = \_StageValueType(svt)}
\DoxyCodeLine{01174         vtype = \_StageValueTypeToVariant.get(svt, \textcolor{stringliteral}{"{}vFloat32"{}})}
\DoxyCodeLine{01175         \textcolor{keywordflow}{return} self.\_process\_msg(}
\DoxyCodeLine{01176             Msg.SetValue, \_StageValueType(svt).value, \_Variant(**\{vtype: val\})}
\DoxyCodeLine{01177         ).vBoolean}
\DoxyCodeLine{01178 }

\end{DoxyCode}


References \mbox{\hyperlink{linkam_8py_source_l01102}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+\_\+process\+\_\+msg()}}, and \mbox{\hyperlink{linkam_8py_source_l01112}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+Base.\+check\+\_\+connection()}}.



Referenced by \mbox{\hyperlink{linkam_8py_source_l01338}{microscope.\+stages.\+linkam.\+\_\+\+Linkam\+MDSMixin.\+move\+\_\+to()}}, \mbox{\hyperlink{linkam_8py_source_l01516}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+refill\+\_\+chamber()}}, \mbox{\hyperlink{linkam_8py_source_l01512}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+refill\+\_\+dewar()}}, \mbox{\hyperlink{linkam_8py_source_l01475}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+set\+\_\+condensor()}}, and \mbox{\hyperlink{linkam_8py_source_l01467}{microscope.\+stages.\+linkam.\+Linkam\+CMS.\+set\+\_\+light()}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
F\+:/repos/\+Bio\+Imager/\+Bio\+Imager/\+Python\+Microscope/microscope/stages/linkam.\+py\end{DoxyCompactItemize}

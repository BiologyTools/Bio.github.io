\hypertarget{_win32_8cs_source}{}\doxysection{Win32.\+cs}
\label{_win32_8cs_source}\index{F:/repos/BioImager/BioImager/Source/Win32.cs@{F:/repos/BioImager/BioImager/Source/Win32.cs}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00001}00001 \textcolor{keyword}{using }System;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00002}00002 \textcolor{keyword}{using }System.Collections.Generic;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00003}00003 \textcolor{keyword}{using }System.Linq;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00004}00004 \textcolor{keyword}{using }System.Runtime.InteropServices;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00005}00005 \textcolor{keyword}{using }System.Text;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00006}00006 \textcolor{keyword}{using }System.Threading.Tasks;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00007}00007 \textcolor{keyword}{using }System.Diagnostics;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00009}00009 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_bio_imager}{BioImager}}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00010}00010 \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00011}\mbox{\hyperlink{class_bio_imager_1_1_win32}{00011}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_win32}{Win32}}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00012}00012     \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00013}00013         [DllImport(\textcolor{stringliteral}{"{}User32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00014}00014         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{short} GetAsyncKeyState(System.Windows.Forms.Keys vKey);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00015}00015         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} WM\_KEYDOWN = 0x100;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00016}00016         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} WM\_KEYUP = 0x101;\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00017}00017 \textcolor{comment}{        /// It returns true if the key is pressed, and false if it isn't}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00018}00018 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00019}00019 \textcolor{comment}{        /// @param vKey The key you want to check.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00020}00020 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00021}00021 \textcolor{comment}{        /// @return The return value is a short integer with the high order bit set if the key is down}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00022}00022 \textcolor{comment}{        /// and the low order bit set if the key was pressed after the previous call to}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00023}00023 \textcolor{comment}{        /// GetAsyncKeyState.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00024}\mbox{\hyperlink{class_bio_imager_1_1_win32_a2182c75d53a6286ff15adf45f8bddec5}{00024}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_bio_imager_1_1_win32_a2182c75d53a6286ff15adf45f8bddec5}{GetKeyState}}(System.Windows.Forms.Keys vKey)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00025}00025         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00026}00026             \textcolor{keywordtype}{int} si = (int)GetAsyncKeyState(vKey);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00027}00027             \textcolor{keywordflow}{if} (si == 0)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00028}00028                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00029}00029             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00030}00030                 \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00031}00031         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00033}00033         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00034}00034         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{extern} IntPtr GetForegroundWindow();}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00036}00036         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00037}00037         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{int} GetWindowText(IntPtr hWnd, StringBuilder text, \textcolor{keywordtype}{int} count);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00038}00038         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00039}00039         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} SetForegroundWindow(IntPtr hWnd);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00040}00040         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00041}00041         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{void} mouse\_event(\textcolor{keywordtype}{int} dwFlags, \textcolor{keywordtype}{int} dx, \textcolor{keywordtype}{int} dy, \textcolor{keywordtype}{int} dwData, \textcolor{keywordtype}{int} dwExtraInfo);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00043}00043         [StructLayout(LayoutKind.Sequential)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00044}\mbox{\hyperlink{struct_bio_imager_1_1_win32_1_1_rect}{00044}}         \textcolor{keyword}{public} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_bio_imager_1_1_win32_1_1_rect}{Rect}}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00045}00045         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00046}00046             \textcolor{keyword}{public} \textcolor{keywordtype}{int} X;        \textcolor{comment}{// x position of upper-\/left corner}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00047}00047             \textcolor{keyword}{public} \textcolor{keywordtype}{int} Y;         \textcolor{comment}{// y position of upper-\/left corner}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00048}00048             \textcolor{keyword}{public} \textcolor{keywordtype}{int} Right;       \textcolor{comment}{// x position of lower-\/right corner}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00049}00049             \textcolor{keyword}{public} \textcolor{keywordtype}{int} Bottom;      \textcolor{comment}{// y position of lower-\/right corner}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00050}00050         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00051}00051         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_ABSOLUTE = 0x8000;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00052}00052         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_LEFTDOWN = 0x0002;\textcolor{comment}{//The left button is down.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00053}00053         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_LEFTUP = 0x0004;\textcolor{comment}{//The left button is up.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00054}00054         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_MIDDLEDOWN = 0x0020;\textcolor{comment}{//The middle button is down.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00055}00055         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_MIDDLEUP=0x0040;\textcolor{comment}{//The middle button is up.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00056}00056         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_MOVE=0x0001;\textcolor{comment}{//Movement occurred.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00057}00057         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_RIGHTDOWN=0x0008;\textcolor{comment}{//The right button is down.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00058}00058         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_RIGHTUP=0x0010;\textcolor{comment}{//The right button is up.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00059}00059         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_WHEEL = 0x0800;\textcolor{comment}{//The wheel has been moved, if the mouse has a wheel.The amount of movement is specified in dwData}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00060}00060         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_XDOWN=0x0080;\textcolor{comment}{//An X button was pressed.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00061}00061         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_XUP=0x0100;\textcolor{comment}{//An X button was released.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00062}00062         \textcolor{keyword}{public} \textcolor{keyword}{const} \textcolor{keywordtype}{int} MOUSEEVENTF\_HWHEEL=0x01000; \textcolor{comment}{//The wheel button is tilted.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00064}00064         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00065}00065         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} GetWindowRect(IntPtr hwnd, ref \mbox{\hyperlink{struct_bio_imager_1_1_win32_1_1_rect}{Rect}} rectangle);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00066}00066 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00067}00067 \textcolor{comment}{        /// "{}MouseWheelUp()"{} is a function that simulates a mouse wheel up event.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00068}\mbox{\hyperlink{class_bio_imager_1_1_win32_a318544c7e793bf8dc22faf0b286b9666}{00068}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_win32_a318544c7e793bf8dc22faf0b286b9666}{MouseWheelUp}}()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00069}00069         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00070}00070             mouse\_event(MOUSEEVENTF\_WHEEL, 0, 0, 120, 0);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00071}00071         \}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00072}00072 \textcolor{comment}{        /// MouseWheelDown() simulates a mouse wheel down event.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00073}\mbox{\hyperlink{class_bio_imager_1_1_win32_a2178877f5bc4435acb61e0b4e04b65ad}{00073}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_win32_a2178877f5bc4435acb61e0b4e04b65ad}{MouseWheelDown}}()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00074}00074         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00075}00075             mouse\_event(MOUSEEVENTF\_WHEEL, 0, 0, -\/120, 0);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00076}00076         \}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00077}00077 \textcolor{comment}{        /// It gets the process by name, then sets the foreground window to the process's main window}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00078}00078 \textcolor{comment}{        /// handle}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00079}00079 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00080}00080 \textcolor{comment}{        /// @param process The name of the process you want to focus on.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00081}\mbox{\hyperlink{class_bio_imager_1_1_win32_a798c3ef4f92898e338363ae9a06b54a6}{00081}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_win32_a798c3ef4f92898e338363ae9a06b54a6}{SetFocus}}(\textcolor{keywordtype}{string} process)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00082}00082         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00083}00083             Process pr = Process.GetProcessesByName(process)[0];}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00084}00084             SetForegroundWindow(pr.MainWindowHandle);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00085}00085         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00086}00086 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00087}00087 \textcolor{comment}{        /// It gets the title of the active window}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00088}00088 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00089}00089 \textcolor{comment}{        /// @return The title of the active window.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00090}\mbox{\hyperlink{class_bio_imager_1_1_win32_a706bbcd425d29e8bd5b910b401d3e1e0}{00090}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} \mbox{\hyperlink{class_bio_imager_1_1_win32_a706bbcd425d29e8bd5b910b401d3e1e0}{GetActiveWindowTitle}}()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00091}00091         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00092}00092             \textcolor{keyword}{const} \textcolor{keywordtype}{int} nChars = 256;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00093}00093             StringBuilder Buff = \textcolor{keyword}{new} StringBuilder(nChars);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00094}00094             IntPtr handle = GetForegroundWindow();}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00096}00096             \textcolor{keywordflow}{if} (GetWindowText(handle, Buff, nChars) > 0)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00097}00097             \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00098}00098                 \textcolor{keywordflow}{return} Buff.ToString();}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00099}00099             \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00100}00100             \textcolor{keywordflow}{return} \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00101}00101         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00103}00103     \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00104}\mbox{\hyperlink{class_bio_imager_1_1_mouse_operations}{00104}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_bio_imager_1_1_mouse_operations}{MouseOperations}}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00105}00105     \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00106}00106         [Flags]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00107}00107         \textcolor{comment}{/* Defining an enum. */}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00108}00108         \textcolor{keyword}{public} \textcolor{keyword}{enum} MouseEventFlags}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00109}00109         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00110}00110             LeftDown = 0x00000002,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00111}00111             LeftUp = 0x00000004,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00112}00112             MiddleDown = 0x00000020,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00113}00113             MiddleUp = 0x00000040,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00114}00114             Move = 0x00000001,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00115}00115             Absolute = 0x00008000,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00116}00116             RightDown = 0x00000008,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00117}00117             RightUp = 0x00000010}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00118}00118         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00119}00119 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00120}00120         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}}, EntryPoint = \textcolor{stringliteral}{"{}SetCursorPos"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00121}00121         [\textcolor{keywordflow}{return}: MarshalAs(UnmanagedType.Bool)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00122}00122         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} SetCursorPos(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00123}00123 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00124}00124         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00125}00125         [\textcolor{keywordflow}{return}: MarshalAs(UnmanagedType.Bool)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00126}00126         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} GetCursorPos(out \mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}} lpMousePoint);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00128}00128         [DllImport(\textcolor{stringliteral}{"{}user32.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00129}00129         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{void} mouse\_event(\textcolor{keywordtype}{int} dwFlags, \textcolor{keywordtype}{int} dx, \textcolor{keywordtype}{int} dy, \textcolor{keywordtype}{int} dwData, \textcolor{keywordtype}{int} dwExtraInfo);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00131}00131         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} LeftClick()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00132}00132         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00133}00133             \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{MouseEvent}}(MouseEventFlags.LeftDown | MouseEventFlags.LeftUp);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00134}00134         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00135}00135         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} RightClick()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00136}00136         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00137}00137             \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{MouseEvent}}(MouseEventFlags.RightDown | MouseEventFlags.RightUp);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00138}00138         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00139}00139         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} LeftDown()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00140}00140         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00141}00141             \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{MouseEvent}}(MouseEventFlags.LeftDown);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00142}00142         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00143}00143         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} RightDown()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00144}00144         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00145}00145             \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{MouseEvent}}(MouseEventFlags.RightDown);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00146}00146         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00147}00147         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} LeftUp()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00148}00148         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00149}00149             \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{MouseEvent}}(MouseEventFlags.LeftUp);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00150}00150         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00151}00151         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} RightUp()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00152}00152         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00153}00153             \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{MouseEvent}}(MouseEventFlags.RightUp);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00154}00154         \}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00155}00155 \textcolor{comment}{        /// It sets the cursor position to the specified coordinates}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00156}00156 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00157}00157 \textcolor{comment}{        /// @param x The x coordinate of the cursor.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00158}00158 \textcolor{comment}{        /// @param y The y coordinate of the cursor.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00159}\mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_a861fc0813cedf11139bdcb107d23743d}{00159}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_a861fc0813cedf11139bdcb107d23743d}{SetCursorPosition}}(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00160}00160         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00161}00161             SetCursorPos(x, y);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00162}00162         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00163}00163 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00164}00164 \textcolor{comment}{        /// It takes a MousePoint object and sets the cursor position to the X and Y coordinates of the}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00165}00165 \textcolor{comment}{        /// MousePoint object}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00166}00166 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00167}00167 \textcolor{comment}{        /// @param MousePoint A struct that contains the X and Y coordinates of the mouse.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00168}\mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_acb8df79f361c01093981c97101a295a2}{00168}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_acb8df79f361c01093981c97101a295a2}{SetCursorPosition}}(\mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}} point)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00169}00169         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00170}00170             SetCursorPos(point.X, point.Y);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00171}00171         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00172}00172 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00173}00173 \textcolor{comment}{        /// GetCursorPosition() returns a MousePoint object that contains the current position of the}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00174}00174 \textcolor{comment}{        /// mouse cursor}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00175}00175 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00176}00176 \textcolor{comment}{        /// @return A MousePoint object.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00177}\mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_af8d3e7a480fcfe57e2fc9d6a1615742b}{00177}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}} \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_af8d3e7a480fcfe57e2fc9d6a1615742b}{GetCursorPosition}}()}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00178}00178         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00179}00179             \mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}} currentMousePoint;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00180}00180             var gotPoint = GetCursorPos(out currentMousePoint);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00181}00181             \textcolor{keywordflow}{if} (!gotPoint) \{ currentMousePoint = \textcolor{keyword}{new} \mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}}(0, 0); \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00182}00182             \textcolor{keywordflow}{return} currentMousePoint;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00183}00183         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00184}00184 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00185}00185 \textcolor{comment}{        /// It simulates a mouse click at the current cursor position}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00186}00186 \textcolor{comment}{        /// }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00187}00187 \textcolor{comment}{        /// @param MouseEventFlags This is the type of mouse event you want to simulate.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00188}\mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{00188}} \textcolor{comment}{}        \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_ae05975f21b8d58b10647f83a06b52eb1}{MouseEvent}}(MouseEventFlags value)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00189}00189         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00190}00190             \mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}} position = \mbox{\hyperlink{class_bio_imager_1_1_mouse_operations_af8d3e7a480fcfe57e2fc9d6a1615742b}{GetCursorPosition}}();}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00191}00191 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00192}00192             mouse\_event}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00193}00193                 ((\textcolor{keywordtype}{int})value,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00194}00194                  position.X,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00195}00195                  position.Y,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00196}00196                  0,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00197}00197                  0)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00198}00198                 ;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00199}00199         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00200}00200 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00201}00201         [StructLayout(LayoutKind.Sequential)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00202}\mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{00202}}         \textcolor{keyword}{public} \textcolor{keyword}{struct }\mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00203}00203         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00204}00204             \textcolor{keyword}{public} \textcolor{keywordtype}{int} X;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00205}00205             \textcolor{keyword}{public} \textcolor{keywordtype}{int} Y;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00206}00206 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00207}00207             \textcolor{keyword}{public} \mbox{\hyperlink{struct_bio_imager_1_1_mouse_operations_1_1_mouse_point}{MousePoint}}(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00208}00208             \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00209}00209                 X = x;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00210}00210                 Y = y;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00211}00211             \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00212}00212         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00213}00213     \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00214}00214     \textcolor{keyword}{static} \textcolor{keyword}{public} \textcolor{keyword}{class }FileUtil}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00215}00215     \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00216}00216         [StructLayout(LayoutKind.Sequential)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00217}00217         \textcolor{keyword}{struct }RM\_UNIQUE\_PROCESS}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00218}00218         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00219}00219             \textcolor{keyword}{public} \textcolor{keywordtype}{int} dwProcessId;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00220}00220             \textcolor{keyword}{public} System.Runtime.InteropServices.ComTypes.FILETIME ProcessStartTime;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00221}00221         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00222}00222 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00223}00223         \textcolor{keyword}{const} \textcolor{keywordtype}{int} RmRebootReasonNone = 0;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00224}00224         \textcolor{keyword}{const} \textcolor{keywordtype}{int} CCH\_RM\_MAX\_APP\_NAME = 255;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00225}00225         \textcolor{keyword}{const} \textcolor{keywordtype}{int} CCH\_RM\_MAX\_SVC\_NAME = 63;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00227}00227         \textcolor{keyword}{enum} RM\_APP\_TYPE}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00228}00228         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00229}00229             RmUnknownApp = 0,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00230}00230             RmMainWindow = 1,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00231}00231             RmOtherWindow = 2,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00232}00232             RmService = 3,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00233}00233             RmExplorer = 4,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00234}00234             RmConsole = 5,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00235}00235             RmCritical = 1000}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00236}00236         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00238}00238         [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00239}00239         \textcolor{keyword}{struct }RM\_PROCESS\_INFO}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00240}00240         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00241}00241             \textcolor{keyword}{public} RM\_UNIQUE\_PROCESS Process;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00242}00242 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00243}00243             [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCH\_RM\_MAX\_APP\_NAME + 1)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00244}00244             \textcolor{keyword}{public} \textcolor{keywordtype}{string} strAppName;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00246}00246             [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCH\_RM\_MAX\_SVC\_NAME + 1)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00247}00247             \textcolor{keyword}{public} \textcolor{keywordtype}{string} strServiceShortName;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00249}00249             \textcolor{keyword}{public} RM\_APP\_TYPE ApplicationType;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00250}00250             \textcolor{keyword}{public} uint AppStatus;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00251}00251             \textcolor{keyword}{public} uint TSSessionId;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00252}00252             [MarshalAs(UnmanagedType.Bool)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00253}00253             \textcolor{keyword}{public} \textcolor{keywordtype}{bool} bRestartable;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00254}00254         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00256}00256         [DllImport(\textcolor{stringliteral}{"{}rstrtmgr.dll"{}}, CharSet = CharSet.Unicode)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00257}00257         \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{int} RmRegisterResources(uint pSessionHandle,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00258}00258                                               UInt32 nFiles,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00259}00259                                               \textcolor{keywordtype}{string}[] rgsFilenames,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00260}00260                                               UInt32 nApplications,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00261}00261                                               [In] RM\_UNIQUE\_PROCESS[] rgApplications,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00262}00262                                               UInt32 nServices,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00263}00263                                               \textcolor{keywordtype}{string}[] rgsServiceNames);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00265}00265         [DllImport(\textcolor{stringliteral}{"{}rstrtmgr.dll"{}}, CharSet = CharSet.Auto)]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00266}00266         \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{int} RmStartSession(out uint pSessionHandle, \textcolor{keywordtype}{int} dwSessionFlags, \textcolor{keywordtype}{string} strSessionKey);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00267}00267 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00268}00268         [DllImport(\textcolor{stringliteral}{"{}rstrtmgr.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00269}00269         \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{int} RmEndSession(uint pSessionHandle);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00271}00271         [DllImport(\textcolor{stringliteral}{"{}rstrtmgr.dll"{}})]}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00272}00272         \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{int} RmGetList(uint dwSessionHandle,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00273}00273                                     out uint pnProcInfoNeeded,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00274}00274                                     ref uint pnProcInfo,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00275}00275                                     [In, Out] RM\_PROCESS\_INFO[] rgAffectedApps,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00276}00276                                     ref uint lpdwRebootReasons);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00277}00277         \textcolor{keyword}{static} \textcolor{keyword}{public} List<Process> Locking(\textcolor{keywordtype}{string} path)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00278}00278         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00279}00279             uint handle;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00280}00280             \textcolor{keywordtype}{string} key = Guid.NewGuid().ToString();}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00281}00281             List<Process> processes = \textcolor{keyword}{new} List<Process>();}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00282}00282 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00283}00283             \textcolor{keywordtype}{int} res = RmStartSession(out handle, 0, key);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00285}00285             \textcolor{keywordflow}{if} (res != 0)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00286}00286                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} Exception(\textcolor{stringliteral}{"{}Could not begin restart session. Unable to determine file locker."{}});}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00287}00287 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00288}00288             \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00289}00289             \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00290}00290                 \textcolor{keyword}{const} \textcolor{keywordtype}{int} ERROR\_MORE\_DATA = 234;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00291}00291                 uint pnProcInfoNeeded = 0,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00292}00292                      pnProcInfo = 0,}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00293}00293                      lpdwRebootReasons = RmRebootReasonNone;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00295}00295                 \textcolor{keywordtype}{string}[] resources = \textcolor{keyword}{new} \textcolor{keywordtype}{string}[] \{ path \}; \textcolor{comment}{// Just checking on one resource.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00296}00296 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00297}00297                 res = RmRegisterResources(handle, (uint)resources.Length, resources, 0, \textcolor{keyword}{null}, 0, \textcolor{keyword}{null});}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00299}00299                 \textcolor{keywordflow}{if} (res != 0)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00300}00300                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} Exception(\textcolor{stringliteral}{"{}Could not register resource."{}});}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00301}00301 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00302}00302                 \textcolor{comment}{//Note: there's a race condition here -\/-\/ the first call to RmGetList() returns}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00303}00303                 \textcolor{comment}{//      the total number of process. However, when we call RmGetList() again to get}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00304}00304                 \textcolor{comment}{//      the actual processes this number may have increased.}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00305}00305                 res = RmGetList(handle, out pnProcInfoNeeded, ref pnProcInfo, \textcolor{keyword}{null}, ref lpdwRebootReasons);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00307}00307                 \textcolor{keywordflow}{if} (res == ERROR\_MORE\_DATA)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00308}00308                 \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00309}00309                     \textcolor{comment}{// Create an array to store the process results}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00310}00310                     RM\_PROCESS\_INFO[] processInfo = \textcolor{keyword}{new} RM\_PROCESS\_INFO[pnProcInfoNeeded];}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00311}00311                     pnProcInfo = pnProcInfoNeeded;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00313}00313                     \textcolor{comment}{// Get the list}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00314}00314                     res = RmGetList(handle, out pnProcInfoNeeded, ref pnProcInfo, processInfo, ref lpdwRebootReasons);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00315}00315 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00316}00316                     \textcolor{keywordflow}{if} (res == 0)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00317}00317                     \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00318}00318                         processes = \textcolor{keyword}{new} List<Process>((\textcolor{keywordtype}{int})pnProcInfo);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00320}00320                         \textcolor{comment}{// Enumerate all of the results and add them to the }}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00321}00321                         \textcolor{comment}{// list to be returned}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00322}00322                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < pnProcInfo; i++)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00323}00323                         \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00324}00324                             \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00325}00325                             \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00326}00326                                 processes.Add(Process.GetProcessById(processInfo[i].Process.dwProcessId));}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00327}00327                             \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00328}00328                             \textcolor{comment}{// catch the error -\/-\/ in case the process is no longer running}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00329}00329                             \textcolor{keywordflow}{catch} (ArgumentException) \{ \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00330}00330                         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00331}00331                     \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00332}00332                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00333}00333                         \textcolor{keywordflow}{throw} \textcolor{keyword}{new} Exception(\textcolor{stringliteral}{"{}Could not list processes locking resource."{}});}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00334}00334                 \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00335}00335                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (res != 0)}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00336}00336                     \textcolor{keywordflow}{throw} \textcolor{keyword}{new} Exception(\textcolor{stringliteral}{"{}Could not list processes locking resource. Failed to get size of result."{}});}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00337}00337             \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00338}00338             \textcolor{keywordflow}{finally}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00339}00339             \{}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00340}00340                 RmEndSession(handle);}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00341}00341             \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00342}00342 }
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00343}00343             \textcolor{keywordflow}{return} processes;}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00344}00344         \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00345}00345     \}}
\DoxyCodeLine{\Hypertarget{_win32_8cs_source_l00346}00346 \}}

\end{DoxyCode}

\hypertarget{zaber_8py_source}{}\doxysection{zaber.\+py}
\label{zaber_8py_source}\index{F:/repos/BioImager/BioImager/PythonMicroscope/microscope/controllers/zaber.py@{F:/repos/BioImager/BioImager/PythonMicroscope/microscope/controllers/zaber.py}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00001}00001 \textcolor{comment}{\#!/usr/bin/env python3}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00021}00021 \textcolor{stringliteral}{"{}"{}"{}Zaber devices.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00022}00022 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00023}00023 \textcolor{stringliteral}{Devices supported}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00024}00024 \textcolor{stringliteral}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00025}00025 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00026}00026 \textcolor{stringliteral}{There is support for A-\/Series and X-\/Series devices that have firmware}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00027}00027 \textcolor{stringliteral}{version 6.06 or higher, as these are the ones who support the ASCII}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00028}00028 \textcolor{stringliteral}{protocol.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00029}00029 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00030}00030 \textcolor{stringliteral}{.. todo::}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00031}00031 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00032}00032 \textcolor{stringliteral}{    Create non controller classes }\textcolor{keywordflow}{for} the simpler case where there \textcolor{keywordflow}{is}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00033}00033     only one Zaber device, \textcolor{keywordflow}{and} modelling it \textcolor{keyword}{as} controller device \textcolor{keywordflow}{is}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00034}00034     non obvious.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00036}00036 .. todo::}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00038}00038     Consider using `\_\_slots\_\_` on the `\_ZaberReply` \textcolor{keywordflow}{for} performance.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00040}00040 \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00041}00041 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00042}00042 \textcolor{stringliteral}{import enum}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00043}00043 \textcolor{stringliteral}{import logging}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00044}00044 \textcolor{stringliteral}{import threading}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00045}00045 \textcolor{stringliteral}{import time}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00046}00046 \textcolor{stringliteral}{import typing}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00047}00047 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00048}00048 \textcolor{stringliteral}{import serial}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00049}00049 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00050}00050 \textcolor{stringliteral}{import microscope}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00051}00051 \textcolor{stringliteral}{import microscope.\_utils}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00052}00052 \textcolor{stringliteral}{import microscope.abc}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00053}00053 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00054}00054 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00055}00055 \textcolor{stringliteral}{\_logger = logging.getLogger(\_\_name\_\_)}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00056}00056 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00057}00057 \textcolor{stringliteral}{\_AT\_CODE = ord(b"{}@"{})}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00058}00058 \textcolor{stringliteral}{\_SPACE\_CODE = ord(b"{} "{})}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00059}00059 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00060}00060 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00061}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply}{00061}} \textcolor{stringliteral}{class \_ZaberReply:}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00062}00062 \textcolor{stringliteral}{    "{}"{}"{}Wraps a Zaber reply to easily index its multiple fields."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00064}00064     \textcolor{keyword}{def }\_\_init\_\_(self, data: bytes) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00065}00065         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_adc85da309a158dea78bcb25635f17018}{\_data}} = data}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00066}00066         \textcolor{keywordflow}{if} (}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00067}00067             data[0] != \_AT\_CODE}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00068}00068             \textcolor{keywordflow}{or} data[-\/2:] != b\textcolor{stringliteral}{"{}\(\backslash\)r\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00069}00069             \textcolor{keywordflow}{or} any([data[i] != \_SPACE\_CODE \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} (3, 5, 8, 13, 16)])}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00070}00070         ):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00071}00071             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}Not a valid reply from a Zaber device"{}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00073}00073     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00074}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_ae7f3c620452df2bf72d80a29cf28e783}{00074}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_ae7f3c620452df2bf72d80a29cf28e783}{address}}(self) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00075}00075         \textcolor{stringliteral}{"{}"{}"{}The start of reply with device address and space."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00076}00076         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_adc85da309a158dea78bcb25635f17018}{\_data}}[1:3]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00078}00078     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00079}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_a7329ddb3d69b48a3fcae56ac73998320}{00079}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_a7329ddb3d69b48a3fcae56ac73998320}{flag}}(self) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00080}00080         \textcolor{stringliteral}{"{}"{}"{}The reply flag indicates if the message was accepted or rejected.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00081}00081 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00082}00082 \textcolor{stringliteral}{        Can be `b"{}OK"{}}` (accepted) \textcolor{keywordflow}{or} `b\textcolor{stringliteral}{"{}RJ"{}}` (rejected).  If rejected,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00083}00083         the response property will be one word \textcolor{keyword}{with} the reason why.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00084}00084         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00085}00085 \textcolor{stringliteral}{        }\textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_adc85da309a158dea78bcb25635f17018}{\_data}}[6:8]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00087}00087     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00088}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_a81992e5250ab015586a7b4ba35afd80e}{00088}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_a81992e5250ab015586a7b4ba35afd80e}{status}}(self) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00089}00089         \textcolor{stringliteral}{"{}"{}"{}``b"{}BUSY"{}`` when the axis is moving and ``b"{}IDLE"{}`` otherwise.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00090}00090 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00091}00091 \textcolor{stringliteral}{        If the reply message applies to the whole device, the status}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00092}00092 \textcolor{stringliteral}{        }\textcolor{keywordflow}{is} `b\textcolor{stringliteral}{"{}BUSY"{}}` \textcolor{keywordflow}{if} any axis \textcolor{keywordflow}{is} busy \textcolor{keywordflow}{and} `b\textcolor{stringliteral}{"{}IDLE"{}}` \textcolor{keywordflow}{if} all axes are}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00093}00093         idle.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00094}00094         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00095}00095 \textcolor{stringliteral}{        }\textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_adc85da309a158dea78bcb25635f17018}{\_data}}[9:13]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00097}00097     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00098}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_af935342a2de9a5827e4da856c7bb6e7c}{00098}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_af935342a2de9a5827e4da856c7bb6e7c}{warning}}(self) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00099}00099         \textcolor{stringliteral}{"{}"{}"{}The highest priority warning currently active.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00100}00100 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00101}00101 \textcolor{stringliteral}{        This will be `b'-\/-\/'}` under normal conditions.  Anything \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00102}00102         \textcolor{keywordflow}{is} a warning.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00103}00103         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00104}00104 \textcolor{stringliteral}{        }\textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_adc85da309a158dea78bcb25635f17018}{\_data}}[14:16]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00106}00106     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00107}00107     \textcolor{keyword}{def }response(self) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00108}00108         \textcolor{comment}{\# Assumes no checksum}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00109}00109         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply_adc85da309a158dea78bcb25635f17018}{\_data}}[17:-\/2]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00110}00110 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00112}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection}{00112}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection}{\_ZaberConnection}}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00113}00113     \textcolor{stringliteral}{"{}"{}"{}Wraps a serial connection with a reentrant lock.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00114}00114 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00115}00115 \textcolor{stringliteral}{    This }\textcolor{keyword}{class }is just the wrap to :\textcolor{keyword}{class}:`serial.Serial`.  The \textcolor{keyword}{class}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00116}00116     exposing the Zaber commands interface \textcolor{keywordflow}{is}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00117}00117     :\textcolor{keyword}{class}:`\_ZaberDeviceConnection`.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00119}00119     .. todo: replace \textcolor{keyword}{with} \mbox{\hyperlink{classmicroscope_1_1__utils_1_1_shared_serial}{microscope.\_utils.SharedSerial}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00120}00120     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00121}00121 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00122}00122 \textcolor{stringliteral}{    }\textcolor{keyword}{def }\_\_init\_\_(self, port: str, baudrate: int, timeout: float) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00123}00123         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_ae724d4bfe16770f6a1079822a1320391}{\_serial}} = serial.Serial(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00124}00124             port=port,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00125}00125             baudrate=baudrate,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00126}00126             timeout=timeout,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00127}00127             bytesize=serial.EIGHTBITS,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00128}00128             stopbits=serial.STOPBITS\_ONE,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00129}00129             parity=serial.PARITY\_NONE,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00130}00130             xonxoff=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00131}00131             rtscts=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00132}00132             dsrdtr=\textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00133}00133         )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00134}00134         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_a51fbb22eefddf59c40c444ed2a01dfb8}{\_lock}} = threading.RLock()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00135}00135         \textcolor{keyword}{with} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_a51fbb22eefddf59c40c444ed2a01dfb8}{\_lock}}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00136}00136             \textcolor{comment}{\# The command / does nothing other than getting a response}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00137}00137             \textcolor{comment}{\# from all devices in the chain.  This seems to be the}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00138}00138             \textcolor{comment}{\# most innocent command we can use.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00139}00139             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_ae724d4bfe16770f6a1079822a1320391}{\_serial}}.write(b\textcolor{stringliteral}{"{}/\(\backslash\)n"{}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00140}00140             lines = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_ae724d4bfe16770f6a1079822a1320391}{\_serial}}.readlines()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00141}00141         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} all([l.startswith(b\textcolor{stringliteral}{"{}@"{}}) \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} lines]):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00142}00142             \textcolor{keywordflow}{raise} RuntimeError(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00143}00143                 \textcolor{stringliteral}{"{}'\%s' does not respond like a Zaber device"{}} \% port}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00144}00144             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00146}00146     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00147}00147     \textcolor{keyword}{def }lock(self) -\/> threading.RLock:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00148}00148         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_a51fbb22eefddf59c40c444ed2a01dfb8}{\_lock}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00149}00149 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00150}00150     \textcolor{keyword}{def }write(self, data: bytes) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00151}00151         \textcolor{keyword}{with} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_a2c6623d242320a81758527612c8cd610}{lock}}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00152}00152             \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_ae724d4bfe16770f6a1079822a1320391}{\_serial}}.write(data)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00154}00154     \textcolor{keyword}{def }readline(self, size: int = -\/1) -\/> bytes:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00155}00155         \textcolor{keyword}{with} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_a2c6623d242320a81758527612c8cd610}{lock}}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00156}00156             \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection_ae724d4bfe16770f6a1079822a1320391}{\_serial}}.readline(size)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00158}00158 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00159}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection}{00159}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection}{\_ZaberDeviceConnection}}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00160}00160     \textcolor{stringliteral}{"{}"{}"{}A Zaber connection to control a single device.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00161}00161 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00162}00162 \textcolor{stringliteral}{    This }\textcolor{keyword}{class }provides a Python interface to the Zaber commands.  It}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00163}00163     also does the routing of commands to the correct device \textcolor{keywordflow}{in} the}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00164}00164     chain.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00166}00166     Args:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00167}00167         conn: the :\textcolor{keyword}{class}:`\_ZaberConnection` instance \textcolor{keywordflow}{for} this device.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00168}00168         device\_address: the device address \textcolor{keywordflow}{for} the specific device.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00169}00169             This \textcolor{keywordflow}{is} the number used at the start of all Zaber}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00170}00170             commands.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00171}00171     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00172}00172 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00173}00173 \textcolor{stringliteral}{    }\textcolor{keyword}{def }\_\_init\_\_(self, conn: \_ZaberConnection, device\_address: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00174}00174         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_af537480137492bd955a4f4e852ff4b71}{\_conn}} = conn}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00175}00175         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aaa7ead0d69ecfc429b6c8d83ca6c70a8}{\_address\_bytes}} = b\textcolor{stringliteral}{"{}\%02d"{}} \% device\_address}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00176}00176 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00177}00177     \textcolor{keyword}{def }\_validate\_reply(self, reply: \_ZaberReply) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00178}00178         \textcolor{keywordflow}{if} reply.address != self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aaa7ead0d69ecfc429b6c8d83ca6c70a8}{\_address\_bytes}}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00179}00179             \textcolor{keywordflow}{raise} RuntimeError(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00180}00180                 \textcolor{stringliteral}{"{}received reply from a device with different"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00181}00181                 \textcolor{stringliteral}{"{} address (\%s instead of \%s)"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00182}00182                 \% (reply.address.decode(), self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aaa7ead0d69ecfc429b6c8d83ca6c70a8}{\_address\_bytes}}.decode())}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00183}00183             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00184}00184         \textcolor{keywordflow}{if} reply.flag != b\textcolor{stringliteral}{"{}OK"{}}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00185}00185             \textcolor{keywordflow}{raise} RuntimeError(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00186}00186                 \textcolor{stringliteral}{"{}command rejected because '\%s'"{}} \% reply.response.decode()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00187}00187             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00188}00188 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00189}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{00189}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(self, command: bytes, axis: int = 0) -\/> \_ZaberReply:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00190}00190         \textcolor{stringliteral}{"{}"{}"{}Send command and return reply.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00191}00191 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00192}00192 \textcolor{stringliteral}{        Args:}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00193}00193 \textcolor{stringliteral}{            command: a bytes array }\textcolor{keyword}{with} the command \textcolor{keywordflow}{and} its}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00194}00194                 parameters.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00195}00195             axis: the axis number to send the command.  If zero, the}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00196}00196                 command \textcolor{keywordflow}{is} executed by all axis \textcolor{keywordflow}{in} the device.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00197}00197         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00198}00198 \textcolor{stringliteral}{        }\textcolor{comment}{\# We do not need to check whether axis number is valid because}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00199}00199         \textcolor{comment}{\# the device will reject the command with BADAXIS if so.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00200}00200         \textcolor{keyword}{with} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_af537480137492bd955a4f4e852ff4b71}{\_conn}}.lock:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00201}00201             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_af537480137492bd955a4f4e852ff4b71}{\_conn}}.write(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00202}00202                 b\textcolor{stringliteral}{"{}/\%s \%1d \%s\(\backslash\)n"{}} \% (self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aaa7ead0d69ecfc429b6c8d83ca6c70a8}{\_address\_bytes}}, axis, command)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00203}00203             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00204}00204             data = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_af537480137492bd955a4f4e852ff4b71}{\_conn}}.readline()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00205}00205         reply = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_reply}{\_ZaberReply}}(data)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00206}00206         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a7c41dfb30a6383e235c8cf6d6ff2d889}{\_validate\_reply}}(reply)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00207}00207         \textcolor{keywordflow}{return} reply}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00209}00209     \textcolor{keyword}{def }is\_busy(self) -\/> bool:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00210}00210         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}"{}}).status == b\textcolor{stringliteral}{"{}BUSY"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00211}00211 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00212}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_acd09b936986659491d648b16c687a170}{00212}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_acd09b936986659491d648b16c687a170}{wait\_until\_idle}}(self, timeout: float = 10.0) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00213}00213         \textcolor{stringliteral}{"{}"{}"{}Wait, or error, until device is idle.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00214}00214 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00215}00215 \textcolor{stringliteral}{        A device }\textcolor{keywordflow}{is} busy \textcolor{keywordflow}{if} *any* of its axis \textcolor{keywordflow}{is} busy.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00216}00216         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00217}00217 \textcolor{stringliteral}{        sleep\_interval = 0.1}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00218}00218 \textcolor{stringliteral}{        }\textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(int(timeout / sleep\_interval)):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00219}00219             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a1bf2b1dc675ff0bddf8692124a82c54b}{is\_busy}}():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00220}00220                 \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00221}00221             time.sleep(sleep\_interval)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00222}00222         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00223}00223             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_device_error}{microscope.DeviceError}}(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00224}00224                 \textcolor{stringliteral}{"{}device still busy after \%f seconds"{}} \% timeout}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00225}00225             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00227}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a0b69aaa21f4c66565d5512166c47613b}{00227}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a0b69aaa21f4c66565d5512166c47613b}{get\_number\_axes}}(self) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00228}00228         \textcolor{stringliteral}{"{}"{}"{}Reports the number of axes in the device."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00229}00229         \textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get system.axiscount"{}}).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00231}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a6ee20c260fc363950c197713820a09f1}{00231}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a6ee20c260fc363950c197713820a09f1}{been\_homed}}(self, axis: int = 0) -\/> bool:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00232}00232         \textcolor{stringliteral}{"{}"{}"{}True if all axes, or selected axis, has been homed."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00233}00233         reply = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get limit.home.triggered"{}}, axis)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00234}00234         \textcolor{keywordflow}{return} all([int(x) \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} reply.response.split()])}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00235}00235 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00236}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a1a71a97faa12b185ecb36cc096929514}{00236}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a1a71a97faa12b185ecb36cc096929514}{home}}(self, axis: int = 0) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00237}00237         \textcolor{stringliteral}{"{}"{}"{}Move the axis to the home position."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00238}00238         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}home"{}}, axis)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00240}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a1678d4d9de888176c82ee300b0ee0b1a}{00240}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a1678d4d9de888176c82ee300b0ee0b1a}{get\_rotation\_length}}(self, axis: int) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00241}00241         \textcolor{stringliteral}{"{}"{}"{}Number of microsteps needed to complete one full rotation.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00242}00242 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00243}00243 \textcolor{stringliteral}{        This }\textcolor{keywordflow}{is} only valid on controllers \textcolor{keywordflow}{and} rotary devices including}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00244}00244         filter wheels \textcolor{keywordflow}{and} filter cube turrets.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00245}00245         \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00246}00246 \textcolor{stringliteral}{        }\textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get limit.cycle.dist"{}}, axis).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00248}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_ad98ae324d2b24195a1a9ddfed6085c40}{00248}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_ad98ae324d2b24195a1a9ddfed6085c40}{get\_index\_distance}}(self, axis: int) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00249}00249         \textcolor{stringliteral}{"{}"{}"{}The distance between consecutive index positions."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00250}00250         \textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get motion.index.dist"{}}, axis).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00251}00251 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00252}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a85c26828d611801f94e4daecc551a7d3}{00252}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a85c26828d611801f94e4daecc551a7d3}{get\_current\_index}}(self, axis: int) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00253}00253         \textcolor{stringliteral}{"{}"{}"{}The current index number or zero if between index positions."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00254}00254         \textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get motion.index.num"{}}, axis).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00256}00256     \textcolor{keyword}{def }move\_to\_index(self, axis: int, index: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00257}00257         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}move index \%d"{}} \% index, axis)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00259}00259     \textcolor{keyword}{def }move\_to\_absolute\_position(self, axis: int, position: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00260}00260         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}move abs \%d"{}} \% position, axis)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00262}00262     \textcolor{keyword}{def }move\_by\_relative\_position(self, axis: int, position: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00263}00263         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}move rel \%d"{}} \% position, axis)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00265}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_adedadda94d6686430f0b6898256d2dca}{00265}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_adedadda94d6686430f0b6898256d2dca}{get\_absolute\_position}}(self, axis: int) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00266}00266         \textcolor{stringliteral}{"{}"{}"{}Current absolute position of an axis, in microsteps."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00267}00267         \textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get pos"{}}, axis).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00269}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a168ac18dc9b8e4f24ac31164d37498d1}{00269}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a168ac18dc9b8e4f24ac31164d37498d1}{get\_limit\_max}}(self, axis: int) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00270}00270         \textcolor{stringliteral}{"{}"{}"{}The maximum position the device can move to, in microsteps."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00271}00271         \textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get limit.max"{}}, axis).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00272}00272 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00273}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a2a088bc1c3315db9d5e22bf29c617bb0}{00273}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_a2a088bc1c3315db9d5e22bf29c617bb0}{get\_limit\_min}}(self, axis: int) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00274}00274         \textcolor{stringliteral}{"{}"{}"{}The minimum position the device can move to, in microsteps."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00275}00275         \textcolor{keywordflow}{return} int(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get limit.min"{}}, axis).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00276}00276 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00277}00277     \textcolor{keyword}{def }lamp\_off(self, channel: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00278}00278         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}lamp off"{}}, channel)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00280}00280     \textcolor{keyword}{def }lamp\_on(self, channel: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00281}00281         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}lamp on"{}}, channel)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00282}00282 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00283}00283     \textcolor{keyword}{def }get\_lamp\_max\_flux(self, channel: int) -\/> float:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00284}00284         \textcolor{keywordflow}{return} float(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get lamp.flux.max"{}}, channel).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00286}00286     \textcolor{keyword}{def }get\_lamp\_flux(self, channel: int) -\/> float:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00287}00287         \textcolor{keywordflow}{return} float(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get lamp.flux"{}}, channel).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00288}00288 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00289}00289     \textcolor{keyword}{def }set\_lamp\_flux(self, channel: int, flux: float) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00290}00290         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}set lamp.flux \%.3f"{}} \% flux, channel)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00292}00292     \textcolor{keyword}{def }get\_lamp\_is\_on(self, channel: int) -\/> bool:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00293}00293         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get lamp.status"{}}, channel).response == b\textcolor{stringliteral}{"{}2"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00295}00295     \textcolor{keyword}{def }get\_lamp\_temperature(self, channel: int) -\/> float:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00296}00296         \textcolor{keywordflow}{return} float(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection_aa40a6c3164797e66a1c6245be2e81ef8}{command}}(b\textcolor{stringliteral}{"{}get lamp.temperature"{}}, channel).response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00297}00297 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00299}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis}{00299}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis}{\_ZaberStageAxis}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_stage_axis}{microscope.abc.StageAxis}}):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00300}00300     \textcolor{keyword}{def }\_\_init\_\_(self, dev\_conn: \_ZaberDeviceConnection, axis: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00301}00301         super().\_\_init\_\_()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00302}00302         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}} = dev\_conn}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00303}00303         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a8af7e3f2759e520d706146dcfc2f3a34}{\_axis}} = axis}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00304}00304 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00305}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_ac40cdf50c1f1985630063a36d2f0fc3a}{00305}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_ac40cdf50c1f1985630063a36d2f0fc3a}{move\_by}}(self, delta: float) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00306}00306         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.move\_by\_relative\_position(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a8af7e3f2759e520d706146dcfc2f3a34}{\_axis}}, int(delta))}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00307}00307         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.wait\_until\_idle()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00308}00308 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00309}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_ab7d5f2a898dbe519c843aadfb624ca11}{00309}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_ab7d5f2a898dbe519c843aadfb624ca11}{move\_to}}(self, pos: float) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00310}00310         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.move\_to\_absolute\_position(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a8af7e3f2759e520d706146dcfc2f3a34}{\_axis}}, int(pos))}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00311}00311         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.wait\_until\_idle()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00313}00313     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00314}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a0a8a48f26280231401d30c2bb170772d}{00314}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a0a8a48f26280231401d30c2bb170772d}{position}}(self) -\/> float:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00315}00315         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.is\_busy():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00316}00316             \_logger.warning(\textcolor{stringliteral}{"{}querying stage axis position but device is busy"{}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00317}00317             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.wait\_until\_idle()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00318}00318         \textcolor{keywordflow}{return} float(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.get\_absolute\_position(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a8af7e3f2759e520d706146dcfc2f3a34}{\_axis}}))}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00320}00320     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00321}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_ad43e5b478ef31ba4bd572d9c2e620e9a}{00321}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_ad43e5b478ef31ba4bd572d9c2e620e9a}{limits}}(self) -\/> microscope.AxisLimits:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00322}00322         min\_limit = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.get\_limit\_min(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a8af7e3f2759e520d706146dcfc2f3a34}{\_axis}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00323}00323         max\_limit = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a3b2a6e8874148d0addb396d45af902c1}{\_dev\_conn}}.get\_limit\_max(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis_a8af7e3f2759e520d706146dcfc2f3a34}{\_axis}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00324}00324         \textcolor{keywordflow}{return} \mbox{\hyperlink{classmicroscope_1_1_axis_limits}{microscope.AxisLimits}}(lower=min\_limit, upper=max\_limit)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00325}00325 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00327}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage}{00327}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage}{\_ZaberStage}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_stage}{microscope.abc.Stage}}):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00328}00328     \textcolor{keyword}{def }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00329}00329         self, conn: \_ZaberConnection, device\_address: int, **kwargs}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00330}00330     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00331}00331         super().\_\_init\_\_(**kwargs)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00332}00332         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}} = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection}{\_ZaberDeviceConnection}}(conn, device\_address)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00333}00333         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_aadd1a685d89caa5a289cb50bb67c4568}{\_axes}} = \{}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00334}00334             str(i): \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_axis}{\_ZaberStageAxis}}(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}}, i)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00335}00335             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}}.get\_number\_axes() + 1)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00336}00336         \}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00338}00338     \textcolor{keyword}{def }\_do\_shutdown(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00339}00339         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00341}00341     \textcolor{keyword}{def }\_do\_enable(self) -\/> bool:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00342}00342         \textcolor{comment}{\# Before a device can moved, it first needs to establish a}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00343}00343         \textcolor{comment}{\# reference to the home position.  We won't be able to move}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00344}00344         \textcolor{comment}{\# unless we home it first.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00345}00345         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.\_dev\_conn.been\_homed():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00346}00346             self.\_dev\_conn.home()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00347}00347         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00349}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a68e535f0d7e2f94324d3d522969f88cf}{00349}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a68e535f0d7e2f94324d3d522969f88cf}{may\_move\_on\_enable}}(self) -\/> bool:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00350}00350         \textcolor{keywordflow}{return} \textcolor{keywordflow}{not} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}}.been\_homed()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00352}00352     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00353}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a12c908262361d8b6f9d8cb8e6983b9fe}{00353}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a12c908262361d8b6f9d8cb8e6983b9fe}{axes}}(self) -\/> typing.Mapping[str, microscope.abc.StageAxis]:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00354}00354         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_aadd1a685d89caa5a289cb50bb67c4568}{\_axes}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00356}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a79654dc9eb40386555d71c47b25c1aec}{00356}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a79654dc9eb40386555d71c47b25c1aec}{move\_by}}(self, delta: typing.Mapping[str, float]) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00357}00357         \textcolor{stringliteral}{"{}"{}"{}Move specified axes by the specified distance."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00358}00358         \textcolor{keywordflow}{for} axis\_name, axis\_delta \textcolor{keywordflow}{in} delta.items():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00359}00359             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}}.move\_by\_relative\_position(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00360}00360                 int(axis\_name),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00361}00361                 int(axis\_delta),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00362}00362             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00363}00363         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}}.wait\_until\_idle()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00364}00364 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00365}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_aec2ef145f73e401a4809ed45fda59d17}{00365}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_aec2ef145f73e401a4809ed45fda59d17}{move\_to}}(self, position: typing.Mapping[str, float]) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00366}00366         \textcolor{stringliteral}{"{}"{}"{}Move specified axes by the specified distance."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00367}00367         \textcolor{keywordflow}{for} axis\_name, axis\_position \textcolor{keywordflow}{in} position.items():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00368}00368             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}}.move\_to\_absolute\_position(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00369}00369                 int(axis\_name),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00370}00370                 int(axis\_position),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00371}00371             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00372}00372         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_stage_a99195426e743d911cfe9e190d872c11d}{\_dev\_conn}}.wait\_until\_idle()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00375}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel}{00375}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel}{\_ZaberFilterWheel}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_filter_wheel}{microscope.abc.FilterWheel}}):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00376}00376     \textcolor{stringliteral}{"{}"{}"{}Zaber filter wheels and filter cube turrets."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00377}00377 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00378}00378     \textcolor{keyword}{def }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00379}00379         self, conn: \_ZaberConnection, device\_address: int, **kwargs}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00380}00380     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00381}00381         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel_ae780fcb786e90f13a19bc3d0435b3f41}{\_dev\_conn}} = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection}{\_ZaberDeviceConnection}}(conn, device\_address)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00383}00383         \textcolor{keywordflow}{if} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel_ae780fcb786e90f13a19bc3d0435b3f41}{\_dev\_conn}}.get\_number\_axes() != 1:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00384}00384             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_initialise_error}{microscope.InitialiseError}}(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00385}00385                 \textcolor{stringliteral}{"{}Device with address \%d is not a filter wheel"{}} \% device\_address}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00386}00386             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00387}00387 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00388}00388         rotation\_length = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel_ae780fcb786e90f13a19bc3d0435b3f41}{\_dev\_conn}}.get\_rotation\_length(1)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00389}00389         \textcolor{keywordflow}{if} rotation\_length <= 0:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00390}00390             \textcolor{keywordflow}{raise} \mbox{\hyperlink{classmicroscope_1_1_initialise_error}{microscope.InitialiseError}}(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00391}00391                 \textcolor{stringliteral}{"{}Device with address \%d is not a filter wheel"{}} \% device\_address}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00392}00392             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00393}00393         positions = int(rotation\_length / self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel_ae780fcb786e90f13a19bc3d0435b3f41}{\_dev\_conn}}.get\_index\_distance(1))}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00395}00395         super().\_\_init\_\_(positions, **kwargs)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00396}00396 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00397}00397         \textcolor{comment}{\# Before a device can moved, it first needs to establish a}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00398}00398         \textcolor{comment}{\# reference to the home position.  We won't be able to move}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00399}00399         \textcolor{comment}{\# unless we home it first.  On a stage this happens during}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00400}00400         \textcolor{comment}{\# enable because the stage movemenet can be dangerous but on a}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00401}00401         \textcolor{comment}{\# filter wheel this is fine.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00402}00402         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel_ae780fcb786e90f13a19bc3d0435b3f41}{\_dev\_conn}}.been\_homed():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00403}00403             self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_filter_wheel_ae780fcb786e90f13a19bc3d0435b3f41}{\_dev\_conn}}.home()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00405}00405     \textcolor{keyword}{def }\_do\_shutdown(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00406}00406         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00408}00408     \textcolor{keyword}{def }\_do\_get\_position(self) -\/> int:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00409}00409         \textcolor{keywordflow}{if} self.\_dev\_conn.is\_busy():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00410}00410             \_logger.warning(\textcolor{stringliteral}{"{}querying filterwheel position but device is busy"{}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00411}00411             self.\_dev\_conn.wait\_until\_idle()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00412}00412         \textcolor{comment}{\# Zaber positions start at one, hence -\/1.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00413}00413         \textcolor{keywordflow}{return} self.\_dev\_conn.get\_current\_index(axis=1) -\/ 1}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00414}00414 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00415}00415     \textcolor{keyword}{def }\_do\_set\_position(self, position: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00416}00416         \textcolor{comment}{\# Zaber positions start at one, hence +1.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00417}00417         self.\_dev\_conn.move\_to\_index(axis=1, index=position + 1)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00418}00418         self.\_dev\_conn.wait\_until\_idle()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00419}00419 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00420}00420 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00421}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d}{00421}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d}{\_ZaberLED}}(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00422}00422     \mbox{\hyperlink{classmicroscope_1_1__utils_1_1_only_triggers_bulb_on_software_mixin}{microscope.\_utils.OnlyTriggersBulbOnSoftwareMixin}},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00423}00423     \mbox{\hyperlink{classmicroscope_1_1abc_1_1_light_source}{microscope.abc.LightSource}},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00424}00424 ):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00425}00425     \textcolor{stringliteral}{"{}"{}"{}A single LED from a LED controller."{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00426}00426 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00427}00427     \textcolor{keyword}{def }\_\_init\_\_(self, dev\_conn: \_ZaberDeviceConnection, channel: int) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00428}00428         super().\_\_init\_\_()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00429}00429         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_adb00ebe6dcc2d5fa90d86ef83dbeac00}{\_dev\_conn}} = dev\_conn}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00430}00430         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a4e2339eb5674a7707875bb22687da956}{\_channel}} = channel}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00431}00431         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a42494eccd6cafdedd4051d83fc6d2949}{\_max\_flux}} = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_adb00ebe6dcc2d5fa90d86ef83dbeac00}{\_dev\_conn}}.get\_lamp\_max\_flux(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a4e2339eb5674a7707875bb22687da956}{\_channel}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00432}00432         self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_device_a0252c8e32f95c4f8c19bedc1d96c1669}{add\_setting}}(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00433}00433             \textcolor{stringliteral}{"{}temperature"{}},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00434}00434             \textcolor{stringliteral}{"{}float"{}},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00435}00435             \textcolor{keyword}{lambda}: self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_adb00ebe6dcc2d5fa90d86ef83dbeac00}{\_dev\_conn}}.get\_lamp\_temperature(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a4e2339eb5674a7707875bb22687da956}{\_channel}}),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00436}00436             \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00437}00437             values=tuple(),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00438}00438         )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00439}00439 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00440}00440         \textcolor{keywordflow}{for} our\_name, their\_name \textcolor{keywordflow}{in} [}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00441}00441             (\textcolor{stringliteral}{"{}wavelength peak"{}}, \textcolor{stringliteral}{"{}lamp.wavelength.peak"{}}),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00442}00442             (\textcolor{stringliteral}{"{}wavelength fwhm"{}}, \textcolor{stringliteral}{"{}lamp.wavelength.fwhm"{}}),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00443}00443         ]:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00444}00444             reply = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_adb00ebe6dcc2d5fa90d86ef83dbeac00}{\_dev\_conn}}.command(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00445}00445                 b\textcolor{stringliteral}{"{}get \%s"{}} \% their\_name.encode(), self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a4e2339eb5674a7707875bb22687da956}{\_channel}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00446}00446             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00447}00447             value = float(reply.response)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00448}00448             self.\mbox{\hyperlink{classmicroscope_1_1abc_1_1_device_a0252c8e32f95c4f8c19bedc1d96c1669}{add\_setting}}(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00449}00449                 our\_name,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00450}00450                 \textcolor{stringliteral}{"{}float"{}},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00451}00451                 \textcolor{keyword}{lambda} x=value: x,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00452}00452                 \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00453}00453                 values=tuple(),}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00454}00454             )}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00455}00455 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00456}00456     \textcolor{keyword}{def }\_do\_shutdown(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00457}00457         \textcolor{keywordflow}{pass}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00458}00458 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00459}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a045e59ced42fbc078d23d7a49fc2de31}{00459}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a045e59ced42fbc078d23d7a49fc2de31}{get\_status}}(self) -\/> typing.List[str]:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00460}00460         \textcolor{keywordflow}{return} super().\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a045e59ced42fbc078d23d7a49fc2de31}{get\_status}}()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00462}00462     \textcolor{keyword}{def }\_do\_enable(self) -\/> bool:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00463}00463         self.\_dev\_conn.lamp\_on(self.\_channel)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00464}00464         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00465}00465 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00466}00466     \textcolor{keyword}{def }\_do\_disable(self) -\/> None:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00467}00467         self.\_dev\_conn.lamp\_off(self.\_channel)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00468}00468 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00469}00469     \textcolor{keyword}{def }\_do\_get\_power(self) -\/> float:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00470}00470         \textcolor{keywordflow}{return} self.\_dev\_conn.get\_lamp\_flux(self.\_channel) / self.\_max\_flux}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00471}00471 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00472}00472     \textcolor{keyword}{def }\_do\_set\_power(self, power: float) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00473}00473         self.\_dev\_conn.set\_lamp\_flux(self.\_channel, power * self.\_max\_flux)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00475}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a051e0d64ac5b71856842a9bdc0d1e945}{00475}}     \textcolor{keyword}{def }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a051e0d64ac5b71856842a9bdc0d1e945}{get\_is\_on}}(self) -\/> bool:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00476}00476         \textcolor{keywordflow}{return} self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_adb00ebe6dcc2d5fa90d86ef83dbeac00}{\_dev\_conn}}.get\_lamp\_is\_on(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_a4e2339eb5674a7707875bb22687da956}{\_channel}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00477}00477 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00479}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_controller}{00479}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_controller}{\_ZaberLEDController}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_controller}{microscope.abc.Controller}}):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00480}00480     \textcolor{stringliteral}{"{}"{}"{}This effectively means a Zaber X-\/LCA4 LED controller.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00481}00481 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00482}00482 \textcolor{stringliteral}{    The X-\/LCA4 series }\textcolor{keywordflow}{is} so far the only LED controller Zaber has.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00483}00483     Its documentation \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} included on the ASCII protocol manual,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00484}00484     see the `controller specific manual online}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00485}00485     <https://www.zaber.com/protocol-\/manual?device=X-\/LCA4>`\_}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00486}00486 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00487}00487     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00488}00488 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00489}00489 \textcolor{stringliteral}{    }\textcolor{keyword}{def }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00490}00490         self, conn: \_ZaberConnection, device\_address: int, **kwargs}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00491}00491     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00492}00492         super().\_\_init\_\_(**kwargs)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00493}00493         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_controller_a78c40966b8dbcdaaf6572a5baf410790}{\_dev\_conn}} = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_device_connection}{\_ZaberDeviceConnection}}(conn, device\_address)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00494}00494         self.\_leds: typing.Dict[str, \_ZaberLED] = \{\}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00495}00495 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00496}00496         all\_lamps = self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_controller_a78c40966b8dbcdaaf6572a5baf410790}{\_dev\_conn}}.command(b\textcolor{stringliteral}{"{}get lamp.status"{}}).response.split()}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00497}00497         \textcolor{comment}{\# We get one status per peripheral connection.  Documentation}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00498}00498         \textcolor{comment}{\# states that a value of "{}0"{} means unplugged but with X-\/LCA4,}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00499}00499         \textcolor{comment}{\# firmware version 7.13 and build 8074, we get NA for}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00500}00500         \textcolor{comment}{\# unplugged.  Also not sure how 0 (unplugged) would differ}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00501}00501         \textcolor{comment}{\# from 5 (peripheral not connected).  So we count as valid}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00502}00502         \textcolor{comment}{\# those with status 1 (turned off), 2 (turned on), and 3}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00503}00503         \textcolor{comment}{\# (fault).}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00504}00504         \textcolor{keywordflow}{for} i, lamp\_state \textcolor{keywordflow}{in} enumerate(all\_lamps, start=1):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00505}00505             \textcolor{keywordflow}{if} lamp\_state \textcolor{keywordflow}{in} [b\textcolor{stringliteral}{"{}1"{}}, b\textcolor{stringliteral}{"{}2"{}}, b\textcolor{stringliteral}{"{}3"{}}]:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00506}00506                 \textcolor{comment}{\# The labels on the controller are LED1, LED2, etc, so}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00507}00507                 \textcolor{comment}{\# use the same for key.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00508}00508                 self.\_leds[\textcolor{stringliteral}{"{}LED\%d"{}} \% i] = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d}{\_ZaberLED}}(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_controller_a78c40966b8dbcdaaf6572a5baf410790}{\_dev\_conn}}, i)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00509}00509             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00510}00510                 \_logger.info(\textcolor{stringliteral}{"{}no LED \%d, status is \%s"{}}, i, lamp\_state.decode())}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00511}00511 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00512}00512     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00513}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_l_e_d_controller_a2d58c83884afa8e3b8f616be79af0e23}{00513}}     \textcolor{keyword}{def }devices(self) -\/> typing.Dict[str, \_ZaberLED]:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00514}00514         \textcolor{keywordflow}{return} self.\_leds}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00515}00515 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00516}00516 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00517}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_device_type}{00517}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_device_type}{ZaberDeviceType}}(enum.Enum):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00518}00518     \textcolor{stringliteral}{"{}"{}"{}Enumerator for Zaber device types.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00519}00519 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00520}00520 \textcolor{stringliteral}{    This enum }\textcolor{keywordflow}{is} used to specify the type of device \textcolor{keywordflow}{for} each address}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00521}00521     when constructing a :\textcolor{keyword}{class}:`ZaberDaisyChain`.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00522}00522     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00523}00523 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00524}00524 \textcolor{stringliteral}{    }\textcolor{comment}{\# We require the use of an enum instead of directly specifying the}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00525}00525     \textcolor{comment}{\# class to keep the individual device classes private.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00526}00526     STAGE = \_ZaberStage}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00527}00527     FILTER\_WHEEL = \_ZaberFilterWheel}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00528}00528     LED\_CONTROLLER = \_ZaberLEDController}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00529}00529 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00530}00530 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00531}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_daisy_chain}{00531}} \textcolor{keyword}{class }\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_daisy_chain}{ZaberDaisyChain}}(\mbox{\hyperlink{classmicroscope_1_1abc_1_1_controller}{microscope.abc.Controller}}):}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00532}00532     \textcolor{stringliteral}{"{}"{}"{}A daisy chain of Zaber devices.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00533}00533 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00534}00534 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00535}00535 \textcolor{stringliteral}{        port: the port name to connect to.  For example, `COM1`,}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00536}00536 \textcolor{stringliteral}{            `/dev/ttyUSB0`, }\textcolor{keywordflow}{or} `/dev/cuad1`.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00537}00537         address2type: a map of device addresses to the corresponding}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00538}00538             :\textcolor{keyword}{class}:`ZaberDeviceType`.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00539}00539 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00540}00540     Zaber devices can be daisy-\/chained, i.e., a set of Zaber devices}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00541}00541     can be connected \textcolor{keywordflow}{in} a sequence so that each device \textcolor{keywordflow}{is} only wired}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00542}00542     to the previous \textcolor{keywordflow}{and} next device \textcolor{keywordflow}{in} the sequence, \textcolor{keywordflow}{and} only the}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00543}00543     first device \textcolor{keywordflow}{in} the sequence \textcolor{keywordflow}{is} connected to the computer.  Even}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00544}00544     \textcolor{keywordflow}{if} there \textcolor{keywordflow}{is} only Zaber device, this \textcolor{keywordflow}{is} modelled \textcolor{keyword}{as} a one element}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00545}00545     daisy-\/chain.  If there are multiple devices, all connected}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00546}00546     directly to the computer, i.e., \textcolor{keywordflow}{not} chained, then each device \textcolor{keywordflow}{is}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00547}00547     its own one-\/element daisy-\/chain.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00548}00548 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00549}00549     .. code-\/block:: python}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00550}00550 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00551}00551         \textcolor{keyword}{from} \mbox{\hyperlink{namespacemicroscope_1_1controllers_1_1zaber}{microscope.controllers.zaber}} \textcolor{keyword}{import} ZaberDaisyChain, ZaberDeviceType}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00552}00552         zaber = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_daisy_chain}{ZaberDaisyChain}}(\textcolor{stringliteral}{"{}/dev/ttyUSB0"{}},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00553}00553                                 \{2: ZaberDeviceType.STAGE,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00554}00554                                  3: ZaberDeviceType.LED\_CONTROLLER,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00555}00555                                  4: ZaberDeviceType.FILTER\_WHEEL\})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00556}00556 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00557}00557         \textcolor{comment}{\# Device names are strings, not int.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00558}00558         filterwheel = zaber.devices[\textcolor{stringliteral}{'4'}]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00559}00559 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00560}00560         \textcolor{comment}{\# LEDs are not devices of the zaber daisy chain, they are}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00561}00561         \textcolor{comment}{\# devices of the LED controller.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00562}00562         led\_controller = zaber.devices[\textcolor{stringliteral}{'3'}]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00563}00563         led1 = led\_controller.devices[\textcolor{stringliteral}{'LED1'}]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00564}00564 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00565}00565         \textcolor{comment}{\# Stage axis names are the string of the axis number.}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00566}00566         xy\_stage = zaber.devices[\textcolor{stringliteral}{'2'}]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00567}00567         motor1 = xy\_stage.axes[\textcolor{stringliteral}{'1'}]}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00569}00569     Each device on a chain \textcolor{keywordflow}{is} identified by a device address which \textcolor{keywordflow}{is}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00570}00570     an integer between 1 \textcolor{keywordflow}{and} 99.  By default, the addresses start at 1}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00571}00571     \textcolor{keywordflow}{and} are sorted by distance to the computer, but this can be}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00572}00572     changed.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00573}00573 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00574}00574     For an LED controller device, the names of its devices are \textcolor{stringliteral}{"{}LED1"{}},}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00575}00575     \textcolor{stringliteral}{"{}LED2"{}}, etc, the same \textcolor{keyword}{as} the labels on the LED controller itself.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00576}00576 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00577}00577     Because there \textcolor{keywordflow}{is} no method to correctly guess a device type, a map}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00578}00578     of device addresses to device types \textcolor{keywordflow}{is} required.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00580}00580     .. note::}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00581}00581 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00582}00582        Zaber devices need to be homed before they can be moved.  A}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00583}00583        stage will be homed during `enable` but a filter wheel will be}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00584}00584        homed during the object construction.}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00586}00586     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00587}00587 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00588}00588 \textcolor{stringliteral}{    }\textcolor{keyword}{def }\_\_init\_\_(}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00589}00589         self,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00590}00590         port: str,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00591}00591         address2type: typing.Mapping[int, ZaberDeviceType],}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00592}00592         **kwargs,}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00593}00593     ) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00594}00594         super().\_\_init\_\_(**kwargs)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00595}00595         self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_daisy_chain_ae6d00babb8782da50814536617d3b383}{\_conn}} = \mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1___zaber_connection}{\_ZaberConnection}}(port, baudrate=115200, timeout=0.5)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00596}00596         self.\_devices: typing.Dict[str, \mbox{\hyperlink{classmicroscope_1_1abc_1_1_device}{microscope.abc.Device}}] = \{\}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00597}00597 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00598}00598         \textcolor{keywordflow}{for} address, device\_type \textcolor{keywordflow}{in} address2type.items():}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00599}00599             \textcolor{keywordflow}{if} address < 1 \textcolor{keywordflow}{or} address > 99:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00600}00600                 \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}address must be an integer between 1-\/99"{}})}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00601}00601             dev\_cls = device\_type.value}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00602}00602             self.\_devices[str(address)] = dev\_cls(self.\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_daisy_chain_ae6d00babb8782da50814536617d3b383}{\_conn}}, address)}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00603}00603 }
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00604}00604     \textcolor{preprocessor}{@property}}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00605}\mbox{\hyperlink{classmicroscope_1_1controllers_1_1zaber_1_1_zaber_daisy_chain_ad3cebca4d1567eebcac75337113cdf90}{00605}}     \textcolor{keyword}{def }devices(self) -\/> typing.Dict[str, microscope.abc.Device]:}
\DoxyCodeLine{\Hypertarget{zaber_8py_source_l00606}00606         \textcolor{keywordflow}{return} self.\_devices}

\end{DoxyCode}
